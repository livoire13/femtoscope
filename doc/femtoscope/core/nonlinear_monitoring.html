<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>femtoscope.core.nonlinear_monitoring API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../core.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;femtoscope.core</a>

            <img src="file://C:/Users/ericd/Desktop/femtoscope/femtoscope/images/logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#get_criteria_dict">get_criteria_dict</a>
            </li>
            <li>
                    <a class="class" href="#Decorators">Decorators</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Decorators.check_wf_residual">check_wf_residual</a>
                        </li>
                        <li>
                                <a class="function" href="#Decorators.not_zeroth_iteration">not_zeroth_iteration</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Criterion">Criterion</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Criterion.priority">priority</a>
                        </li>
                        <li>
                                <a class="variable" href="#Criterion.threshold">threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#Criterion.status">status</a>
                        </li>
                        <li>
                                <a class="variable" href="#Criterion.value">value</a>
                        </li>
                        <li>
                                <a class="variable" href="#Criterion.history">history</a>
                        </li>
                        <li>
                                <a class="variable" href="#Criterion.name">name</a>
                        </li>
                        <li>
                                <a class="function" href="#Criterion.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#Criterion.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#Criterion.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MaximumIterations">MaximumIterations</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#MaximumIterations.priority">priority</a>
                        </li>
                        <li>
                                <a class="function" href="#MaximumIterations.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#MaximumIterations.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#MaximumIterations.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RelativeDeltaSolutionNorm2">RelativeDeltaSolutionNorm2</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#RelativeDeltaSolutionNorm2.priority">priority</a>
                        </li>
                        <li>
                                <a class="function" href="#RelativeDeltaSolutionNorm2.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#RelativeDeltaSolutionNorm2.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#RelativeDeltaSolutionNorm2.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#AbsoluteDeltaSolutionNorm2">AbsoluteDeltaSolutionNorm2</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#AbsoluteDeltaSolutionNorm2.priority">priority</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsoluteDeltaSolutionNorm2.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsoluteDeltaSolutionNorm2.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#AbsoluteDeltaSolutionNorm2.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ResidualVector">ResidualVector</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ResidualVector.priority">priority</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVector.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVector.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVector.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ResidualVectorParts">ResidualVectorParts</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ResidualVectorParts.priority">priority</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVectorParts.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVectorParts.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVectorParts.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ResidualVectorNorm2">ResidualVectorNorm2</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ResidualVectorNorm2.priority">priority</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVectorNorm2.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVectorNorm2.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualVectorNorm2.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RelativeDeltaResidualNorm2">RelativeDeltaResidualNorm2</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#RelativeDeltaResidualNorm2.priority">priority</a>
                        </li>
                        <li>
                                <a class="function" href="#RelativeDeltaResidualNorm2.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#RelativeDeltaResidualNorm2.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#RelativeDeltaResidualNorm2.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ResidualReductionFactor">ResidualReductionFactor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ResidualReductionFactor.priority">priority</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualReductionFactor.evaluate">evaluate</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualReductionFactor.update_history">update_history</a>
                        </li>
                        <li>
                                <a class="function" href="#ResidualReductionFactor.write_stop_message">write_stop_message</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#NonLinearMonitor">NonLinearMonitor</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#NonLinearMonitor.criteria_class_dict">criteria_class_dict</a>
                        </li>
                        <li>
                                <a class="variable" href="#NonLinearMonitor.stop">stop</a>
                        </li>
                        <li>
                                <a class="variable" href="#NonLinearMonitor.current_iter_num">current_iter_num</a>
                        </li>
                        <li>
                                <a class="variable" href="#NonLinearMonitor.minimum_iter_num">minimum_iter_num</a>
                        </li>
                        <li>
                                <a class="variable" href="#NonLinearMonitor.criteria">criteria</a>
                        </li>
                        <li>
                                <a class="variable" href="#NonLinearMonitor.nonlinear_solver">nonlinear_solver</a>
                        </li>
                        <li>
                                <a class="variable" href="#NonLinearMonitor.maximum_iter_num">maximum_iter_num</a>
                        </li>
                        <li>
                                <a class="variable" href="#NonLinearMonitor.residual_vetor">residual_vetor</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.set_maximum_iter_num">set_maximum_iter_num</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.from_scratch">from_scratch</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.display_criteria_info">display_criteria_info</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.display_iterations_report">display_iterations_report</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.link_monitor_to_solver">link_monitor_to_solver</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.update_status">update_status</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.write_termination_status">write_termination_status</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.evaluate_all_criteria">evaluate_all_criteria</a>
                        </li>
                        <li>
                                <a class="function" href="#NonLinearMonitor.disable_all_criteria">disable_all_criteria</a>
                        </li>
                </ul>

            </li>
    </ul>


            <footer>Hugo LÃ©vy PhD Thesis</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../femtoscope.html">femtoscope</a><wbr>.<a href="./../core.html">core</a><wbr>.nonlinear_monitoring    </h1>

                        <div class="docstring"><p>Created on Sun Apr  7 19:47:24 2024</p>

<p>Definition of stopping criteria and 'NonLinearMonitor' class.
Instances of classes 'NonLinearSolver' and 'NonLinearMonitor' are interlinked.</p>
</div>

                        <input id="mod-nonlinear_monitoring-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-nonlinear_monitoring-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">Created on Sun Apr  7 19:47:24 2024</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">Definition of stopping criteria and &#39;NonLinearMonitor&#39; class.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">Instances of classes &#39;NonLinearSolver&#39; and &#39;NonLinearMonitor&#39; are interlinked.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Iterable</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">numbers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Number</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">femtoscope.core.weak_form</span><span class="w"> </span><span class="kn">import</span> <span class="n">WeakForm</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">femtoscope.core.solvers</span><span class="w"> </span><span class="kn">import</span> <span class="n">NonLinearSolver</span>  <span class="c1"># Only for type hints</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_criteria_dict</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    Retrieve all child classes of `Criterion` and put them in a dictionary</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    (using their name as keys).</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    Returns</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    -------</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    criteria_dict : dict</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        Dictionary of all currently implemented criteria.</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="n">clsmembers</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">],</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="n">criteria_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">clsmembers</span><span class="p">:</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">member</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Criterion</span><span class="p">)</span> <span class="ow">and</span> <span class="n">member</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">__base__</span> <span class="o">!=</span> <span class="n">ABC</span><span class="p">:</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>            <span class="n">criteria_dict</span><span class="p">[</span><span class="n">member</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">member</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="k">return</span> <span class="n">criteria_dict</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Decorators</span><span class="p">:</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for defining decorators.&quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_wf_residual</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        Check that the weak form &#39;wf_residual&#39; has been correctly set in the</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">        nonlinear solver attribute `wf_dict` before calling a criterion that</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        rely on it.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>            <span class="n">crit_instance</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>            <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>            <span class="k">if</span> <span class="n">nl_solver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;NonLinearMonitor&#39; instance is not yet&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>                                 <span class="s2">&quot;linked to a &#39;NonLinearSolver&#39; instance!&quot;</span><span class="p">)</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>            <span class="k">if</span> <span class="s1">&#39;wf_residual&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">:</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Criterion </span><span class="si">{</span><span class="n">crit_instance</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>                               <span class="sa">f</span><span class="s2">&quot;requires &#39;wf_residual&#39;&quot;</span><span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">[</span><span class="s1">&#39;wf_residual&#39;</span><span class="p">],</span> <span class="n">WeakForm</span><span class="p">):</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;wf_residual&#39; is not set properly!&quot;</span><span class="p">)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">not_zeroth_iteration</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that at least one iteration has been completed.&quot;&quot;&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>            <span class="k">if</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>                <span class="k">return</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Criterion</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    Template for criteria implementation (abstract class).</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">    Attributes</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    ----------</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">    threshold : Number</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        Criterion&#39;s threshold value. The criterion is met when its `value`</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        crosses the threshold. It is automatically set to &#39;-1&#39; when the</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        criterion is not active (see below).</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">    status : dict</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        Boolean dictionary containing information about the current status of</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        the criterion, with keys:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        - &#39;stop&#39; : bool</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">            Whether the criterion is met.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        - &#39;look&#39; : bool</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">            Whether the criterion should be evaluated or not.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        - &#39;active&#39; : bool</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">            Whether the criterion is taken into account for deciding to end</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">            the iterative algorithm.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">    value : Union[Number, np.ndarray, dict]</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        Current value associated with the criterion.</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">    history : dict</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        Dictionary containing the criterion&#39;s value for all past iterations.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">        Keys are integers representing the iteration number.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>    <span class="nd">@property</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">priority</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="k">pass</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span> <span class="n">look</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">active</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="n">look</span> <span class="o">=</span> <span class="n">active</span> <span class="k">if</span> <span class="n">active</span> <span class="k">else</span> <span class="n">look</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span> <span class="k">if</span> <span class="n">active</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;stop&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;look&#39;</span><span class="p">:</span> <span class="n">look</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="n">active</span><span class="p">}</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="nd">@property</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">        Performs 3 tasks:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">        (i) Evaluate the criterion&#39;s current value</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        (ii) Update its status accordingly</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">        (iii) Fill in its history by calling method `update_history`</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        Parameters</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">        ----------</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">        nonlinear_monitor : NonLinearMonitor</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">            Instance of class `NonLinearMonitor` used to evaluate the criterion.</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Store current criterion value in attribute `history`.&quot;&quot;&quot;</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Output message is the present criterion is responsible for the</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">        algorithm termination.&quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MaximumIterations</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Maximum number of iterations $k &lt; \text{threshold}$&quot;&quot;&quot;</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="sa">f</span><span class="s2">&quot;End of iterations: the maximum number of iterations &quot;</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>            <span class="sa">f</span><span class="s2">&quot;(= </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="si">}</span><span class="s2">) has been reached.&quot;</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="k">class</span><span class="w"> </span><span class="nc">RelativeDeltaSolutionNorm2</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">    Relative delta on the solution between two consecutive iterations (in</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">    2-norm), i.e.</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">    $$ \frac{\| u_k - u_{k-1} \|_2}{\| u_{k-1} \|_2} &lt; \text{threshold} $$</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">not_zeroth_iteration</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="n">old_int</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">old_int</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="n">sol_int</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">sol_int</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_int</span> <span class="o">-</span> <span class="n">old_int</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">old_int</span><span class="p">)</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="n">sol_ext</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">sol_ext</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="n">sol_ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="n">old_ext</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">old_ext</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="n">value</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_ext</span> <span class="o">-</span> <span class="n">old_ext</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">old_ext</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>            <span class="s2">&quot;End of iterations: the relative variation of the solution vector &quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>            <span class="s2">&quot;(in 2-norm) between two consecutive iterations is smaller than &quot;</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="s2">&quot;the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="k">class</span><span class="w"> </span><span class="nc">AbsoluteDeltaSolutionNorm2</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">    Absolute delta on the solution between two consecutive iterations (in</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">    2-norm), i.e.</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">    $$ \| u_k - u_{k-1} \|_2 &lt; \text{threshold} $$</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">not_zeroth_iteration</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="n">old_int</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">old_int</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="n">sol_int</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">sol_int</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_int</span> <span class="o">-</span> <span class="n">old_int</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="n">sol_ext</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">sol_ext</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="n">sol_ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="n">old_ext</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">old_ext</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>            <span class="n">value</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_ext</span> <span class="o">-</span> <span class="n">old_ext</span><span class="p">)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>            <span class="s2">&quot;End of iterations: the variation of the solution vector (in &quot;</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="s2">&quot;2-norm) between two consecutive iterations is smaller than the &quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>            <span class="s2">&quot;specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>        <span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualVector</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Residual vector (look only, not active).&quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_wf_residual</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See NonLinearSolver.evaluate_residual_vector for the implementation</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        of the residual computation.&quot;&quot;&quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">evaluate_residual_vector</span><span class="p">()</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="k">pass</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualVectorParts</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">    Residual vector parts (look only, not active). Decomposition of the</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">    residual vector $R$ into</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">    $$ R = A u_k - rhs_{\text{cst}} - rhs_{\text{mod}} $$</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">    The `value` attribute is a dictionary with keys</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">    (&#39;mtx_term&#39;, &#39;rhs_cst_term&#39;, &#39;rhs_mod_term&#39;).</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_wf_residual</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See NonLinearSolver.evaluate_residual_vector_parts for the</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">        implementation.&quot;&quot;&quot;</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">evaluate_residual_vector_parts</span><span class="p">()</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="k">pass</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualVectorNorm2</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;2-norm of the residual vector.&quot;&quot;&quot;</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="n">residual_vector</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">residual_vetor</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="n">norm2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">residual_vector</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">norm2</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>            <span class="s2">&quot;End of iterations: the 2-norm of the residual vector is smaller &quot;</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>            <span class="s2">&quot;than the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="p">)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="k">class</span><span class="w"> </span><span class="nc">RelativeDeltaResidualNorm2</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">    Relative variation of the residual vector in 2-norm, i.e.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">    $$ \frac{\| R_k - R_{k-1} \|_2}{\| R_{k-1} \|_2} &lt; \text{threshold} $$</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">not_zeroth_iteration</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="n">res_vec</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">residual_vetor</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="n">res_vec_old</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">_get_residual_vector_at_iteration</span><span class="p">(</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="n">it</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec</span> <span class="o">-</span> <span class="n">res_vec_old</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>            <span class="s2">&quot;End of iterations: the relative variation of the residual vector &quot;</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="s2">&quot;(in 2-norm) between two consecutive iterations is smaller than &quot;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>            <span class="s2">&quot;the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualReductionFactor</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">    Ratio $\| R_k \|_2 / \| R_0 \|_2$, i.e. reduction factor in the 2-norm of</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">    the residual vector.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="n">res_vec</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">residual_vetor</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="n">res_vec_initial</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">_get_residual_vector_at_iteration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec_initial</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>            <span class="s2">&quot;End of iterations: the residual vector has decreased by </span><span class="si">{:.1f}</span><span class="s2">% &quot;</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>            <span class="s2">&quot;(in 2-norm) between the initial guess and the current iterate, &quot;</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>            <span class="s2">&quot;which is smaller than the specified threshold = </span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="k">class</span><span class="w"> </span><span class="nc">NonLinearMonitor</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">    Class for monitoring a `NonLinearSolver` object while solving a nonlinear</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">    problem.</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">    Attributes</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">    ----------</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">    criteria_class_dict : dict</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        Class attribute. (criterion-name: criterion-class) key-value pairs.</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">    stop : bool</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        Toggle for putting an end to the iterative algorithm.</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">    current_iter_num : int</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        Current iteration number.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">    minimum_iter_num : int</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">        Minimum number of iterations to be completed (lower threshold).</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">    criteria : dict</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">        Dictionary of criteria (child instances of parent abstract class</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">        `Criterion`) to be evaluated at the end of each iteration.</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">    nonlinear_solver : NonLinearSolver</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        Instance of the `NonLinearSolver` class that is being monitored.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>    <span class="n">criteria_class_dict</span> <span class="o">=</span> <span class="n">get_criteria_dict</span><span class="p">()</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_iter_num</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nonlinear_solver</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>    <span class="nd">@property</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">maximum_iter_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Maximum number of iterations to be completed (upper threshold).&quot;&quot;&quot;</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>    <span class="nd">@property</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">residual_vetor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="k">if</span> <span class="s1">&#39;ResidualVector&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;ResidualVector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_maximum_iter_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maximum_iter_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">maximum_iter_num</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_scratch</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NonLinearMonitor</span><span class="p">:</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a><span class="sd">        Create an instance of `NonLinearMonitor` and set its attributes using</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">        the user provided `args_dict`, which contains the following items:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="sd">        Parameters</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a><span class="sd">        ----------</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="sd">        minimum_iter_num : int</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">            Minimum number of iterations to be completed (lower threshold).</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">        maximum_iter_num : int</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">            Maximum number of iterations to be completed (upper threshold).</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">        criteria : Tuple[dict]</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">            Tuple of dictionaries. Each dictionary corresponds to a given</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">            criterion, with keys</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">                - &#39;name&#39;: the name of the criterion</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">                - &#39;threshold&#39;: the criterion&#39;s threshold</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">                - &#39;look&#39;: Whether the criterion should be evaluated</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">                - &#39;active&#39;: Whether the criterion is involved in the</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">                decision-making process for stopping the algorithm</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">        Notes</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        -----</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        Sometimes, one may want to evaluate a given criterion to get more</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        information about the current state of the iterations without making</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        the stopping of the algorithm dependent on it. This &#39;information only&#39;</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        mode is achieved by specifying (&#39;active&#39; = False, &#39;look&#39; = True).</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">        On the other hand, if a given criterion is set active, it will</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        automatically be evaluated, regardless of the &#39;look&#39; setting.</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        Returns</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">        -------</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">        monitor : NonLinearMonitor</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">            The created NonLinearMonitor.</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>        <span class="c1"># Create a new NonLinearMonitor object</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>        <span class="n">monitor</span> <span class="o">=</span> <span class="n">NonLinearMonitor</span><span class="p">()</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="c1"># Fill in min/max number of iterations</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>        <span class="k">if</span> <span class="s1">&#39;minimum_iter_num&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>            <span class="n">monitor</span><span class="o">.</span><span class="n">minimum_iter_num</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;minimum_iter_num&#39;</span><span class="p">]</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="s1">&#39;maximum_iter_num&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>            <span class="n">maximum_iter_num</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;maximum_iter_num&#39;</span><span class="p">]</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;&#39;maximum_iter_num&#39; must be specified by the user!&quot;</span><span class="p">)</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>        <span class="k">assert</span> <span class="n">monitor</span><span class="o">.</span><span class="n">minimum_iter_num</span> <span class="o">&lt;=</span> <span class="n">maximum_iter_num</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="c1"># Fill in MaximumIterations criterion</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>        <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>        <span class="n">max_iter_crit</span> <span class="o">=</span> <span class="n">MaximumIterations</span><span class="p">(</span><span class="n">maximum_iter_num</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>        <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_iter_crit</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="c1"># Fill in all other criteria</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>        <span class="n">criteria</span> <span class="o">=</span> <span class="n">args_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_check_criteria_input</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>            <span class="n">threshold</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>            <span class="n">active</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>            <span class="n">look</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;look&#39;</span><span class="p">,</span> <span class="n">active</span><span class="p">)</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>            <span class="n">crit</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">criteria_class_dict</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">threshold</span><span class="p">,</span> <span class="n">look</span><span class="p">,</span> <span class="n">active</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>            <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>        <span class="k">return</span> <span class="n">monitor</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_criteria_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">        Display information regarding the registered criteria in</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">        `self.criteria`.</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">        Parameters</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        ----------</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        cols : Tuple[str]</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">            Keys for displayed information (see `valid_entries` in function</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">            definition).</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>        <span class="c1"># Preset</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>        <span class="n">valid_entries</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>            <span class="s1">&#39;criterion&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">,</span> <span class="s1">&#39;look&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>        <span class="n">actual_entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>        <span class="k">if</span> <span class="s1">&#39;criterion&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;criterion&#39;</span><span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="n">criteria_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># shallow copy of dictionary</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">crit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crit</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>                    <span class="n">criteria_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="c1"># Fill in data_dict</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="k">assert</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">valid_entries</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Entry &#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">&#39; is not valid!&quot;</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>            <span class="n">actual_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>            <span class="n">entry_data_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>            <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="s1">&#39;criterion&#39;</span><span class="p">:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>                <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria_copy</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>                    <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>                <span class="n">data_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_data_list</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>                <span class="k">continue</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>            <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria_copy</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>                    <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="s1">&#39;value&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>                        <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>                        <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">entry</span><span class="p">))</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>                <span class="k">elif</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>                    <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">entry</span><span class="p">])</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find entry &#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>                <span class="n">data_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_data_list</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>        <span class="c1"># Create pandas DataFrame and sort the columns</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>        <span class="n">sort_key_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">valid_entries</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">actual_entries</span><span class="p">]</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>        <span class="n">sorted_zip</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sort_key_list</span><span class="p">,</span> <span class="n">actual_entries</span><span class="p">))</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">actual_entries</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">sorted_zip</span><span class="p">)</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">actual_entries</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>        <span class="c1"># Display information</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_dataframe_string_iter</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">output_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_iterations_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">        Display criteria&#39;s value for all iterations.</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">        Notes</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">        -----</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">        The criteria considered here are those for which the `value` field is a</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">        number.</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">        todo: remove the NaN when the iterations stop before &#39;maximum_iter_num&#39;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>            <span class="s1">&#39;iter&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maximum_iter_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>        <span class="p">}</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>        <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crit</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="ow">or</span> \
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>                    <span class="n">crit</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MaximumIterations&#39;</span><span class="p">:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>                <span class="k">continue</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>            <span class="n">data_dict</span><span class="p">[</span><span class="n">crit</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>                <span class="n">crit</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="n">crit</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;iter&#39;</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_iter_num</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>                <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="s1">&#39;__&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_dataframe_string_report</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">output_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">link_monitor_to_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nl_solver</span><span class="p">:</span> <span class="s2">&quot;NonLinearSolver&quot;</span><span class="p">):</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="sd">        Link the current `NonLinearMonitor` instance to a given</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">        `NonLinearSolver` instance. This link is two-way in the sense that the</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">        two class instances hold themselves as attributes.</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="sd">        Parameters</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">        ----------</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="sd">        nl_solver : NonLinearSolver</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a><span class="sd">            Instance of the class `NonLinearSolver` to be monitored.</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">        Notes</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">        -----</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        One can either link with the present function, or equivalently with</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        `NonLinearSolver.link_solver_to_monitor`.</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nonlinear_solver</span> <span class="o">=</span> <span class="n">nl_solver</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>        <span class="n">nl_solver</span><span class="o">.</span><span class="n">nonlinear_monitor</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">        Update the `stop` attribute based on the status of all active criteria.</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">        todo: in the future, it might be nice to have the possibility to</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">            combine several criteria together for determining whether to stop</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">            the algorithm</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>        <span class="c1"># Check if one criterion has been met</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_iter_num</span><span class="p">:</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>            <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>                    <span class="k">continue</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>                <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_fill_history_holes_with_none</span><span class="p">()</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>                    <span class="k">return</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_termination_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the termination message associated with the criterion that has</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a><span class="sd">        been met.&quot;&quot;&quot;</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]:</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>                <span class="n">criterion</span><span class="o">.</span><span class="n">write_stop_message</span><span class="p">()</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_all_criteria</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate all criteria registered in `self.criteria`.&quot;&quot;&quot;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sorted_criteria_list</span><span class="p">():</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;look&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]:</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>                <span class="k">continue</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>            <span class="n">criterion</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">disable_all_criteria</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set `active=False` for all criteria but &#39;MaximumIterations&#39;.&quot;&quot;&quot;</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>            <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_sorted_criteria_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Criterion</span><span class="p">]:</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a><span class="sd">        Sort values of `criteria` dictionary according to their `priority`</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a><span class="sd">        attribute.</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a><span class="sd">        Returns</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a><span class="sd">        -------</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a><span class="sd">        List of sorted `Criterion` instances.</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>        <span class="n">priority_line</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>        <span class="n">waiting_line</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">priority</span><span class="p">:</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>                <span class="n">priority_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>                <span class="n">waiting_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>        <span class="k">return</span> <span class="n">priority_line</span> <span class="o">+</span> <span class="n">waiting_line</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_residual_vector_at_iteration</span><span class="p">(</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">iteration_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve residual vector at a given iteration.&quot;&quot;&quot;</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;ResidualVector&#39;</span><span class="p">:</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>                <span class="k">return</span> <span class="n">criterion</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">iteration_number</span><span class="p">]</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_dataframe_string_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format dataframe string for subsequent printing of iteration info.&quot;&quot;&quot;</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>        <span class="n">df_str</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">col_space</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>                                     <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>        <span class="k">if</span> <span class="n">it</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; MONITORING PARAMETERS &quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; ITERATION NO </span><span class="si">{:d}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>        <span class="n">bottom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>        <span class="k">return</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">df_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">bottom</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_dataframe_string_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format dataframe string for subsequent printing of report info.&quot;&quot;&quot;</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>        <span class="n">df_str</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">col_space</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>                                     <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>                                     <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; RECAP OF ALL ITERATIONS &quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>        <span class="n">bottom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>        <span class="k">return</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">df_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">bottom</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_fill_history_holes_with_none</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maximum_iter_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>            <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">criterion</span><span class="o">.</span><span class="n">history</span><span class="p">:</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>                    <span class="n">criterion</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>                <span class="n">criterion</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_check_criteria_input</span><span class="p">(</span><span class="n">criteria</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Criterion</span><span class="p">]):</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a><span class="sd">        Check that the user-provided `criteria` tuple complies with</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a><span class="sd">        `from_scratch` method (see docstring above).</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>        <span class="k">if</span> <span class="n">criteria</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>        <span class="n">mandatory_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">]</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>        <span class="c1"># Check that criteria is iterable</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criteria</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;criteria&#39; should be a tuple, not a &quot;</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>            <span class="c1"># Check type of each item</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;criteria&#39; items should be dictionaries, &quot;</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>                                <span class="sa">f</span><span class="s2">&quot;but one item is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>            <span class="c1"># Check keys of each item</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">criterion</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mandatory_keys</span><span class="p">):</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>                    <span class="sa">f</span><span class="s2">&quot;Missing (at least) one key from </span><span class="si">{</span><span class="n">mandatory_keys</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>            <span class="c1"># Check name of the criterion</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NonLinearMonitor</span><span class="o">.</span><span class="n">criteria_class_dict</span><span class="p">:</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>                    <span class="sa">f</span><span class="s2">&quot;Criterion &#39;</span><span class="si">{</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; is not implemented yet&quot;</span><span class="p">)</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>            <span class="c1"># Check types</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">],</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;threshold&#39; should be a float, but is of type&quot;</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> instead&quot;</span><span class="p">)</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">],</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;active&#39; should a boolean, but is of type&quot;</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> instead&quot;</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="get_criteria_dict">
                            <input id="get_criteria_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_criteria_dict</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="get_criteria_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_criteria_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_criteria_dict-31"><a href="#get_criteria_dict-31"><span class="linenos">31</span></a><span class="k">def</span><span class="w"> </span><span class="nf">get_criteria_dict</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="get_criteria_dict-32"><a href="#get_criteria_dict-32"><span class="linenos">32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_criteria_dict-33"><a href="#get_criteria_dict-33"><span class="linenos">33</span></a><span class="sd">    Retrieve all child classes of `Criterion` and put them in a dictionary</span>
</span><span id="get_criteria_dict-34"><a href="#get_criteria_dict-34"><span class="linenos">34</span></a><span class="sd">    (using their name as keys).</span>
</span><span id="get_criteria_dict-35"><a href="#get_criteria_dict-35"><span class="linenos">35</span></a>
</span><span id="get_criteria_dict-36"><a href="#get_criteria_dict-36"><span class="linenos">36</span></a><span class="sd">    Returns</span>
</span><span id="get_criteria_dict-37"><a href="#get_criteria_dict-37"><span class="linenos">37</span></a><span class="sd">    -------</span>
</span><span id="get_criteria_dict-38"><a href="#get_criteria_dict-38"><span class="linenos">38</span></a><span class="sd">    criteria_dict : dict</span>
</span><span id="get_criteria_dict-39"><a href="#get_criteria_dict-39"><span class="linenos">39</span></a><span class="sd">        Dictionary of all currently implemented criteria.</span>
</span><span id="get_criteria_dict-40"><a href="#get_criteria_dict-40"><span class="linenos">40</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_criteria_dict-41"><a href="#get_criteria_dict-41"><span class="linenos">41</span></a>    <span class="n">clsmembers</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">],</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">)</span>
</span><span id="get_criteria_dict-42"><a href="#get_criteria_dict-42"><span class="linenos">42</span></a>    <span class="n">criteria_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="get_criteria_dict-43"><a href="#get_criteria_dict-43"><span class="linenos">43</span></a>    <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">clsmembers</span><span class="p">:</span>
</span><span id="get_criteria_dict-44"><a href="#get_criteria_dict-44"><span class="linenos">44</span></a>        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">member</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Criterion</span><span class="p">)</span> <span class="ow">and</span> <span class="n">member</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">__base__</span> <span class="o">!=</span> <span class="n">ABC</span><span class="p">:</span>
</span><span id="get_criteria_dict-45"><a href="#get_criteria_dict-45"><span class="linenos">45</span></a>            <span class="n">criteria_dict</span><span class="p">[</span><span class="n">member</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">member</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="get_criteria_dict-46"><a href="#get_criteria_dict-46"><span class="linenos">46</span></a>    <span class="k">return</span> <span class="n">criteria_dict</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve all child classes of <code><a href="#Criterion">Criterion</a></code> and put them in a dictionary
(using their name as keys).</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>criteria_dict</strong> (dict):
Dictionary of all currently implemented criteria.</li>
</ul>
</div>


                </section>
                <section id="Decorators">
                            <input id="Decorators-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Decorators</span>:

                <label class="view-source-button" for="Decorators-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Decorators"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Decorators-49"><a href="#Decorators-49"><span class="linenos">49</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Decorators</span><span class="p">:</span>
</span><span id="Decorators-50"><a href="#Decorators-50"><span class="linenos">50</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for defining decorators.&quot;&quot;&quot;</span>
</span><span id="Decorators-51"><a href="#Decorators-51"><span class="linenos">51</span></a>
</span><span id="Decorators-52"><a href="#Decorators-52"><span class="linenos">52</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Decorators-53"><a href="#Decorators-53"><span class="linenos">53</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_wf_residual</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Decorators-54"><a href="#Decorators-54"><span class="linenos">54</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Decorators-55"><a href="#Decorators-55"><span class="linenos">55</span></a><span class="sd">        Check that the weak form &#39;wf_residual&#39; has been correctly set in the</span>
</span><span id="Decorators-56"><a href="#Decorators-56"><span class="linenos">56</span></a><span class="sd">        nonlinear solver attribute `wf_dict` before calling a criterion that</span>
</span><span id="Decorators-57"><a href="#Decorators-57"><span class="linenos">57</span></a><span class="sd">        rely on it.</span>
</span><span id="Decorators-58"><a href="#Decorators-58"><span class="linenos">58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Decorators-59"><a href="#Decorators-59"><span class="linenos">59</span></a>
</span><span id="Decorators-60"><a href="#Decorators-60"><span class="linenos">60</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="Decorators-61"><a href="#Decorators-61"><span class="linenos">61</span></a>            <span class="n">crit_instance</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Decorators-62"><a href="#Decorators-62"><span class="linenos">62</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Decorators-63"><a href="#Decorators-63"><span class="linenos">63</span></a>            <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="Decorators-64"><a href="#Decorators-64"><span class="linenos">64</span></a>            <span class="k">if</span> <span class="n">nl_solver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Decorators-65"><a href="#Decorators-65"><span class="linenos">65</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;NonLinearMonitor&#39; instance is not yet&quot;</span>
</span><span id="Decorators-66"><a href="#Decorators-66"><span class="linenos">66</span></a>                                 <span class="s2">&quot;linked to a &#39;NonLinearSolver&#39; instance!&quot;</span><span class="p">)</span>
</span><span id="Decorators-67"><a href="#Decorators-67"><span class="linenos">67</span></a>            <span class="k">if</span> <span class="s1">&#39;wf_residual&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">:</span>
</span><span id="Decorators-68"><a href="#Decorators-68"><span class="linenos">68</span></a>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Criterion </span><span class="si">{</span><span class="n">crit_instance</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Decorators-69"><a href="#Decorators-69"><span class="linenos">69</span></a>                               <span class="sa">f</span><span class="s2">&quot;requires &#39;wf_residual&#39;&quot;</span><span class="p">)</span>
</span><span id="Decorators-70"><a href="#Decorators-70"><span class="linenos">70</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">[</span><span class="s1">&#39;wf_residual&#39;</span><span class="p">],</span> <span class="n">WeakForm</span><span class="p">):</span>
</span><span id="Decorators-71"><a href="#Decorators-71"><span class="linenos">71</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;wf_residual&#39; is not set properly!&quot;</span><span class="p">)</span>
</span><span id="Decorators-72"><a href="#Decorators-72"><span class="linenos">72</span></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Decorators-73"><a href="#Decorators-73"><span class="linenos">73</span></a>
</span><span id="Decorators-74"><a href="#Decorators-74"><span class="linenos">74</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="Decorators-75"><a href="#Decorators-75"><span class="linenos">75</span></a>
</span><span id="Decorators-76"><a href="#Decorators-76"><span class="linenos">76</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Decorators-77"><a href="#Decorators-77"><span class="linenos">77</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">not_zeroth_iteration</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Decorators-78"><a href="#Decorators-78"><span class="linenos">78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that at least one iteration has been completed.&quot;&quot;&quot;</span>
</span><span id="Decorators-79"><a href="#Decorators-79"><span class="linenos">79</span></a>
</span><span id="Decorators-80"><a href="#Decorators-80"><span class="linenos">80</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="Decorators-81"><a href="#Decorators-81"><span class="linenos">81</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Decorators-82"><a href="#Decorators-82"><span class="linenos">82</span></a>            <span class="k">if</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Decorators-83"><a href="#Decorators-83"><span class="linenos">83</span></a>                <span class="k">return</span>
</span><span id="Decorators-84"><a href="#Decorators-84"><span class="linenos">84</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Decorators-85"><a href="#Decorators-85"><span class="linenos">85</span></a>                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Decorators-86"><a href="#Decorators-86"><span class="linenos">86</span></a>
</span><span id="Decorators-87"><a href="#Decorators-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>Class for defining decorators.</p>
</div>


                            <div id="Decorators.check_wf_residual" class="classattr">
                                        <input id="Decorators.check_wf_residual-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">check_wf_residual</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Decorators.check_wf_residual-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Decorators.check_wf_residual"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Decorators.check_wf_residual-52"><a href="#Decorators.check_wf_residual-52"><span class="linenos">52</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Decorators.check_wf_residual-53"><a href="#Decorators.check_wf_residual-53"><span class="linenos">53</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_wf_residual</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Decorators.check_wf_residual-54"><a href="#Decorators.check_wf_residual-54"><span class="linenos">54</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Decorators.check_wf_residual-55"><a href="#Decorators.check_wf_residual-55"><span class="linenos">55</span></a><span class="sd">        Check that the weak form &#39;wf_residual&#39; has been correctly set in the</span>
</span><span id="Decorators.check_wf_residual-56"><a href="#Decorators.check_wf_residual-56"><span class="linenos">56</span></a><span class="sd">        nonlinear solver attribute `wf_dict` before calling a criterion that</span>
</span><span id="Decorators.check_wf_residual-57"><a href="#Decorators.check_wf_residual-57"><span class="linenos">57</span></a><span class="sd">        rely on it.</span>
</span><span id="Decorators.check_wf_residual-58"><a href="#Decorators.check_wf_residual-58"><span class="linenos">58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Decorators.check_wf_residual-59"><a href="#Decorators.check_wf_residual-59"><span class="linenos">59</span></a>
</span><span id="Decorators.check_wf_residual-60"><a href="#Decorators.check_wf_residual-60"><span class="linenos">60</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="Decorators.check_wf_residual-61"><a href="#Decorators.check_wf_residual-61"><span class="linenos">61</span></a>            <span class="n">crit_instance</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Decorators.check_wf_residual-62"><a href="#Decorators.check_wf_residual-62"><span class="linenos">62</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Decorators.check_wf_residual-63"><a href="#Decorators.check_wf_residual-63"><span class="linenos">63</span></a>            <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="Decorators.check_wf_residual-64"><a href="#Decorators.check_wf_residual-64"><span class="linenos">64</span></a>            <span class="k">if</span> <span class="n">nl_solver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Decorators.check_wf_residual-65"><a href="#Decorators.check_wf_residual-65"><span class="linenos">65</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;NonLinearMonitor&#39; instance is not yet&quot;</span>
</span><span id="Decorators.check_wf_residual-66"><a href="#Decorators.check_wf_residual-66"><span class="linenos">66</span></a>                                 <span class="s2">&quot;linked to a &#39;NonLinearSolver&#39; instance!&quot;</span><span class="p">)</span>
</span><span id="Decorators.check_wf_residual-67"><a href="#Decorators.check_wf_residual-67"><span class="linenos">67</span></a>            <span class="k">if</span> <span class="s1">&#39;wf_residual&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">:</span>
</span><span id="Decorators.check_wf_residual-68"><a href="#Decorators.check_wf_residual-68"><span class="linenos">68</span></a>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Criterion </span><span class="si">{</span><span class="n">crit_instance</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="Decorators.check_wf_residual-69"><a href="#Decorators.check_wf_residual-69"><span class="linenos">69</span></a>                               <span class="sa">f</span><span class="s2">&quot;requires &#39;wf_residual&#39;&quot;</span><span class="p">)</span>
</span><span id="Decorators.check_wf_residual-70"><a href="#Decorators.check_wf_residual-70"><span class="linenos">70</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">[</span><span class="s1">&#39;wf_residual&#39;</span><span class="p">],</span> <span class="n">WeakForm</span><span class="p">):</span>
</span><span id="Decorators.check_wf_residual-71"><a href="#Decorators.check_wf_residual-71"><span class="linenos">71</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;wf_residual&#39; is not set properly!&quot;</span><span class="p">)</span>
</span><span id="Decorators.check_wf_residual-72"><a href="#Decorators.check_wf_residual-72"><span class="linenos">72</span></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Decorators.check_wf_residual-73"><a href="#Decorators.check_wf_residual-73"><span class="linenos">73</span></a>
</span><span id="Decorators.check_wf_residual-74"><a href="#Decorators.check_wf_residual-74"><span class="linenos">74</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>Check that the weak form 'wf_residual' has been correctly set in the
nonlinear solver attribute <code>wf_dict</code> before calling a criterion that
rely on it.</p>
</div>


                            </div>
                            <div id="Decorators.not_zeroth_iteration" class="classattr">
                                        <input id="Decorators.not_zeroth_iteration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">not_zeroth_iteration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Decorators.not_zeroth_iteration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Decorators.not_zeroth_iteration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Decorators.not_zeroth_iteration-76"><a href="#Decorators.not_zeroth_iteration-76"><span class="linenos">76</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Decorators.not_zeroth_iteration-77"><a href="#Decorators.not_zeroth_iteration-77"><span class="linenos">77</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">not_zeroth_iteration</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="Decorators.not_zeroth_iteration-78"><a href="#Decorators.not_zeroth_iteration-78"><span class="linenos">78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that at least one iteration has been completed.&quot;&quot;&quot;</span>
</span><span id="Decorators.not_zeroth_iteration-79"><a href="#Decorators.not_zeroth_iteration-79"><span class="linenos">79</span></a>
</span><span id="Decorators.not_zeroth_iteration-80"><a href="#Decorators.not_zeroth_iteration-80"><span class="linenos">80</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="Decorators.not_zeroth_iteration-81"><a href="#Decorators.not_zeroth_iteration-81"><span class="linenos">81</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Decorators.not_zeroth_iteration-82"><a href="#Decorators.not_zeroth_iteration-82"><span class="linenos">82</span></a>            <span class="k">if</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Decorators.not_zeroth_iteration-83"><a href="#Decorators.not_zeroth_iteration-83"><span class="linenos">83</span></a>                <span class="k">return</span>
</span><span id="Decorators.not_zeroth_iteration-84"><a href="#Decorators.not_zeroth_iteration-84"><span class="linenos">84</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Decorators.not_zeroth_iteration-85"><a href="#Decorators.not_zeroth_iteration-85"><span class="linenos">85</span></a>                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span><span id="Decorators.not_zeroth_iteration-86"><a href="#Decorators.not_zeroth_iteration-86"><span class="linenos">86</span></a>
</span><span id="Decorators.not_zeroth_iteration-87"><a href="#Decorators.not_zeroth_iteration-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>Check that at least one iteration has been completed.</p>
</div>


                            </div>
                </section>
                <section id="Criterion">
                            <input id="Criterion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Criterion</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="Criterion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Criterion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Criterion-90"><a href="#Criterion-90"><span class="linenos"> 90</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Criterion</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="Criterion-91"><a href="#Criterion-91"><span class="linenos"> 91</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Criterion-92"><a href="#Criterion-92"><span class="linenos"> 92</span></a><span class="sd">    Template for criteria implementation (abstract class).</span>
</span><span id="Criterion-93"><a href="#Criterion-93"><span class="linenos"> 93</span></a>
</span><span id="Criterion-94"><a href="#Criterion-94"><span class="linenos"> 94</span></a><span class="sd">    Attributes</span>
</span><span id="Criterion-95"><a href="#Criterion-95"><span class="linenos"> 95</span></a><span class="sd">    ----------</span>
</span><span id="Criterion-96"><a href="#Criterion-96"><span class="linenos"> 96</span></a><span class="sd">    threshold : Number</span>
</span><span id="Criterion-97"><a href="#Criterion-97"><span class="linenos"> 97</span></a><span class="sd">        Criterion&#39;s threshold value. The criterion is met when its `value`</span>
</span><span id="Criterion-98"><a href="#Criterion-98"><span class="linenos"> 98</span></a><span class="sd">        crosses the threshold. It is automatically set to &#39;-1&#39; when the</span>
</span><span id="Criterion-99"><a href="#Criterion-99"><span class="linenos"> 99</span></a><span class="sd">        criterion is not active (see below).</span>
</span><span id="Criterion-100"><a href="#Criterion-100"><span class="linenos">100</span></a><span class="sd">    status : dict</span>
</span><span id="Criterion-101"><a href="#Criterion-101"><span class="linenos">101</span></a><span class="sd">        Boolean dictionary containing information about the current status of</span>
</span><span id="Criterion-102"><a href="#Criterion-102"><span class="linenos">102</span></a><span class="sd">        the criterion, with keys:</span>
</span><span id="Criterion-103"><a href="#Criterion-103"><span class="linenos">103</span></a><span class="sd">        - &#39;stop&#39; : bool</span>
</span><span id="Criterion-104"><a href="#Criterion-104"><span class="linenos">104</span></a><span class="sd">            Whether the criterion is met.</span>
</span><span id="Criterion-105"><a href="#Criterion-105"><span class="linenos">105</span></a><span class="sd">        - &#39;look&#39; : bool</span>
</span><span id="Criterion-106"><a href="#Criterion-106"><span class="linenos">106</span></a><span class="sd">            Whether the criterion should be evaluated or not.</span>
</span><span id="Criterion-107"><a href="#Criterion-107"><span class="linenos">107</span></a><span class="sd">        - &#39;active&#39; : bool</span>
</span><span id="Criterion-108"><a href="#Criterion-108"><span class="linenos">108</span></a><span class="sd">            Whether the criterion is taken into account for deciding to end</span>
</span><span id="Criterion-109"><a href="#Criterion-109"><span class="linenos">109</span></a><span class="sd">            the iterative algorithm.</span>
</span><span id="Criterion-110"><a href="#Criterion-110"><span class="linenos">110</span></a><span class="sd">    value : Union[Number, np.ndarray, dict]</span>
</span><span id="Criterion-111"><a href="#Criterion-111"><span class="linenos">111</span></a><span class="sd">        Current value associated with the criterion.</span>
</span><span id="Criterion-112"><a href="#Criterion-112"><span class="linenos">112</span></a><span class="sd">    history : dict</span>
</span><span id="Criterion-113"><a href="#Criterion-113"><span class="linenos">113</span></a><span class="sd">        Dictionary containing the criterion&#39;s value for all past iterations.</span>
</span><span id="Criterion-114"><a href="#Criterion-114"><span class="linenos">114</span></a><span class="sd">        Keys are integers representing the iteration number.</span>
</span><span id="Criterion-115"><a href="#Criterion-115"><span class="linenos">115</span></a>
</span><span id="Criterion-116"><a href="#Criterion-116"><span class="linenos">116</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Criterion-117"><a href="#Criterion-117"><span class="linenos">117</span></a>
</span><span id="Criterion-118"><a href="#Criterion-118"><span class="linenos">118</span></a>    <span class="nd">@property</span>
</span><span id="Criterion-119"><a href="#Criterion-119"><span class="linenos">119</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Criterion-120"><a href="#Criterion-120"><span class="linenos">120</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">priority</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Criterion-121"><a href="#Criterion-121"><span class="linenos">121</span></a>        <span class="k">pass</span>
</span><span id="Criterion-122"><a href="#Criterion-122"><span class="linenos">122</span></a>
</span><span id="Criterion-123"><a href="#Criterion-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span> <span class="n">look</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">active</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="Criterion-124"><a href="#Criterion-124"><span class="linenos">124</span></a>        <span class="n">look</span> <span class="o">=</span> <span class="n">active</span> <span class="k">if</span> <span class="n">active</span> <span class="k">else</span> <span class="n">look</span>
</span><span id="Criterion-125"><a href="#Criterion-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span> <span class="k">if</span> <span class="n">active</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="Criterion-126"><a href="#Criterion-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;stop&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;look&#39;</span><span class="p">:</span> <span class="n">look</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">:</span> <span class="n">active</span><span class="p">}</span>
</span><span id="Criterion-127"><a href="#Criterion-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Criterion-128"><a href="#Criterion-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Criterion-129"><a href="#Criterion-129"><span class="linenos">129</span></a>
</span><span id="Criterion-130"><a href="#Criterion-130"><span class="linenos">130</span></a>    <span class="nd">@property</span>
</span><span id="Criterion-131"><a href="#Criterion-131"><span class="linenos">131</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Criterion-132"><a href="#Criterion-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
</span><span id="Criterion-133"><a href="#Criterion-133"><span class="linenos">133</span></a>
</span><span id="Criterion-134"><a href="#Criterion-134"><span class="linenos">134</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Criterion-135"><a href="#Criterion-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="Criterion-136"><a href="#Criterion-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Criterion-137"><a href="#Criterion-137"><span class="linenos">137</span></a><span class="sd">        Performs 3 tasks:</span>
</span><span id="Criterion-138"><a href="#Criterion-138"><span class="linenos">138</span></a><span class="sd">        (i) Evaluate the criterion&#39;s current value</span>
</span><span id="Criterion-139"><a href="#Criterion-139"><span class="linenos">139</span></a><span class="sd">        (ii) Update its status accordingly</span>
</span><span id="Criterion-140"><a href="#Criterion-140"><span class="linenos">140</span></a><span class="sd">        (iii) Fill in its history by calling method `update_history`</span>
</span><span id="Criterion-141"><a href="#Criterion-141"><span class="linenos">141</span></a>
</span><span id="Criterion-142"><a href="#Criterion-142"><span class="linenos">142</span></a><span class="sd">        Parameters</span>
</span><span id="Criterion-143"><a href="#Criterion-143"><span class="linenos">143</span></a><span class="sd">        ----------</span>
</span><span id="Criterion-144"><a href="#Criterion-144"><span class="linenos">144</span></a><span class="sd">        nonlinear_monitor : NonLinearMonitor</span>
</span><span id="Criterion-145"><a href="#Criterion-145"><span class="linenos">145</span></a><span class="sd">            Instance of class `NonLinearMonitor` used to evaluate the criterion.</span>
</span><span id="Criterion-146"><a href="#Criterion-146"><span class="linenos">146</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Criterion-147"><a href="#Criterion-147"><span class="linenos">147</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="Criterion-148"><a href="#Criterion-148"><span class="linenos">148</span></a>
</span><span id="Criterion-149"><a href="#Criterion-149"><span class="linenos">149</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Criterion-150"><a href="#Criterion-150"><span class="linenos">150</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="Criterion-151"><a href="#Criterion-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Store current criterion value in attribute `history`.&quot;&quot;&quot;</span>
</span><span id="Criterion-152"><a href="#Criterion-152"><span class="linenos">152</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="Criterion-153"><a href="#Criterion-153"><span class="linenos">153</span></a>
</span><span id="Criterion-154"><a href="#Criterion-154"><span class="linenos">154</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Criterion-155"><a href="#Criterion-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Criterion-156"><a href="#Criterion-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Output message is the present criterion is responsible for the</span>
</span><span id="Criterion-157"><a href="#Criterion-157"><span class="linenos">157</span></a><span class="sd">        algorithm termination.&quot;&quot;&quot;</span>
</span><span id="Criterion-158"><a href="#Criterion-158"><span class="linenos">158</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>Template for criteria implementation (abstract class).</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>threshold</strong> (Number):
Criterion's threshold value. The criterion is met when its <code><a href="#Criterion.value">value</a></code>
crosses the threshold. It is automatically set to '-1' when the
criterion is not active (see below).</li>
<li><strong>status</strong> (dict):
Boolean dictionary containing information about the current status of
the criterion, with keys:
<ul>
<li>'stop' : bool
Whether the criterion is met.</li>
<li>'look' : bool
Whether the criterion should be evaluated or not.</li>
<li>'active' : bool
Whether the criterion is taken into account for deciding to end
the iterative algorithm.</li>
</ul></li>
<li><strong>value</strong> (Union[Number, np.ndarray, dict]):
Current value associated with the criterion.</li>
<li><strong>history</strong> (dict):
Dictionary containing the criterion's value for all past iterations.
Keys are integers representing the iteration number.</li>
</ul>
</div>


                            <div id="Criterion.priority" class="classattr">
                                        <input id="Criterion.priority-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">priority</span>

                <label class="view-source-button" for="Criterion.priority-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Criterion.priority"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Criterion.priority-118"><a href="#Criterion.priority-118"><span class="linenos">118</span></a>    <span class="nd">@property</span>
</span><span id="Criterion.priority-119"><a href="#Criterion.priority-119"><span class="linenos">119</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Criterion.priority-120"><a href="#Criterion.priority-120"><span class="linenos">120</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">priority</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Criterion.priority-121"><a href="#Criterion.priority-121"><span class="linenos">121</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="Criterion.threshold" class="classattr">
                                <div class="attr variable">
            <span class="name">threshold</span>

        
    </div>
    <a class="headerlink" href="#Criterion.threshold"></a>
    
    

                            </div>
                            <div id="Criterion.status" class="classattr">
                                <div class="attr variable">
            <span class="name">status</span>

        
    </div>
    <a class="headerlink" href="#Criterion.status"></a>
    
    

                            </div>
                            <div id="Criterion.value" class="classattr">
                                <div class="attr variable">
            <span class="name">value</span>

        
    </div>
    <a class="headerlink" href="#Criterion.value"></a>
    
    

                            </div>
                            <div id="Criterion.history" class="classattr">
                                <div class="attr variable">
            <span class="name">history</span>

        
    </div>
    <a class="headerlink" href="#Criterion.history"></a>
    
    

                            </div>
                            <div id="Criterion.name" class="classattr">
                                        <input id="Criterion.name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">name</span>

                <label class="view-source-button" for="Criterion.name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Criterion.name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Criterion.name-130"><a href="#Criterion.name-130"><span class="linenos">130</span></a>    <span class="nd">@property</span>
</span><span id="Criterion.name-131"><a href="#Criterion.name-131"><span class="linenos">131</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Criterion.name-132"><a href="#Criterion.name-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
</span></pre></div>


    

                            </div>
                            <div id="Criterion.evaluate" class="classattr">
                                        <input id="Criterion.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Criterion.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Criterion.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Criterion.evaluate-134"><a href="#Criterion.evaluate-134"><span class="linenos">134</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Criterion.evaluate-135"><a href="#Criterion.evaluate-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="Criterion.evaluate-136"><a href="#Criterion.evaluate-136"><span class="linenos">136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Criterion.evaluate-137"><a href="#Criterion.evaluate-137"><span class="linenos">137</span></a><span class="sd">        Performs 3 tasks:</span>
</span><span id="Criterion.evaluate-138"><a href="#Criterion.evaluate-138"><span class="linenos">138</span></a><span class="sd">        (i) Evaluate the criterion&#39;s current value</span>
</span><span id="Criterion.evaluate-139"><a href="#Criterion.evaluate-139"><span class="linenos">139</span></a><span class="sd">        (ii) Update its status accordingly</span>
</span><span id="Criterion.evaluate-140"><a href="#Criterion.evaluate-140"><span class="linenos">140</span></a><span class="sd">        (iii) Fill in its history by calling method `update_history`</span>
</span><span id="Criterion.evaluate-141"><a href="#Criterion.evaluate-141"><span class="linenos">141</span></a>
</span><span id="Criterion.evaluate-142"><a href="#Criterion.evaluate-142"><span class="linenos">142</span></a><span class="sd">        Parameters</span>
</span><span id="Criterion.evaluate-143"><a href="#Criterion.evaluate-143"><span class="linenos">143</span></a><span class="sd">        ----------</span>
</span><span id="Criterion.evaluate-144"><a href="#Criterion.evaluate-144"><span class="linenos">144</span></a><span class="sd">        nonlinear_monitor : NonLinearMonitor</span>
</span><span id="Criterion.evaluate-145"><a href="#Criterion.evaluate-145"><span class="linenos">145</span></a><span class="sd">            Instance of class `NonLinearMonitor` used to evaluate the criterion.</span>
</span><span id="Criterion.evaluate-146"><a href="#Criterion.evaluate-146"><span class="linenos">146</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Criterion.evaluate-147"><a href="#Criterion.evaluate-147"><span class="linenos">147</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>Performs 3 tasks:
(i) Evaluate the criterion's current value
(ii) Update its status accordingly
(iii) Fill in its history by calling method <code><a href="#Criterion.update_history">update_history</a></code></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nonlinear_monitor</strong> (NonLinearMonitor):
Instance of class <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> used to evaluate the criterion.</li>
</ul>
</div>


                            </div>
                            <div id="Criterion.update_history" class="classattr">
                                        <input id="Criterion.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Criterion.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Criterion.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Criterion.update_history-149"><a href="#Criterion.update_history-149"><span class="linenos">149</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Criterion.update_history-150"><a href="#Criterion.update_history-150"><span class="linenos">150</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="Criterion.update_history-151"><a href="#Criterion.update_history-151"><span class="linenos">151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Store current criterion value in attribute `history`.&quot;&quot;&quot;</span>
</span><span id="Criterion.update_history-152"><a href="#Criterion.update_history-152"><span class="linenos">152</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#Criterion.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="Criterion.write_stop_message" class="classattr">
                                        <input id="Criterion.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Criterion.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Criterion.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Criterion.write_stop_message-154"><a href="#Criterion.write_stop_message-154"><span class="linenos">154</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Criterion.write_stop_message-155"><a href="#Criterion.write_stop_message-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Criterion.write_stop_message-156"><a href="#Criterion.write_stop_message-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Output message is the present criterion is responsible for the</span>
</span><span id="Criterion.write_stop_message-157"><a href="#Criterion.write_stop_message-157"><span class="linenos">157</span></a><span class="sd">        algorithm termination.&quot;&quot;&quot;</span>
</span><span id="Criterion.write_stop_message-158"><a href="#Criterion.write_stop_message-158"><span class="linenos">158</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                </section>
                <section id="MaximumIterations">
                            <input id="MaximumIterations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MaximumIterations</span><wbr>(<span class="base"><a href="#Criterion">Criterion</a></span>):

                <label class="view-source-button" for="MaximumIterations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MaximumIterations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MaximumIterations-161"><a href="#MaximumIterations-161"><span class="linenos">161</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MaximumIterations</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="MaximumIterations-162"><a href="#MaximumIterations-162"><span class="linenos">162</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Maximum number of iterations $k &lt; \text{threshold}$&quot;&quot;&quot;</span>
</span><span id="MaximumIterations-163"><a href="#MaximumIterations-163"><span class="linenos">163</span></a>
</span><span id="MaximumIterations-164"><a href="#MaximumIterations-164"><span class="linenos">164</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MaximumIterations-165"><a href="#MaximumIterations-165"><span class="linenos">165</span></a>
</span><span id="MaximumIterations-166"><a href="#MaximumIterations-166"><span class="linenos">166</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="MaximumIterations-167"><a href="#MaximumIterations-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="MaximumIterations-168"><a href="#MaximumIterations-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="MaximumIterations-169"><a href="#MaximumIterations-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="MaximumIterations-170"><a href="#MaximumIterations-170"><span class="linenos">170</span></a>
</span><span id="MaximumIterations-171"><a href="#MaximumIterations-171"><span class="linenos">171</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="MaximumIterations-172"><a href="#MaximumIterations-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="MaximumIterations-173"><a href="#MaximumIterations-173"><span class="linenos">173</span></a>
</span><span id="MaximumIterations-174"><a href="#MaximumIterations-174"><span class="linenos">174</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MaximumIterations-175"><a href="#MaximumIterations-175"><span class="linenos">175</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="MaximumIterations-176"><a href="#MaximumIterations-176"><span class="linenos">176</span></a>            <span class="sa">f</span><span class="s2">&quot;End of iterations: the maximum number of iterations &quot;</span>
</span><span id="MaximumIterations-177"><a href="#MaximumIterations-177"><span class="linenos">177</span></a>            <span class="sa">f</span><span class="s2">&quot;(= </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="si">}</span><span class="s2">) has been reached.&quot;</span>
</span><span id="MaximumIterations-178"><a href="#MaximumIterations-178"><span class="linenos">178</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Maximum number of iterations $k &lt; \text{threshold}$</p>
</div>


                            <div id="MaximumIterations.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#MaximumIterations.priority"></a>
    
    

                            </div>
                            <div id="MaximumIterations.evaluate" class="classattr">
                                        <input id="MaximumIterations.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MaximumIterations.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MaximumIterations.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MaximumIterations.evaluate-166"><a href="#MaximumIterations.evaluate-166"><span class="linenos">166</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="MaximumIterations.evaluate-167"><a href="#MaximumIterations.evaluate-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="MaximumIterations.evaluate-168"><a href="#MaximumIterations.evaluate-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="MaximumIterations.evaluate-169"><a href="#MaximumIterations.evaluate-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs 3 tasks:
(i) Evaluate the criterion's current value
(ii) Update its status accordingly
(iii) Fill in its history by calling method <code><a href="#MaximumIterations.update_history">update_history</a></code></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nonlinear_monitor</strong> (NonLinearMonitor):
Instance of class <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> used to evaluate the criterion.</li>
</ul>
</div>


                            </div>
                            <div id="MaximumIterations.update_history" class="classattr">
                                        <input id="MaximumIterations.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MaximumIterations.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MaximumIterations.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MaximumIterations.update_history-171"><a href="#MaximumIterations.update_history-171"><span class="linenos">171</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="MaximumIterations.update_history-172"><a href="#MaximumIterations.update_history-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#MaximumIterations.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="MaximumIterations.write_stop_message" class="classattr">
                                        <input id="MaximumIterations.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MaximumIterations.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MaximumIterations.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MaximumIterations.write_stop_message-174"><a href="#MaximumIterations.write_stop_message-174"><span class="linenos">174</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MaximumIterations.write_stop_message-175"><a href="#MaximumIterations.write_stop_message-175"><span class="linenos">175</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="MaximumIterations.write_stop_message-176"><a href="#MaximumIterations.write_stop_message-176"><span class="linenos">176</span></a>            <span class="sa">f</span><span class="s2">&quot;End of iterations: the maximum number of iterations &quot;</span>
</span><span id="MaximumIterations.write_stop_message-177"><a href="#MaximumIterations.write_stop_message-177"><span class="linenos">177</span></a>            <span class="sa">f</span><span class="s2">&quot;(= </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="si">}</span><span class="s2">) has been reached.&quot;</span>
</span><span id="MaximumIterations.write_stop_message-178"><a href="#MaximumIterations.write_stop_message-178"><span class="linenos">178</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Criterion">Criterion</a></dt>
                                <dd id="MaximumIterations.__init__" class="function"><a href="#Criterion.__init__">Criterion</a></dd>
                <dd id="MaximumIterations.threshold" class="variable"><a href="#Criterion.threshold">threshold</a></dd>
                <dd id="MaximumIterations.status" class="variable"><a href="#Criterion.status">status</a></dd>
                <dd id="MaximumIterations.value" class="variable"><a href="#Criterion.value">value</a></dd>
                <dd id="MaximumIterations.history" class="variable"><a href="#Criterion.history">history</a></dd>
                <dd id="MaximumIterations.name" class="variable"><a href="#Criterion.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="RelativeDeltaSolutionNorm2">
                            <input id="RelativeDeltaSolutionNorm2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RelativeDeltaSolutionNorm2</span><wbr>(<span class="base"><a href="#Criterion">Criterion</a></span>):

                <label class="view-source-button" for="RelativeDeltaSolutionNorm2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelativeDeltaSolutionNorm2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelativeDeltaSolutionNorm2-181"><a href="#RelativeDeltaSolutionNorm2-181"><span class="linenos">181</span></a><span class="k">class</span><span class="w"> </span><span class="nc">RelativeDeltaSolutionNorm2</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="RelativeDeltaSolutionNorm2-182"><a href="#RelativeDeltaSolutionNorm2-182"><span class="linenos">182</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RelativeDeltaSolutionNorm2-183"><a href="#RelativeDeltaSolutionNorm2-183"><span class="linenos">183</span></a><span class="sd">    Relative delta on the solution between two consecutive iterations (in</span>
</span><span id="RelativeDeltaSolutionNorm2-184"><a href="#RelativeDeltaSolutionNorm2-184"><span class="linenos">184</span></a><span class="sd">    2-norm), i.e.</span>
</span><span id="RelativeDeltaSolutionNorm2-185"><a href="#RelativeDeltaSolutionNorm2-185"><span class="linenos">185</span></a><span class="sd">    $$ \frac{\| u_k - u_{k-1} \|_2}{\| u_{k-1} \|_2} &lt; \text{threshold} $$</span>
</span><span id="RelativeDeltaSolutionNorm2-186"><a href="#RelativeDeltaSolutionNorm2-186"><span class="linenos">186</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RelativeDeltaSolutionNorm2-187"><a href="#RelativeDeltaSolutionNorm2-187"><span class="linenos">187</span></a>
</span><span id="RelativeDeltaSolutionNorm2-188"><a href="#RelativeDeltaSolutionNorm2-188"><span class="linenos">188</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="RelativeDeltaSolutionNorm2-189"><a href="#RelativeDeltaSolutionNorm2-189"><span class="linenos">189</span></a>
</span><span id="RelativeDeltaSolutionNorm2-190"><a href="#RelativeDeltaSolutionNorm2-190"><span class="linenos">190</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">not_zeroth_iteration</span>
</span><span id="RelativeDeltaSolutionNorm2-191"><a href="#RelativeDeltaSolutionNorm2-191"><span class="linenos">191</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="RelativeDeltaSolutionNorm2-192"><a href="#RelativeDeltaSolutionNorm2-192"><span class="linenos">192</span></a>        <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="RelativeDeltaSolutionNorm2-193"><a href="#RelativeDeltaSolutionNorm2-193"><span class="linenos">193</span></a>        <span class="n">old_int</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">old_int</span>
</span><span id="RelativeDeltaSolutionNorm2-194"><a href="#RelativeDeltaSolutionNorm2-194"><span class="linenos">194</span></a>        <span class="n">sol_int</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">sol_int</span>
</span><span id="RelativeDeltaSolutionNorm2-195"><a href="#RelativeDeltaSolutionNorm2-195"><span class="linenos">195</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_int</span> <span class="o">-</span> <span class="n">old_int</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">old_int</span><span class="p">)</span>
</span><span id="RelativeDeltaSolutionNorm2-196"><a href="#RelativeDeltaSolutionNorm2-196"><span class="linenos">196</span></a>        <span class="n">sol_ext</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">sol_ext</span>
</span><span id="RelativeDeltaSolutionNorm2-197"><a href="#RelativeDeltaSolutionNorm2-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="n">sol_ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RelativeDeltaSolutionNorm2-198"><a href="#RelativeDeltaSolutionNorm2-198"><span class="linenos">198</span></a>            <span class="n">old_ext</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">old_ext</span>
</span><span id="RelativeDeltaSolutionNorm2-199"><a href="#RelativeDeltaSolutionNorm2-199"><span class="linenos">199</span></a>            <span class="n">value</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_ext</span> <span class="o">-</span> <span class="n">old_ext</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">old_ext</span><span class="p">)</span>
</span><span id="RelativeDeltaSolutionNorm2-200"><a href="#RelativeDeltaSolutionNorm2-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="RelativeDeltaSolutionNorm2-201"><a href="#RelativeDeltaSolutionNorm2-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="RelativeDeltaSolutionNorm2-202"><a href="#RelativeDeltaSolutionNorm2-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="RelativeDeltaSolutionNorm2-203"><a href="#RelativeDeltaSolutionNorm2-203"><span class="linenos">203</span></a>
</span><span id="RelativeDeltaSolutionNorm2-204"><a href="#RelativeDeltaSolutionNorm2-204"><span class="linenos">204</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="RelativeDeltaSolutionNorm2-205"><a href="#RelativeDeltaSolutionNorm2-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="RelativeDeltaSolutionNorm2-206"><a href="#RelativeDeltaSolutionNorm2-206"><span class="linenos">206</span></a>
</span><span id="RelativeDeltaSolutionNorm2-207"><a href="#RelativeDeltaSolutionNorm2-207"><span class="linenos">207</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RelativeDeltaSolutionNorm2-208"><a href="#RelativeDeltaSolutionNorm2-208"><span class="linenos">208</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="RelativeDeltaSolutionNorm2-209"><a href="#RelativeDeltaSolutionNorm2-209"><span class="linenos">209</span></a>            <span class="s2">&quot;End of iterations: the relative variation of the solution vector &quot;</span>
</span><span id="RelativeDeltaSolutionNorm2-210"><a href="#RelativeDeltaSolutionNorm2-210"><span class="linenos">210</span></a>            <span class="s2">&quot;(in 2-norm) between two consecutive iterations is smaller than &quot;</span>
</span><span id="RelativeDeltaSolutionNorm2-211"><a href="#RelativeDeltaSolutionNorm2-211"><span class="linenos">211</span></a>            <span class="s2">&quot;the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="RelativeDeltaSolutionNorm2-212"><a href="#RelativeDeltaSolutionNorm2-212"><span class="linenos">212</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Relative delta on the solution between two consecutive iterations (in
2-norm), i.e.
$$ \frac{\| u_k - u_{k-1} \|_2}{\| u_{k-1} \|_2} &lt; \text{threshold} $$</p>
</div>


                            <div id="RelativeDeltaSolutionNorm2.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#RelativeDeltaSolutionNorm2.priority"></a>
    
    

                            </div>
                            <div id="RelativeDeltaSolutionNorm2.evaluate" class="classattr">
                                        <input id="RelativeDeltaSolutionNorm2.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RelativeDeltaSolutionNorm2.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelativeDeltaSolutionNorm2.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelativeDeltaSolutionNorm2.evaluate-80"><a href="#RelativeDeltaSolutionNorm2.evaluate-80"><span class="linenos">80</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="RelativeDeltaSolutionNorm2.evaluate-81"><a href="#RelativeDeltaSolutionNorm2.evaluate-81"><span class="linenos">81</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="RelativeDeltaSolutionNorm2.evaluate-82"><a href="#RelativeDeltaSolutionNorm2.evaluate-82"><span class="linenos">82</span></a>            <span class="k">if</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="RelativeDeltaSolutionNorm2.evaluate-83"><a href="#RelativeDeltaSolutionNorm2.evaluate-83"><span class="linenos">83</span></a>                <span class="k">return</span>
</span><span id="RelativeDeltaSolutionNorm2.evaluate-84"><a href="#RelativeDeltaSolutionNorm2.evaluate-84"><span class="linenos">84</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="RelativeDeltaSolutionNorm2.evaluate-85"><a href="#RelativeDeltaSolutionNorm2.evaluate-85"><span class="linenos">85</span></a>                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs 3 tasks:
(i) Evaluate the criterion's current value
(ii) Update its status accordingly
(iii) Fill in its history by calling method <code><a href="#RelativeDeltaSolutionNorm2.update_history">update_history</a></code></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nonlinear_monitor</strong> (NonLinearMonitor):
Instance of class <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> used to evaluate the criterion.</li>
</ul>
</div>


                            </div>
                            <div id="RelativeDeltaSolutionNorm2.update_history" class="classattr">
                                        <input id="RelativeDeltaSolutionNorm2.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RelativeDeltaSolutionNorm2.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelativeDeltaSolutionNorm2.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelativeDeltaSolutionNorm2.update_history-204"><a href="#RelativeDeltaSolutionNorm2.update_history-204"><span class="linenos">204</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="RelativeDeltaSolutionNorm2.update_history-205"><a href="#RelativeDeltaSolutionNorm2.update_history-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#RelativeDeltaSolutionNorm2.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="RelativeDeltaSolutionNorm2.write_stop_message" class="classattr">
                                        <input id="RelativeDeltaSolutionNorm2.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RelativeDeltaSolutionNorm2.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelativeDeltaSolutionNorm2.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelativeDeltaSolutionNorm2.write_stop_message-207"><a href="#RelativeDeltaSolutionNorm2.write_stop_message-207"><span class="linenos">207</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RelativeDeltaSolutionNorm2.write_stop_message-208"><a href="#RelativeDeltaSolutionNorm2.write_stop_message-208"><span class="linenos">208</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="RelativeDeltaSolutionNorm2.write_stop_message-209"><a href="#RelativeDeltaSolutionNorm2.write_stop_message-209"><span class="linenos">209</span></a>            <span class="s2">&quot;End of iterations: the relative variation of the solution vector &quot;</span>
</span><span id="RelativeDeltaSolutionNorm2.write_stop_message-210"><a href="#RelativeDeltaSolutionNorm2.write_stop_message-210"><span class="linenos">210</span></a>            <span class="s2">&quot;(in 2-norm) between two consecutive iterations is smaller than &quot;</span>
</span><span id="RelativeDeltaSolutionNorm2.write_stop_message-211"><a href="#RelativeDeltaSolutionNorm2.write_stop_message-211"><span class="linenos">211</span></a>            <span class="s2">&quot;the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="RelativeDeltaSolutionNorm2.write_stop_message-212"><a href="#RelativeDeltaSolutionNorm2.write_stop_message-212"><span class="linenos">212</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Criterion">Criterion</a></dt>
                                <dd id="RelativeDeltaSolutionNorm2.__init__" class="function"><a href="#Criterion.__init__">Criterion</a></dd>
                <dd id="RelativeDeltaSolutionNorm2.threshold" class="variable"><a href="#Criterion.threshold">threshold</a></dd>
                <dd id="RelativeDeltaSolutionNorm2.status" class="variable"><a href="#Criterion.status">status</a></dd>
                <dd id="RelativeDeltaSolutionNorm2.value" class="variable"><a href="#Criterion.value">value</a></dd>
                <dd id="RelativeDeltaSolutionNorm2.history" class="variable"><a href="#Criterion.history">history</a></dd>
                <dd id="RelativeDeltaSolutionNorm2.name" class="variable"><a href="#Criterion.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="AbsoluteDeltaSolutionNorm2">
                            <input id="AbsoluteDeltaSolutionNorm2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AbsoluteDeltaSolutionNorm2</span><wbr>(<span class="base"><a href="#Criterion">Criterion</a></span>):

                <label class="view-source-button" for="AbsoluteDeltaSolutionNorm2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsoluteDeltaSolutionNorm2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsoluteDeltaSolutionNorm2-215"><a href="#AbsoluteDeltaSolutionNorm2-215"><span class="linenos">215</span></a><span class="k">class</span><span class="w"> </span><span class="nc">AbsoluteDeltaSolutionNorm2</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="AbsoluteDeltaSolutionNorm2-216"><a href="#AbsoluteDeltaSolutionNorm2-216"><span class="linenos">216</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="AbsoluteDeltaSolutionNorm2-217"><a href="#AbsoluteDeltaSolutionNorm2-217"><span class="linenos">217</span></a><span class="sd">    Absolute delta on the solution between two consecutive iterations (in</span>
</span><span id="AbsoluteDeltaSolutionNorm2-218"><a href="#AbsoluteDeltaSolutionNorm2-218"><span class="linenos">218</span></a><span class="sd">    2-norm), i.e.</span>
</span><span id="AbsoluteDeltaSolutionNorm2-219"><a href="#AbsoluteDeltaSolutionNorm2-219"><span class="linenos">219</span></a><span class="sd">    $$ \| u_k - u_{k-1} \|_2 &lt; \text{threshold} $$</span>
</span><span id="AbsoluteDeltaSolutionNorm2-220"><a href="#AbsoluteDeltaSolutionNorm2-220"><span class="linenos">220</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AbsoluteDeltaSolutionNorm2-221"><a href="#AbsoluteDeltaSolutionNorm2-221"><span class="linenos">221</span></a>
</span><span id="AbsoluteDeltaSolutionNorm2-222"><a href="#AbsoluteDeltaSolutionNorm2-222"><span class="linenos">222</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="AbsoluteDeltaSolutionNorm2-223"><a href="#AbsoluteDeltaSolutionNorm2-223"><span class="linenos">223</span></a>
</span><span id="AbsoluteDeltaSolutionNorm2-224"><a href="#AbsoluteDeltaSolutionNorm2-224"><span class="linenos">224</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">not_zeroth_iteration</span>
</span><span id="AbsoluteDeltaSolutionNorm2-225"><a href="#AbsoluteDeltaSolutionNorm2-225"><span class="linenos">225</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="AbsoluteDeltaSolutionNorm2-226"><a href="#AbsoluteDeltaSolutionNorm2-226"><span class="linenos">226</span></a>        <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="AbsoluteDeltaSolutionNorm2-227"><a href="#AbsoluteDeltaSolutionNorm2-227"><span class="linenos">227</span></a>        <span class="n">old_int</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">old_int</span>
</span><span id="AbsoluteDeltaSolutionNorm2-228"><a href="#AbsoluteDeltaSolutionNorm2-228"><span class="linenos">228</span></a>        <span class="n">sol_int</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">sol_int</span>
</span><span id="AbsoluteDeltaSolutionNorm2-229"><a href="#AbsoluteDeltaSolutionNorm2-229"><span class="linenos">229</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_int</span> <span class="o">-</span> <span class="n">old_int</span><span class="p">)</span>
</span><span id="AbsoluteDeltaSolutionNorm2-230"><a href="#AbsoluteDeltaSolutionNorm2-230"><span class="linenos">230</span></a>        <span class="n">sol_ext</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">sol_ext</span>
</span><span id="AbsoluteDeltaSolutionNorm2-231"><a href="#AbsoluteDeltaSolutionNorm2-231"><span class="linenos">231</span></a>        <span class="k">if</span> <span class="n">sol_ext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AbsoluteDeltaSolutionNorm2-232"><a href="#AbsoluteDeltaSolutionNorm2-232"><span class="linenos">232</span></a>            <span class="n">old_ext</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">old_ext</span>
</span><span id="AbsoluteDeltaSolutionNorm2-233"><a href="#AbsoluteDeltaSolutionNorm2-233"><span class="linenos">233</span></a>            <span class="n">value</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_ext</span> <span class="o">-</span> <span class="n">old_ext</span><span class="p">)</span>
</span><span id="AbsoluteDeltaSolutionNorm2-234"><a href="#AbsoluteDeltaSolutionNorm2-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="AbsoluteDeltaSolutionNorm2-235"><a href="#AbsoluteDeltaSolutionNorm2-235"><span class="linenos">235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="AbsoluteDeltaSolutionNorm2-236"><a href="#AbsoluteDeltaSolutionNorm2-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="AbsoluteDeltaSolutionNorm2-237"><a href="#AbsoluteDeltaSolutionNorm2-237"><span class="linenos">237</span></a>
</span><span id="AbsoluteDeltaSolutionNorm2-238"><a href="#AbsoluteDeltaSolutionNorm2-238"><span class="linenos">238</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="AbsoluteDeltaSolutionNorm2-239"><a href="#AbsoluteDeltaSolutionNorm2-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="AbsoluteDeltaSolutionNorm2-240"><a href="#AbsoluteDeltaSolutionNorm2-240"><span class="linenos">240</span></a>
</span><span id="AbsoluteDeltaSolutionNorm2-241"><a href="#AbsoluteDeltaSolutionNorm2-241"><span class="linenos">241</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AbsoluteDeltaSolutionNorm2-242"><a href="#AbsoluteDeltaSolutionNorm2-242"><span class="linenos">242</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="AbsoluteDeltaSolutionNorm2-243"><a href="#AbsoluteDeltaSolutionNorm2-243"><span class="linenos">243</span></a>            <span class="s2">&quot;End of iterations: the variation of the solution vector (in &quot;</span>
</span><span id="AbsoluteDeltaSolutionNorm2-244"><a href="#AbsoluteDeltaSolutionNorm2-244"><span class="linenos">244</span></a>            <span class="s2">&quot;2-norm) between two consecutive iterations is smaller than the &quot;</span>
</span><span id="AbsoluteDeltaSolutionNorm2-245"><a href="#AbsoluteDeltaSolutionNorm2-245"><span class="linenos">245</span></a>            <span class="s2">&quot;specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="AbsoluteDeltaSolutionNorm2-246"><a href="#AbsoluteDeltaSolutionNorm2-246"><span class="linenos">246</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Absolute delta on the solution between two consecutive iterations (in
2-norm), i.e.
$$ \| u_k - u_{k-1} \|_2 &lt; \text{threshold} $$</p>
</div>


                            <div id="AbsoluteDeltaSolutionNorm2.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#AbsoluteDeltaSolutionNorm2.priority"></a>
    
    

                            </div>
                            <div id="AbsoluteDeltaSolutionNorm2.evaluate" class="classattr">
                                        <input id="AbsoluteDeltaSolutionNorm2.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsoluteDeltaSolutionNorm2.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsoluteDeltaSolutionNorm2.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsoluteDeltaSolutionNorm2.evaluate-80"><a href="#AbsoluteDeltaSolutionNorm2.evaluate-80"><span class="linenos">80</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="AbsoluteDeltaSolutionNorm2.evaluate-81"><a href="#AbsoluteDeltaSolutionNorm2.evaluate-81"><span class="linenos">81</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="AbsoluteDeltaSolutionNorm2.evaluate-82"><a href="#AbsoluteDeltaSolutionNorm2.evaluate-82"><span class="linenos">82</span></a>            <span class="k">if</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AbsoluteDeltaSolutionNorm2.evaluate-83"><a href="#AbsoluteDeltaSolutionNorm2.evaluate-83"><span class="linenos">83</span></a>                <span class="k">return</span>
</span><span id="AbsoluteDeltaSolutionNorm2.evaluate-84"><a href="#AbsoluteDeltaSolutionNorm2.evaluate-84"><span class="linenos">84</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AbsoluteDeltaSolutionNorm2.evaluate-85"><a href="#AbsoluteDeltaSolutionNorm2.evaluate-85"><span class="linenos">85</span></a>                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs 3 tasks:
(i) Evaluate the criterion's current value
(ii) Update its status accordingly
(iii) Fill in its history by calling method <code><a href="#AbsoluteDeltaSolutionNorm2.update_history">update_history</a></code></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nonlinear_monitor</strong> (NonLinearMonitor):
Instance of class <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> used to evaluate the criterion.</li>
</ul>
</div>


                            </div>
                            <div id="AbsoluteDeltaSolutionNorm2.update_history" class="classattr">
                                        <input id="AbsoluteDeltaSolutionNorm2.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsoluteDeltaSolutionNorm2.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsoluteDeltaSolutionNorm2.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsoluteDeltaSolutionNorm2.update_history-238"><a href="#AbsoluteDeltaSolutionNorm2.update_history-238"><span class="linenos">238</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="AbsoluteDeltaSolutionNorm2.update_history-239"><a href="#AbsoluteDeltaSolutionNorm2.update_history-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#AbsoluteDeltaSolutionNorm2.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="AbsoluteDeltaSolutionNorm2.write_stop_message" class="classattr">
                                        <input id="AbsoluteDeltaSolutionNorm2.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AbsoluteDeltaSolutionNorm2.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AbsoluteDeltaSolutionNorm2.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AbsoluteDeltaSolutionNorm2.write_stop_message-241"><a href="#AbsoluteDeltaSolutionNorm2.write_stop_message-241"><span class="linenos">241</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="AbsoluteDeltaSolutionNorm2.write_stop_message-242"><a href="#AbsoluteDeltaSolutionNorm2.write_stop_message-242"><span class="linenos">242</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="AbsoluteDeltaSolutionNorm2.write_stop_message-243"><a href="#AbsoluteDeltaSolutionNorm2.write_stop_message-243"><span class="linenos">243</span></a>            <span class="s2">&quot;End of iterations: the variation of the solution vector (in &quot;</span>
</span><span id="AbsoluteDeltaSolutionNorm2.write_stop_message-244"><a href="#AbsoluteDeltaSolutionNorm2.write_stop_message-244"><span class="linenos">244</span></a>            <span class="s2">&quot;2-norm) between two consecutive iterations is smaller than the &quot;</span>
</span><span id="AbsoluteDeltaSolutionNorm2.write_stop_message-245"><a href="#AbsoluteDeltaSolutionNorm2.write_stop_message-245"><span class="linenos">245</span></a>            <span class="s2">&quot;specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="AbsoluteDeltaSolutionNorm2.write_stop_message-246"><a href="#AbsoluteDeltaSolutionNorm2.write_stop_message-246"><span class="linenos">246</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Criterion">Criterion</a></dt>
                                <dd id="AbsoluteDeltaSolutionNorm2.__init__" class="function"><a href="#Criterion.__init__">Criterion</a></dd>
                <dd id="AbsoluteDeltaSolutionNorm2.threshold" class="variable"><a href="#Criterion.threshold">threshold</a></dd>
                <dd id="AbsoluteDeltaSolutionNorm2.status" class="variable"><a href="#Criterion.status">status</a></dd>
                <dd id="AbsoluteDeltaSolutionNorm2.value" class="variable"><a href="#Criterion.value">value</a></dd>
                <dd id="AbsoluteDeltaSolutionNorm2.history" class="variable"><a href="#Criterion.history">history</a></dd>
                <dd id="AbsoluteDeltaSolutionNorm2.name" class="variable"><a href="#Criterion.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ResidualVector">
                            <input id="ResidualVector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ResidualVector</span><wbr>(<span class="base"><a href="#Criterion">Criterion</a></span>):

                <label class="view-source-button" for="ResidualVector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVector-249"><a href="#ResidualVector-249"><span class="linenos">249</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualVector</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="ResidualVector-250"><a href="#ResidualVector-250"><span class="linenos">250</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Residual vector (look only, not active).&quot;&quot;&quot;</span>
</span><span id="ResidualVector-251"><a href="#ResidualVector-251"><span class="linenos">251</span></a>
</span><span id="ResidualVector-252"><a href="#ResidualVector-252"><span class="linenos">252</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="ResidualVector-253"><a href="#ResidualVector-253"><span class="linenos">253</span></a>
</span><span id="ResidualVector-254"><a href="#ResidualVector-254"><span class="linenos">254</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_wf_residual</span>
</span><span id="ResidualVector-255"><a href="#ResidualVector-255"><span class="linenos">255</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVector-256"><a href="#ResidualVector-256"><span class="linenos">256</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See NonLinearSolver.evaluate_residual_vector for the implementation</span>
</span><span id="ResidualVector-257"><a href="#ResidualVector-257"><span class="linenos">257</span></a><span class="sd">        of the residual computation.&quot;&quot;&quot;</span>
</span><span id="ResidualVector-258"><a href="#ResidualVector-258"><span class="linenos">258</span></a>        <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="ResidualVector-259"><a href="#ResidualVector-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">evaluate_residual_vector</span><span class="p">()</span>
</span><span id="ResidualVector-260"><a href="#ResidualVector-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="ResidualVector-261"><a href="#ResidualVector-261"><span class="linenos">261</span></a>
</span><span id="ResidualVector-262"><a href="#ResidualVector-262"><span class="linenos">262</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVector-263"><a href="#ResidualVector-263"><span class="linenos">263</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="ResidualVector-264"><a href="#ResidualVector-264"><span class="linenos">264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="ResidualVector-265"><a href="#ResidualVector-265"><span class="linenos">265</span></a>
</span><span id="ResidualVector-266"><a href="#ResidualVector-266"><span class="linenos">266</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ResidualVector-267"><a href="#ResidualVector-267"><span class="linenos">267</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Residual vector (look only, not active).</p>
</div>


                            <div id="ResidualVector.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#ResidualVector.priority"></a>
    
    

                            </div>
                            <div id="ResidualVector.evaluate" class="classattr">
                                        <input id="ResidualVector.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVector.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVector.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVector.evaluate-60"><a href="#ResidualVector.evaluate-60"><span class="linenos">60</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="ResidualVector.evaluate-61"><a href="#ResidualVector.evaluate-61"><span class="linenos">61</span></a>            <span class="n">crit_instance</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ResidualVector.evaluate-62"><a href="#ResidualVector.evaluate-62"><span class="linenos">62</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ResidualVector.evaluate-63"><a href="#ResidualVector.evaluate-63"><span class="linenos">63</span></a>            <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="ResidualVector.evaluate-64"><a href="#ResidualVector.evaluate-64"><span class="linenos">64</span></a>            <span class="k">if</span> <span class="n">nl_solver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ResidualVector.evaluate-65"><a href="#ResidualVector.evaluate-65"><span class="linenos">65</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;NonLinearMonitor&#39; instance is not yet&quot;</span>
</span><span id="ResidualVector.evaluate-66"><a href="#ResidualVector.evaluate-66"><span class="linenos">66</span></a>                                 <span class="s2">&quot;linked to a &#39;NonLinearSolver&#39; instance!&quot;</span><span class="p">)</span>
</span><span id="ResidualVector.evaluate-67"><a href="#ResidualVector.evaluate-67"><span class="linenos">67</span></a>            <span class="k">if</span> <span class="s1">&#39;wf_residual&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">:</span>
</span><span id="ResidualVector.evaluate-68"><a href="#ResidualVector.evaluate-68"><span class="linenos">68</span></a>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Criterion </span><span class="si">{</span><span class="n">crit_instance</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="ResidualVector.evaluate-69"><a href="#ResidualVector.evaluate-69"><span class="linenos">69</span></a>                               <span class="sa">f</span><span class="s2">&quot;requires &#39;wf_residual&#39;&quot;</span><span class="p">)</span>
</span><span id="ResidualVector.evaluate-70"><a href="#ResidualVector.evaluate-70"><span class="linenos">70</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">[</span><span class="s1">&#39;wf_residual&#39;</span><span class="p">],</span> <span class="n">WeakForm</span><span class="p">):</span>
</span><span id="ResidualVector.evaluate-71"><a href="#ResidualVector.evaluate-71"><span class="linenos">71</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;wf_residual&#39; is not set properly!&quot;</span><span class="p">)</span>
</span><span id="ResidualVector.evaluate-72"><a href="#ResidualVector.evaluate-72"><span class="linenos">72</span></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See NonLinearSolver.evaluate_residual_vector for the implementation
of the residual computation.</p>
</div>


                            </div>
                            <div id="ResidualVector.update_history" class="classattr">
                                        <input id="ResidualVector.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVector.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVector.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVector.update_history-262"><a href="#ResidualVector.update_history-262"><span class="linenos">262</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVector.update_history-263"><a href="#ResidualVector.update_history-263"><span class="linenos">263</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="ResidualVector.update_history-264"><a href="#ResidualVector.update_history-264"><span class="linenos">264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#ResidualVector.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="ResidualVector.write_stop_message" class="classattr">
                                        <input id="ResidualVector.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVector.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVector.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVector.write_stop_message-266"><a href="#ResidualVector.write_stop_message-266"><span class="linenos">266</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ResidualVector.write_stop_message-267"><a href="#ResidualVector.write_stop_message-267"><span class="linenos">267</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Criterion">Criterion</a></dt>
                                <dd id="ResidualVector.__init__" class="function"><a href="#Criterion.__init__">Criterion</a></dd>
                <dd id="ResidualVector.threshold" class="variable"><a href="#Criterion.threshold">threshold</a></dd>
                <dd id="ResidualVector.status" class="variable"><a href="#Criterion.status">status</a></dd>
                <dd id="ResidualVector.value" class="variable"><a href="#Criterion.value">value</a></dd>
                <dd id="ResidualVector.history" class="variable"><a href="#Criterion.history">history</a></dd>
                <dd id="ResidualVector.name" class="variable"><a href="#Criterion.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ResidualVectorParts">
                            <input id="ResidualVectorParts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ResidualVectorParts</span><wbr>(<span class="base"><a href="#Criterion">Criterion</a></span>):

                <label class="view-source-button" for="ResidualVectorParts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVectorParts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVectorParts-270"><a href="#ResidualVectorParts-270"><span class="linenos">270</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualVectorParts</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="ResidualVectorParts-271"><a href="#ResidualVectorParts-271"><span class="linenos">271</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ResidualVectorParts-272"><a href="#ResidualVectorParts-272"><span class="linenos">272</span></a><span class="sd">    Residual vector parts (look only, not active). Decomposition of the</span>
</span><span id="ResidualVectorParts-273"><a href="#ResidualVectorParts-273"><span class="linenos">273</span></a><span class="sd">    residual vector $R$ into</span>
</span><span id="ResidualVectorParts-274"><a href="#ResidualVectorParts-274"><span class="linenos">274</span></a><span class="sd">    $$ R = A u_k - rhs_{\text{cst}} - rhs_{\text{mod}} $$</span>
</span><span id="ResidualVectorParts-275"><a href="#ResidualVectorParts-275"><span class="linenos">275</span></a><span class="sd">    The `value` attribute is a dictionary with keys</span>
</span><span id="ResidualVectorParts-276"><a href="#ResidualVectorParts-276"><span class="linenos">276</span></a><span class="sd">    (&#39;mtx_term&#39;, &#39;rhs_cst_term&#39;, &#39;rhs_mod_term&#39;).</span>
</span><span id="ResidualVectorParts-277"><a href="#ResidualVectorParts-277"><span class="linenos">277</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ResidualVectorParts-278"><a href="#ResidualVectorParts-278"><span class="linenos">278</span></a>
</span><span id="ResidualVectorParts-279"><a href="#ResidualVectorParts-279"><span class="linenos">279</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ResidualVectorParts-280"><a href="#ResidualVectorParts-280"><span class="linenos">280</span></a>
</span><span id="ResidualVectorParts-281"><a href="#ResidualVectorParts-281"><span class="linenos">281</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_wf_residual</span>
</span><span id="ResidualVectorParts-282"><a href="#ResidualVectorParts-282"><span class="linenos">282</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVectorParts-283"><a href="#ResidualVectorParts-283"><span class="linenos">283</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;See NonLinearSolver.evaluate_residual_vector_parts for the</span>
</span><span id="ResidualVectorParts-284"><a href="#ResidualVectorParts-284"><span class="linenos">284</span></a><span class="sd">        implementation.&quot;&quot;&quot;</span>
</span><span id="ResidualVectorParts-285"><a href="#ResidualVectorParts-285"><span class="linenos">285</span></a>        <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="ResidualVectorParts-286"><a href="#ResidualVectorParts-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">evaluate_residual_vector_parts</span><span class="p">()</span>
</span><span id="ResidualVectorParts-287"><a href="#ResidualVectorParts-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="ResidualVectorParts-288"><a href="#ResidualVectorParts-288"><span class="linenos">288</span></a>
</span><span id="ResidualVectorParts-289"><a href="#ResidualVectorParts-289"><span class="linenos">289</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVectorParts-290"><a href="#ResidualVectorParts-290"><span class="linenos">290</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="ResidualVectorParts-291"><a href="#ResidualVectorParts-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="ResidualVectorParts-292"><a href="#ResidualVectorParts-292"><span class="linenos">292</span></a>
</span><span id="ResidualVectorParts-293"><a href="#ResidualVectorParts-293"><span class="linenos">293</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ResidualVectorParts-294"><a href="#ResidualVectorParts-294"><span class="linenos">294</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Residual vector parts (look only, not active). Decomposition of the
residual vector $R$ into
$$ R = A u_k - rhs_{        ext{cst}} - rhs_{       ext{mod}} $$
The <code><a href="#ResidualVectorParts.value">value</a></code> attribute is a dictionary with keys
('mtx_term', 'rhs_cst_term', 'rhs_mod_term').</p>
</div>


                            <div id="ResidualVectorParts.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#ResidualVectorParts.priority"></a>
    
    

                            </div>
                            <div id="ResidualVectorParts.evaluate" class="classattr">
                                        <input id="ResidualVectorParts.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVectorParts.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVectorParts.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVectorParts.evaluate-60"><a href="#ResidualVectorParts.evaluate-60"><span class="linenos">60</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="ResidualVectorParts.evaluate-61"><a href="#ResidualVectorParts.evaluate-61"><span class="linenos">61</span></a>            <span class="n">crit_instance</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ResidualVectorParts.evaluate-62"><a href="#ResidualVectorParts.evaluate-62"><span class="linenos">62</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ResidualVectorParts.evaluate-63"><a href="#ResidualVectorParts.evaluate-63"><span class="linenos">63</span></a>            <span class="n">nl_solver</span> <span class="o">=</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">nonlinear_solver</span>
</span><span id="ResidualVectorParts.evaluate-64"><a href="#ResidualVectorParts.evaluate-64"><span class="linenos">64</span></a>            <span class="k">if</span> <span class="n">nl_solver</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ResidualVectorParts.evaluate-65"><a href="#ResidualVectorParts.evaluate-65"><span class="linenos">65</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;NonLinearMonitor&#39; instance is not yet&quot;</span>
</span><span id="ResidualVectorParts.evaluate-66"><a href="#ResidualVectorParts.evaluate-66"><span class="linenos">66</span></a>                                 <span class="s2">&quot;linked to a &#39;NonLinearSolver&#39; instance!&quot;</span><span class="p">)</span>
</span><span id="ResidualVectorParts.evaluate-67"><a href="#ResidualVectorParts.evaluate-67"><span class="linenos">67</span></a>            <span class="k">if</span> <span class="s1">&#39;wf_residual&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">:</span>
</span><span id="ResidualVectorParts.evaluate-68"><a href="#ResidualVectorParts.evaluate-68"><span class="linenos">68</span></a>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Criterion </span><span class="si">{</span><span class="n">crit_instance</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="ResidualVectorParts.evaluate-69"><a href="#ResidualVectorParts.evaluate-69"><span class="linenos">69</span></a>                               <span class="sa">f</span><span class="s2">&quot;requires &#39;wf_residual&#39;&quot;</span><span class="p">)</span>
</span><span id="ResidualVectorParts.evaluate-70"><a href="#ResidualVectorParts.evaluate-70"><span class="linenos">70</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nl_solver</span><span class="o">.</span><span class="n">wf_dict</span><span class="p">[</span><span class="s1">&#39;wf_residual&#39;</span><span class="p">],</span> <span class="n">WeakForm</span><span class="p">):</span>
</span><span id="ResidualVectorParts.evaluate-71"><a href="#ResidualVectorParts.evaluate-71"><span class="linenos">71</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;wf_residual&#39; is not set properly!&quot;</span><span class="p">)</span>
</span><span id="ResidualVectorParts.evaluate-72"><a href="#ResidualVectorParts.evaluate-72"><span class="linenos">72</span></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>See NonLinearSolver.evaluate_residual_vector_parts for the
implementation.</p>
</div>


                            </div>
                            <div id="ResidualVectorParts.update_history" class="classattr">
                                        <input id="ResidualVectorParts.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVectorParts.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVectorParts.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVectorParts.update_history-289"><a href="#ResidualVectorParts.update_history-289"><span class="linenos">289</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVectorParts.update_history-290"><a href="#ResidualVectorParts.update_history-290"><span class="linenos">290</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="ResidualVectorParts.update_history-291"><a href="#ResidualVectorParts.update_history-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#ResidualVectorParts.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="ResidualVectorParts.write_stop_message" class="classattr">
                                        <input id="ResidualVectorParts.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVectorParts.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVectorParts.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVectorParts.write_stop_message-293"><a href="#ResidualVectorParts.write_stop_message-293"><span class="linenos">293</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ResidualVectorParts.write_stop_message-294"><a href="#ResidualVectorParts.write_stop_message-294"><span class="linenos">294</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Criterion">Criterion</a></dt>
                                <dd id="ResidualVectorParts.__init__" class="function"><a href="#Criterion.__init__">Criterion</a></dd>
                <dd id="ResidualVectorParts.threshold" class="variable"><a href="#Criterion.threshold">threshold</a></dd>
                <dd id="ResidualVectorParts.status" class="variable"><a href="#Criterion.status">status</a></dd>
                <dd id="ResidualVectorParts.value" class="variable"><a href="#Criterion.value">value</a></dd>
                <dd id="ResidualVectorParts.history" class="variable"><a href="#Criterion.history">history</a></dd>
                <dd id="ResidualVectorParts.name" class="variable"><a href="#Criterion.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ResidualVectorNorm2">
                            <input id="ResidualVectorNorm2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ResidualVectorNorm2</span><wbr>(<span class="base"><a href="#Criterion">Criterion</a></span>):

                <label class="view-source-button" for="ResidualVectorNorm2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVectorNorm2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVectorNorm2-297"><a href="#ResidualVectorNorm2-297"><span class="linenos">297</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualVectorNorm2</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="ResidualVectorNorm2-298"><a href="#ResidualVectorNorm2-298"><span class="linenos">298</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;2-norm of the residual vector.&quot;&quot;&quot;</span>
</span><span id="ResidualVectorNorm2-299"><a href="#ResidualVectorNorm2-299"><span class="linenos">299</span></a>
</span><span id="ResidualVectorNorm2-300"><a href="#ResidualVectorNorm2-300"><span class="linenos">300</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ResidualVectorNorm2-301"><a href="#ResidualVectorNorm2-301"><span class="linenos">301</span></a>
</span><span id="ResidualVectorNorm2-302"><a href="#ResidualVectorNorm2-302"><span class="linenos">302</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVectorNorm2-303"><a href="#ResidualVectorNorm2-303"><span class="linenos">303</span></a>        <span class="n">residual_vector</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">residual_vetor</span>
</span><span id="ResidualVectorNorm2-304"><a href="#ResidualVectorNorm2-304"><span class="linenos">304</span></a>        <span class="n">norm2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">residual_vector</span><span class="p">)</span>
</span><span id="ResidualVectorNorm2-305"><a href="#ResidualVectorNorm2-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">norm2</span>
</span><span id="ResidualVectorNorm2-306"><a href="#ResidualVectorNorm2-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="ResidualVectorNorm2-307"><a href="#ResidualVectorNorm2-307"><span class="linenos">307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="ResidualVectorNorm2-308"><a href="#ResidualVectorNorm2-308"><span class="linenos">308</span></a>
</span><span id="ResidualVectorNorm2-309"><a href="#ResidualVectorNorm2-309"><span class="linenos">309</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVectorNorm2-310"><a href="#ResidualVectorNorm2-310"><span class="linenos">310</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="ResidualVectorNorm2-311"><a href="#ResidualVectorNorm2-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="ResidualVectorNorm2-312"><a href="#ResidualVectorNorm2-312"><span class="linenos">312</span></a>
</span><span id="ResidualVectorNorm2-313"><a href="#ResidualVectorNorm2-313"><span class="linenos">313</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ResidualVectorNorm2-314"><a href="#ResidualVectorNorm2-314"><span class="linenos">314</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="ResidualVectorNorm2-315"><a href="#ResidualVectorNorm2-315"><span class="linenos">315</span></a>            <span class="s2">&quot;End of iterations: the 2-norm of the residual vector is smaller &quot;</span>
</span><span id="ResidualVectorNorm2-316"><a href="#ResidualVectorNorm2-316"><span class="linenos">316</span></a>            <span class="s2">&quot;than the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="ResidualVectorNorm2-317"><a href="#ResidualVectorNorm2-317"><span class="linenos">317</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>2-norm of the residual vector.</p>
</div>


                            <div id="ResidualVectorNorm2.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#ResidualVectorNorm2.priority"></a>
    
    

                            </div>
                            <div id="ResidualVectorNorm2.evaluate" class="classattr">
                                        <input id="ResidualVectorNorm2.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVectorNorm2.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVectorNorm2.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVectorNorm2.evaluate-302"><a href="#ResidualVectorNorm2.evaluate-302"><span class="linenos">302</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVectorNorm2.evaluate-303"><a href="#ResidualVectorNorm2.evaluate-303"><span class="linenos">303</span></a>        <span class="n">residual_vector</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">residual_vetor</span>
</span><span id="ResidualVectorNorm2.evaluate-304"><a href="#ResidualVectorNorm2.evaluate-304"><span class="linenos">304</span></a>        <span class="n">norm2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">residual_vector</span><span class="p">)</span>
</span><span id="ResidualVectorNorm2.evaluate-305"><a href="#ResidualVectorNorm2.evaluate-305"><span class="linenos">305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">norm2</span>
</span><span id="ResidualVectorNorm2.evaluate-306"><a href="#ResidualVectorNorm2.evaluate-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="ResidualVectorNorm2.evaluate-307"><a href="#ResidualVectorNorm2.evaluate-307"><span class="linenos">307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs 3 tasks:
(i) Evaluate the criterion's current value
(ii) Update its status accordingly
(iii) Fill in its history by calling method <code><a href="#ResidualVectorNorm2.update_history">update_history</a></code></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nonlinear_monitor</strong> (NonLinearMonitor):
Instance of class <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> used to evaluate the criterion.</li>
</ul>
</div>


                            </div>
                            <div id="ResidualVectorNorm2.update_history" class="classattr">
                                        <input id="ResidualVectorNorm2.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVectorNorm2.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVectorNorm2.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVectorNorm2.update_history-309"><a href="#ResidualVectorNorm2.update_history-309"><span class="linenos">309</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualVectorNorm2.update_history-310"><a href="#ResidualVectorNorm2.update_history-310"><span class="linenos">310</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="ResidualVectorNorm2.update_history-311"><a href="#ResidualVectorNorm2.update_history-311"><span class="linenos">311</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#ResidualVectorNorm2.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="ResidualVectorNorm2.write_stop_message" class="classattr">
                                        <input id="ResidualVectorNorm2.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualVectorNorm2.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualVectorNorm2.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualVectorNorm2.write_stop_message-313"><a href="#ResidualVectorNorm2.write_stop_message-313"><span class="linenos">313</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ResidualVectorNorm2.write_stop_message-314"><a href="#ResidualVectorNorm2.write_stop_message-314"><span class="linenos">314</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="ResidualVectorNorm2.write_stop_message-315"><a href="#ResidualVectorNorm2.write_stop_message-315"><span class="linenos">315</span></a>            <span class="s2">&quot;End of iterations: the 2-norm of the residual vector is smaller &quot;</span>
</span><span id="ResidualVectorNorm2.write_stop_message-316"><a href="#ResidualVectorNorm2.write_stop_message-316"><span class="linenos">316</span></a>            <span class="s2">&quot;than the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="ResidualVectorNorm2.write_stop_message-317"><a href="#ResidualVectorNorm2.write_stop_message-317"><span class="linenos">317</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Criterion">Criterion</a></dt>
                                <dd id="ResidualVectorNorm2.__init__" class="function"><a href="#Criterion.__init__">Criterion</a></dd>
                <dd id="ResidualVectorNorm2.threshold" class="variable"><a href="#Criterion.threshold">threshold</a></dd>
                <dd id="ResidualVectorNorm2.status" class="variable"><a href="#Criterion.status">status</a></dd>
                <dd id="ResidualVectorNorm2.value" class="variable"><a href="#Criterion.value">value</a></dd>
                <dd id="ResidualVectorNorm2.history" class="variable"><a href="#Criterion.history">history</a></dd>
                <dd id="ResidualVectorNorm2.name" class="variable"><a href="#Criterion.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="RelativeDeltaResidualNorm2">
                            <input id="RelativeDeltaResidualNorm2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RelativeDeltaResidualNorm2</span><wbr>(<span class="base"><a href="#Criterion">Criterion</a></span>):

                <label class="view-source-button" for="RelativeDeltaResidualNorm2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelativeDeltaResidualNorm2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelativeDeltaResidualNorm2-320"><a href="#RelativeDeltaResidualNorm2-320"><span class="linenos">320</span></a><span class="k">class</span><span class="w"> </span><span class="nc">RelativeDeltaResidualNorm2</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="RelativeDeltaResidualNorm2-321"><a href="#RelativeDeltaResidualNorm2-321"><span class="linenos">321</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RelativeDeltaResidualNorm2-322"><a href="#RelativeDeltaResidualNorm2-322"><span class="linenos">322</span></a><span class="sd">    Relative variation of the residual vector in 2-norm, i.e.</span>
</span><span id="RelativeDeltaResidualNorm2-323"><a href="#RelativeDeltaResidualNorm2-323"><span class="linenos">323</span></a><span class="sd">    $$ \frac{\| R_k - R_{k-1} \|_2}{\| R_{k-1} \|_2} &lt; \text{threshold} $$</span>
</span><span id="RelativeDeltaResidualNorm2-324"><a href="#RelativeDeltaResidualNorm2-324"><span class="linenos">324</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RelativeDeltaResidualNorm2-325"><a href="#RelativeDeltaResidualNorm2-325"><span class="linenos">325</span></a>
</span><span id="RelativeDeltaResidualNorm2-326"><a href="#RelativeDeltaResidualNorm2-326"><span class="linenos">326</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="RelativeDeltaResidualNorm2-327"><a href="#RelativeDeltaResidualNorm2-327"><span class="linenos">327</span></a>
</span><span id="RelativeDeltaResidualNorm2-328"><a href="#RelativeDeltaResidualNorm2-328"><span class="linenos">328</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">not_zeroth_iteration</span>
</span><span id="RelativeDeltaResidualNorm2-329"><a href="#RelativeDeltaResidualNorm2-329"><span class="linenos">329</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="RelativeDeltaResidualNorm2-330"><a href="#RelativeDeltaResidualNorm2-330"><span class="linenos">330</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="RelativeDeltaResidualNorm2-331"><a href="#RelativeDeltaResidualNorm2-331"><span class="linenos">331</span></a>        <span class="n">res_vec</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">residual_vetor</span>
</span><span id="RelativeDeltaResidualNorm2-332"><a href="#RelativeDeltaResidualNorm2-332"><span class="linenos">332</span></a>        <span class="n">res_vec_old</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">_get_residual_vector_at_iteration</span><span class="p">(</span>
</span><span id="RelativeDeltaResidualNorm2-333"><a href="#RelativeDeltaResidualNorm2-333"><span class="linenos">333</span></a>            <span class="n">it</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="RelativeDeltaResidualNorm2-334"><a href="#RelativeDeltaResidualNorm2-334"><span class="linenos">334</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec</span> <span class="o">-</span> <span class="n">res_vec_old</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec</span><span class="p">)</span>
</span><span id="RelativeDeltaResidualNorm2-335"><a href="#RelativeDeltaResidualNorm2-335"><span class="linenos">335</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="RelativeDeltaResidualNorm2-336"><a href="#RelativeDeltaResidualNorm2-336"><span class="linenos">336</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="RelativeDeltaResidualNorm2-337"><a href="#RelativeDeltaResidualNorm2-337"><span class="linenos">337</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="RelativeDeltaResidualNorm2-338"><a href="#RelativeDeltaResidualNorm2-338"><span class="linenos">338</span></a>
</span><span id="RelativeDeltaResidualNorm2-339"><a href="#RelativeDeltaResidualNorm2-339"><span class="linenos">339</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="RelativeDeltaResidualNorm2-340"><a href="#RelativeDeltaResidualNorm2-340"><span class="linenos">340</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="RelativeDeltaResidualNorm2-341"><a href="#RelativeDeltaResidualNorm2-341"><span class="linenos">341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="RelativeDeltaResidualNorm2-342"><a href="#RelativeDeltaResidualNorm2-342"><span class="linenos">342</span></a>
</span><span id="RelativeDeltaResidualNorm2-343"><a href="#RelativeDeltaResidualNorm2-343"><span class="linenos">343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RelativeDeltaResidualNorm2-344"><a href="#RelativeDeltaResidualNorm2-344"><span class="linenos">344</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="RelativeDeltaResidualNorm2-345"><a href="#RelativeDeltaResidualNorm2-345"><span class="linenos">345</span></a>            <span class="s2">&quot;End of iterations: the relative variation of the residual vector &quot;</span>
</span><span id="RelativeDeltaResidualNorm2-346"><a href="#RelativeDeltaResidualNorm2-346"><span class="linenos">346</span></a>            <span class="s2">&quot;(in 2-norm) between two consecutive iterations is smaller than &quot;</span>
</span><span id="RelativeDeltaResidualNorm2-347"><a href="#RelativeDeltaResidualNorm2-347"><span class="linenos">347</span></a>            <span class="s2">&quot;the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="RelativeDeltaResidualNorm2-348"><a href="#RelativeDeltaResidualNorm2-348"><span class="linenos">348</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Relative variation of the residual vector in 2-norm, i.e.
$$ \frac{\| R_k - R_{k-1} \|_2}{\| R_{k-1} \|_2} &lt; \text{threshold} $$</p>
</div>


                            <div id="RelativeDeltaResidualNorm2.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#RelativeDeltaResidualNorm2.priority"></a>
    
    

                            </div>
                            <div id="RelativeDeltaResidualNorm2.evaluate" class="classattr">
                                        <input id="RelativeDeltaResidualNorm2.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RelativeDeltaResidualNorm2.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelativeDeltaResidualNorm2.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelativeDeltaResidualNorm2.evaluate-80"><a href="#RelativeDeltaResidualNorm2.evaluate-80"><span class="linenos">80</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="RelativeDeltaResidualNorm2.evaluate-81"><a href="#RelativeDeltaResidualNorm2.evaluate-81"><span class="linenos">81</span></a>            <span class="n">nl_monitor</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="RelativeDeltaResidualNorm2.evaluate-82"><a href="#RelativeDeltaResidualNorm2.evaluate-82"><span class="linenos">82</span></a>            <span class="k">if</span> <span class="n">nl_monitor</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="RelativeDeltaResidualNorm2.evaluate-83"><a href="#RelativeDeltaResidualNorm2.evaluate-83"><span class="linenos">83</span></a>                <span class="k">return</span>
</span><span id="RelativeDeltaResidualNorm2.evaluate-84"><a href="#RelativeDeltaResidualNorm2.evaluate-84"><span class="linenos">84</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="RelativeDeltaResidualNorm2.evaluate-85"><a href="#RelativeDeltaResidualNorm2.evaluate-85"><span class="linenos">85</span></a>                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs 3 tasks:
(i) Evaluate the criterion's current value
(ii) Update its status accordingly
(iii) Fill in its history by calling method <code><a href="#RelativeDeltaResidualNorm2.update_history">update_history</a></code></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nonlinear_monitor</strong> (NonLinearMonitor):
Instance of class <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> used to evaluate the criterion.</li>
</ul>
</div>


                            </div>
                            <div id="RelativeDeltaResidualNorm2.update_history" class="classattr">
                                        <input id="RelativeDeltaResidualNorm2.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RelativeDeltaResidualNorm2.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelativeDeltaResidualNorm2.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelativeDeltaResidualNorm2.update_history-339"><a href="#RelativeDeltaResidualNorm2.update_history-339"><span class="linenos">339</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="RelativeDeltaResidualNorm2.update_history-340"><a href="#RelativeDeltaResidualNorm2.update_history-340"><span class="linenos">340</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="RelativeDeltaResidualNorm2.update_history-341"><a href="#RelativeDeltaResidualNorm2.update_history-341"><span class="linenos">341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#RelativeDeltaResidualNorm2.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="RelativeDeltaResidualNorm2.write_stop_message" class="classattr">
                                        <input id="RelativeDeltaResidualNorm2.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RelativeDeltaResidualNorm2.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RelativeDeltaResidualNorm2.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RelativeDeltaResidualNorm2.write_stop_message-343"><a href="#RelativeDeltaResidualNorm2.write_stop_message-343"><span class="linenos">343</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="RelativeDeltaResidualNorm2.write_stop_message-344"><a href="#RelativeDeltaResidualNorm2.write_stop_message-344"><span class="linenos">344</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="RelativeDeltaResidualNorm2.write_stop_message-345"><a href="#RelativeDeltaResidualNorm2.write_stop_message-345"><span class="linenos">345</span></a>            <span class="s2">&quot;End of iterations: the relative variation of the residual vector &quot;</span>
</span><span id="RelativeDeltaResidualNorm2.write_stop_message-346"><a href="#RelativeDeltaResidualNorm2.write_stop_message-346"><span class="linenos">346</span></a>            <span class="s2">&quot;(in 2-norm) between two consecutive iterations is smaller than &quot;</span>
</span><span id="RelativeDeltaResidualNorm2.write_stop_message-347"><a href="#RelativeDeltaResidualNorm2.write_stop_message-347"><span class="linenos">347</span></a>            <span class="s2">&quot;the specified threshold = </span><span class="si">{:.1e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="RelativeDeltaResidualNorm2.write_stop_message-348"><a href="#RelativeDeltaResidualNorm2.write_stop_message-348"><span class="linenos">348</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Criterion">Criterion</a></dt>
                                <dd id="RelativeDeltaResidualNorm2.__init__" class="function"><a href="#Criterion.__init__">Criterion</a></dd>
                <dd id="RelativeDeltaResidualNorm2.threshold" class="variable"><a href="#Criterion.threshold">threshold</a></dd>
                <dd id="RelativeDeltaResidualNorm2.status" class="variable"><a href="#Criterion.status">status</a></dd>
                <dd id="RelativeDeltaResidualNorm2.value" class="variable"><a href="#Criterion.value">value</a></dd>
                <dd id="RelativeDeltaResidualNorm2.history" class="variable"><a href="#Criterion.history">history</a></dd>
                <dd id="RelativeDeltaResidualNorm2.name" class="variable"><a href="#Criterion.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ResidualReductionFactor">
                            <input id="ResidualReductionFactor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ResidualReductionFactor</span><wbr>(<span class="base"><a href="#Criterion">Criterion</a></span>):

                <label class="view-source-button" for="ResidualReductionFactor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualReductionFactor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualReductionFactor-351"><a href="#ResidualReductionFactor-351"><span class="linenos">351</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ResidualReductionFactor</span><span class="p">(</span><span class="n">Criterion</span><span class="p">):</span>
</span><span id="ResidualReductionFactor-352"><a href="#ResidualReductionFactor-352"><span class="linenos">352</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ResidualReductionFactor-353"><a href="#ResidualReductionFactor-353"><span class="linenos">353</span></a><span class="sd">    Ratio $\| R_k \|_2 / \| R_0 \|_2$, i.e. reduction factor in the 2-norm of</span>
</span><span id="ResidualReductionFactor-354"><a href="#ResidualReductionFactor-354"><span class="linenos">354</span></a><span class="sd">    the residual vector.</span>
</span><span id="ResidualReductionFactor-355"><a href="#ResidualReductionFactor-355"><span class="linenos">355</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ResidualReductionFactor-356"><a href="#ResidualReductionFactor-356"><span class="linenos">356</span></a>
</span><span id="ResidualReductionFactor-357"><a href="#ResidualReductionFactor-357"><span class="linenos">357</span></a>    <span class="n">priority</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="ResidualReductionFactor-358"><a href="#ResidualReductionFactor-358"><span class="linenos">358</span></a>
</span><span id="ResidualReductionFactor-359"><a href="#ResidualReductionFactor-359"><span class="linenos">359</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualReductionFactor-360"><a href="#ResidualReductionFactor-360"><span class="linenos">360</span></a>        <span class="n">res_vec</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">residual_vetor</span>
</span><span id="ResidualReductionFactor-361"><a href="#ResidualReductionFactor-361"><span class="linenos">361</span></a>        <span class="n">res_vec_initial</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">_get_residual_vector_at_iteration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="ResidualReductionFactor-362"><a href="#ResidualReductionFactor-362"><span class="linenos">362</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec_initial</span><span class="p">)</span>
</span><span id="ResidualReductionFactor-363"><a href="#ResidualReductionFactor-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ResidualReductionFactor-364"><a href="#ResidualReductionFactor-364"><span class="linenos">364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="ResidualReductionFactor-365"><a href="#ResidualReductionFactor-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="ResidualReductionFactor-366"><a href="#ResidualReductionFactor-366"><span class="linenos">366</span></a>
</span><span id="ResidualReductionFactor-367"><a href="#ResidualReductionFactor-367"><span class="linenos">367</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualReductionFactor-368"><a href="#ResidualReductionFactor-368"><span class="linenos">368</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="ResidualReductionFactor-369"><a href="#ResidualReductionFactor-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span><span id="ResidualReductionFactor-370"><a href="#ResidualReductionFactor-370"><span class="linenos">370</span></a>
</span><span id="ResidualReductionFactor-371"><a href="#ResidualReductionFactor-371"><span class="linenos">371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ResidualReductionFactor-372"><a href="#ResidualReductionFactor-372"><span class="linenos">372</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="ResidualReductionFactor-373"><a href="#ResidualReductionFactor-373"><span class="linenos">373</span></a>            <span class="s2">&quot;End of iterations: the residual vector has decreased by </span><span class="si">{:.1f}</span><span class="s2">% &quot;</span>
</span><span id="ResidualReductionFactor-374"><a href="#ResidualReductionFactor-374"><span class="linenos">374</span></a>            <span class="s2">&quot;(in 2-norm) between the initial guess and the current iterate, &quot;</span>
</span><span id="ResidualReductionFactor-375"><a href="#ResidualReductionFactor-375"><span class="linenos">375</span></a>            <span class="s2">&quot;which is smaller than the specified threshold = </span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="ResidualReductionFactor-376"><a href="#ResidualReductionFactor-376"><span class="linenos">376</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</span><span id="ResidualReductionFactor-377"><a href="#ResidualReductionFactor-377"><span class="linenos">377</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Ratio $\| R_k \|_2 / \| R_0 \|_2$, i.e. reduction factor in the 2-norm of
the residual vector.</p>
</div>


                            <div id="ResidualReductionFactor.priority" class="classattr">
                                <div class="attr variable">
            <span class="name">priority</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#ResidualReductionFactor.priority"></a>
    
    

                            </div>
                            <div id="ResidualReductionFactor.evaluate" class="classattr">
                                        <input id="ResidualReductionFactor.evaluate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualReductionFactor.evaluate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualReductionFactor.evaluate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualReductionFactor.evaluate-359"><a href="#ResidualReductionFactor.evaluate-359"><span class="linenos">359</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualReductionFactor.evaluate-360"><a href="#ResidualReductionFactor.evaluate-360"><span class="linenos">360</span></a>        <span class="n">res_vec</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">residual_vetor</span>
</span><span id="ResidualReductionFactor.evaluate-361"><a href="#ResidualReductionFactor.evaluate-361"><span class="linenos">361</span></a>        <span class="n">res_vec_initial</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">_get_residual_vector_at_iteration</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="ResidualReductionFactor.evaluate-362"><a href="#ResidualReductionFactor.evaluate-362"><span class="linenos">362</span></a>        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">res_vec_initial</span><span class="p">)</span>
</span><span id="ResidualReductionFactor.evaluate-363"><a href="#ResidualReductionFactor.evaluate-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ResidualReductionFactor.evaluate-364"><a href="#ResidualReductionFactor.evaluate-364"><span class="linenos">364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">update_history</span><span class="p">(</span><span class="n">nonlinear_monitor</span><span class="p">)</span>
</span><span id="ResidualReductionFactor.evaluate-365"><a href="#ResidualReductionFactor.evaluate-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs 3 tasks:
(i) Evaluate the criterion's current value
(ii) Update its status accordingly
(iii) Fill in its history by calling method <code><a href="#ResidualReductionFactor.update_history">update_history</a></code></p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nonlinear_monitor</strong> (NonLinearMonitor):
Instance of class <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> used to evaluate the criterion.</li>
</ul>
</div>


                            </div>
                            <div id="ResidualReductionFactor.update_history" class="classattr">
                                        <input id="ResidualReductionFactor.update_history-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_history</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualReductionFactor.update_history-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualReductionFactor.update_history"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualReductionFactor.update_history-367"><a href="#ResidualReductionFactor.update_history-367"><span class="linenos">367</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonlinear_monitor</span><span class="p">:</span> <span class="n">NonLinearMonitor</span><span class="p">):</span>
</span><span id="ResidualReductionFactor.update_history-368"><a href="#ResidualReductionFactor.update_history-368"><span class="linenos">368</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="n">nonlinear_monitor</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="ResidualReductionFactor.update_history-369"><a href="#ResidualReductionFactor.update_history-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</span></pre></div>


            <div class="docstring"><p>Store current criterion value in attribute <code><a href="#ResidualReductionFactor.history">history</a></code>.</p>
</div>


                            </div>
                            <div id="ResidualReductionFactor.write_stop_message" class="classattr">
                                        <input id="ResidualReductionFactor.write_stop_message-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_stop_message</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ResidualReductionFactor.write_stop_message-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ResidualReductionFactor.write_stop_message"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ResidualReductionFactor.write_stop_message-371"><a href="#ResidualReductionFactor.write_stop_message-371"><span class="linenos">371</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_stop_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ResidualReductionFactor.write_stop_message-372"><a href="#ResidualReductionFactor.write_stop_message-372"><span class="linenos">372</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="ResidualReductionFactor.write_stop_message-373"><a href="#ResidualReductionFactor.write_stop_message-373"><span class="linenos">373</span></a>            <span class="s2">&quot;End of iterations: the residual vector has decreased by </span><span class="si">{:.1f}</span><span class="s2">% &quot;</span>
</span><span id="ResidualReductionFactor.write_stop_message-374"><a href="#ResidualReductionFactor.write_stop_message-374"><span class="linenos">374</span></a>            <span class="s2">&quot;(in 2-norm) between the initial guess and the current iterate, &quot;</span>
</span><span id="ResidualReductionFactor.write_stop_message-375"><a href="#ResidualReductionFactor.write_stop_message-375"><span class="linenos">375</span></a>            <span class="s2">&quot;which is smaller than the specified threshold = </span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="ResidualReductionFactor.write_stop_message-376"><a href="#ResidualReductionFactor.write_stop_message-376"><span class="linenos">376</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</span><span id="ResidualReductionFactor.write_stop_message-377"><a href="#ResidualReductionFactor.write_stop_message-377"><span class="linenos">377</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Output message is the present criterion is responsible for the
algorithm termination.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Criterion">Criterion</a></dt>
                                <dd id="ResidualReductionFactor.__init__" class="function"><a href="#Criterion.__init__">Criterion</a></dd>
                <dd id="ResidualReductionFactor.threshold" class="variable"><a href="#Criterion.threshold">threshold</a></dd>
                <dd id="ResidualReductionFactor.status" class="variable"><a href="#Criterion.status">status</a></dd>
                <dd id="ResidualReductionFactor.value" class="variable"><a href="#Criterion.value">value</a></dd>
                <dd id="ResidualReductionFactor.history" class="variable"><a href="#Criterion.history">history</a></dd>
                <dd id="ResidualReductionFactor.name" class="variable"><a href="#Criterion.name">name</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="NonLinearMonitor">
                            <input id="NonLinearMonitor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">NonLinearMonitor</span>:

                <label class="view-source-button" for="NonLinearMonitor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor-380"><a href="#NonLinearMonitor-380"><span class="linenos">380</span></a><span class="k">class</span><span class="w"> </span><span class="nc">NonLinearMonitor</span><span class="p">:</span>
</span><span id="NonLinearMonitor-381"><a href="#NonLinearMonitor-381"><span class="linenos">381</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-382"><a href="#NonLinearMonitor-382"><span class="linenos">382</span></a><span class="sd">    Class for monitoring a `NonLinearSolver` object while solving a nonlinear</span>
</span><span id="NonLinearMonitor-383"><a href="#NonLinearMonitor-383"><span class="linenos">383</span></a><span class="sd">    problem.</span>
</span><span id="NonLinearMonitor-384"><a href="#NonLinearMonitor-384"><span class="linenos">384</span></a>
</span><span id="NonLinearMonitor-385"><a href="#NonLinearMonitor-385"><span class="linenos">385</span></a><span class="sd">    Attributes</span>
</span><span id="NonLinearMonitor-386"><a href="#NonLinearMonitor-386"><span class="linenos">386</span></a><span class="sd">    ----------</span>
</span><span id="NonLinearMonitor-387"><a href="#NonLinearMonitor-387"><span class="linenos">387</span></a><span class="sd">    criteria_class_dict : dict</span>
</span><span id="NonLinearMonitor-388"><a href="#NonLinearMonitor-388"><span class="linenos">388</span></a><span class="sd">        Class attribute. (criterion-name: criterion-class) key-value pairs.</span>
</span><span id="NonLinearMonitor-389"><a href="#NonLinearMonitor-389"><span class="linenos">389</span></a><span class="sd">    stop : bool</span>
</span><span id="NonLinearMonitor-390"><a href="#NonLinearMonitor-390"><span class="linenos">390</span></a><span class="sd">        Toggle for putting an end to the iterative algorithm.</span>
</span><span id="NonLinearMonitor-391"><a href="#NonLinearMonitor-391"><span class="linenos">391</span></a><span class="sd">    current_iter_num : int</span>
</span><span id="NonLinearMonitor-392"><a href="#NonLinearMonitor-392"><span class="linenos">392</span></a><span class="sd">        Current iteration number.</span>
</span><span id="NonLinearMonitor-393"><a href="#NonLinearMonitor-393"><span class="linenos">393</span></a><span class="sd">    minimum_iter_num : int</span>
</span><span id="NonLinearMonitor-394"><a href="#NonLinearMonitor-394"><span class="linenos">394</span></a><span class="sd">        Minimum number of iterations to be completed (lower threshold).</span>
</span><span id="NonLinearMonitor-395"><a href="#NonLinearMonitor-395"><span class="linenos">395</span></a><span class="sd">    criteria : dict</span>
</span><span id="NonLinearMonitor-396"><a href="#NonLinearMonitor-396"><span class="linenos">396</span></a><span class="sd">        Dictionary of criteria (child instances of parent abstract class</span>
</span><span id="NonLinearMonitor-397"><a href="#NonLinearMonitor-397"><span class="linenos">397</span></a><span class="sd">        `Criterion`) to be evaluated at the end of each iteration.</span>
</span><span id="NonLinearMonitor-398"><a href="#NonLinearMonitor-398"><span class="linenos">398</span></a><span class="sd">    nonlinear_solver : NonLinearSolver</span>
</span><span id="NonLinearMonitor-399"><a href="#NonLinearMonitor-399"><span class="linenos">399</span></a><span class="sd">        Instance of the `NonLinearSolver` class that is being monitored.</span>
</span><span id="NonLinearMonitor-400"><a href="#NonLinearMonitor-400"><span class="linenos">400</span></a>
</span><span id="NonLinearMonitor-401"><a href="#NonLinearMonitor-401"><span class="linenos">401</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-402"><a href="#NonLinearMonitor-402"><span class="linenos">402</span></a>
</span><span id="NonLinearMonitor-403"><a href="#NonLinearMonitor-403"><span class="linenos">403</span></a>    <span class="n">criteria_class_dict</span> <span class="o">=</span> <span class="n">get_criteria_dict</span><span class="p">()</span>
</span><span id="NonLinearMonitor-404"><a href="#NonLinearMonitor-404"><span class="linenos">404</span></a>
</span><span id="NonLinearMonitor-405"><a href="#NonLinearMonitor-405"><span class="linenos">405</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-406"><a href="#NonLinearMonitor-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="NonLinearMonitor-407"><a href="#NonLinearMonitor-407"><span class="linenos">407</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="NonLinearMonitor-408"><a href="#NonLinearMonitor-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">minimum_iter_num</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="NonLinearMonitor-409"><a href="#NonLinearMonitor-409"><span class="linenos">409</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="NonLinearMonitor-410"><a href="#NonLinearMonitor-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nonlinear_solver</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="NonLinearMonitor-411"><a href="#NonLinearMonitor-411"><span class="linenos">411</span></a>
</span><span id="NonLinearMonitor-412"><a href="#NonLinearMonitor-412"><span class="linenos">412</span></a>    <span class="nd">@property</span>
</span><span id="NonLinearMonitor-413"><a href="#NonLinearMonitor-413"><span class="linenos">413</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">maximum_iter_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-414"><a href="#NonLinearMonitor-414"><span class="linenos">414</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Maximum number of iterations to be completed (upper threshold).&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-415"><a href="#NonLinearMonitor-415"><span class="linenos">415</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">threshold</span>
</span><span id="NonLinearMonitor-416"><a href="#NonLinearMonitor-416"><span class="linenos">416</span></a>
</span><span id="NonLinearMonitor-417"><a href="#NonLinearMonitor-417"><span class="linenos">417</span></a>    <span class="nd">@property</span>
</span><span id="NonLinearMonitor-418"><a href="#NonLinearMonitor-418"><span class="linenos">418</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">residual_vetor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-419"><a href="#NonLinearMonitor-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="s1">&#39;ResidualVector&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
</span><span id="NonLinearMonitor-420"><a href="#NonLinearMonitor-420"><span class="linenos">420</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;ResidualVector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
</span><span id="NonLinearMonitor-421"><a href="#NonLinearMonitor-421"><span class="linenos">421</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="NonLinearMonitor-422"><a href="#NonLinearMonitor-422"><span class="linenos">422</span></a>
</span><span id="NonLinearMonitor-423"><a href="#NonLinearMonitor-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_maximum_iter_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maximum_iter_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="NonLinearMonitor-424"><a href="#NonLinearMonitor-424"><span class="linenos">424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">maximum_iter_num</span>
</span><span id="NonLinearMonitor-425"><a href="#NonLinearMonitor-425"><span class="linenos">425</span></a>
</span><span id="NonLinearMonitor-426"><a href="#NonLinearMonitor-426"><span class="linenos">426</span></a>    <span class="nd">@classmethod</span>
</span><span id="NonLinearMonitor-427"><a href="#NonLinearMonitor-427"><span class="linenos">427</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_scratch</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NonLinearMonitor</span><span class="p">:</span>
</span><span id="NonLinearMonitor-428"><a href="#NonLinearMonitor-428"><span class="linenos">428</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-429"><a href="#NonLinearMonitor-429"><span class="linenos">429</span></a><span class="sd">        Create an instance of `NonLinearMonitor` and set its attributes using</span>
</span><span id="NonLinearMonitor-430"><a href="#NonLinearMonitor-430"><span class="linenos">430</span></a><span class="sd">        the user provided `args_dict`, which contains the following items:</span>
</span><span id="NonLinearMonitor-431"><a href="#NonLinearMonitor-431"><span class="linenos">431</span></a>
</span><span id="NonLinearMonitor-432"><a href="#NonLinearMonitor-432"><span class="linenos">432</span></a><span class="sd">        Parameters</span>
</span><span id="NonLinearMonitor-433"><a href="#NonLinearMonitor-433"><span class="linenos">433</span></a><span class="sd">        ----------</span>
</span><span id="NonLinearMonitor-434"><a href="#NonLinearMonitor-434"><span class="linenos">434</span></a><span class="sd">        minimum_iter_num : int</span>
</span><span id="NonLinearMonitor-435"><a href="#NonLinearMonitor-435"><span class="linenos">435</span></a><span class="sd">            Minimum number of iterations to be completed (lower threshold).</span>
</span><span id="NonLinearMonitor-436"><a href="#NonLinearMonitor-436"><span class="linenos">436</span></a><span class="sd">        maximum_iter_num : int</span>
</span><span id="NonLinearMonitor-437"><a href="#NonLinearMonitor-437"><span class="linenos">437</span></a><span class="sd">            Maximum number of iterations to be completed (upper threshold).</span>
</span><span id="NonLinearMonitor-438"><a href="#NonLinearMonitor-438"><span class="linenos">438</span></a><span class="sd">        criteria : Tuple[dict]</span>
</span><span id="NonLinearMonitor-439"><a href="#NonLinearMonitor-439"><span class="linenos">439</span></a><span class="sd">            Tuple of dictionaries. Each dictionary corresponds to a given</span>
</span><span id="NonLinearMonitor-440"><a href="#NonLinearMonitor-440"><span class="linenos">440</span></a><span class="sd">            criterion, with keys</span>
</span><span id="NonLinearMonitor-441"><a href="#NonLinearMonitor-441"><span class="linenos">441</span></a><span class="sd">                - &#39;name&#39;: the name of the criterion</span>
</span><span id="NonLinearMonitor-442"><a href="#NonLinearMonitor-442"><span class="linenos">442</span></a><span class="sd">                - &#39;threshold&#39;: the criterion&#39;s threshold</span>
</span><span id="NonLinearMonitor-443"><a href="#NonLinearMonitor-443"><span class="linenos">443</span></a><span class="sd">                - &#39;look&#39;: Whether the criterion should be evaluated</span>
</span><span id="NonLinearMonitor-444"><a href="#NonLinearMonitor-444"><span class="linenos">444</span></a><span class="sd">                - &#39;active&#39;: Whether the criterion is involved in the</span>
</span><span id="NonLinearMonitor-445"><a href="#NonLinearMonitor-445"><span class="linenos">445</span></a><span class="sd">                decision-making process for stopping the algorithm</span>
</span><span id="NonLinearMonitor-446"><a href="#NonLinearMonitor-446"><span class="linenos">446</span></a>
</span><span id="NonLinearMonitor-447"><a href="#NonLinearMonitor-447"><span class="linenos">447</span></a><span class="sd">        Notes</span>
</span><span id="NonLinearMonitor-448"><a href="#NonLinearMonitor-448"><span class="linenos">448</span></a><span class="sd">        -----</span>
</span><span id="NonLinearMonitor-449"><a href="#NonLinearMonitor-449"><span class="linenos">449</span></a><span class="sd">        Sometimes, one may want to evaluate a given criterion to get more</span>
</span><span id="NonLinearMonitor-450"><a href="#NonLinearMonitor-450"><span class="linenos">450</span></a><span class="sd">        information about the current state of the iterations without making</span>
</span><span id="NonLinearMonitor-451"><a href="#NonLinearMonitor-451"><span class="linenos">451</span></a><span class="sd">        the stopping of the algorithm dependent on it. This &#39;information only&#39;</span>
</span><span id="NonLinearMonitor-452"><a href="#NonLinearMonitor-452"><span class="linenos">452</span></a><span class="sd">        mode is achieved by specifying (&#39;active&#39; = False, &#39;look&#39; = True).</span>
</span><span id="NonLinearMonitor-453"><a href="#NonLinearMonitor-453"><span class="linenos">453</span></a><span class="sd">        On the other hand, if a given criterion is set active, it will</span>
</span><span id="NonLinearMonitor-454"><a href="#NonLinearMonitor-454"><span class="linenos">454</span></a><span class="sd">        automatically be evaluated, regardless of the &#39;look&#39; setting.</span>
</span><span id="NonLinearMonitor-455"><a href="#NonLinearMonitor-455"><span class="linenos">455</span></a>
</span><span id="NonLinearMonitor-456"><a href="#NonLinearMonitor-456"><span class="linenos">456</span></a><span class="sd">        Returns</span>
</span><span id="NonLinearMonitor-457"><a href="#NonLinearMonitor-457"><span class="linenos">457</span></a><span class="sd">        -------</span>
</span><span id="NonLinearMonitor-458"><a href="#NonLinearMonitor-458"><span class="linenos">458</span></a><span class="sd">        monitor : NonLinearMonitor</span>
</span><span id="NonLinearMonitor-459"><a href="#NonLinearMonitor-459"><span class="linenos">459</span></a><span class="sd">            The created NonLinearMonitor.</span>
</span><span id="NonLinearMonitor-460"><a href="#NonLinearMonitor-460"><span class="linenos">460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-461"><a href="#NonLinearMonitor-461"><span class="linenos">461</span></a>
</span><span id="NonLinearMonitor-462"><a href="#NonLinearMonitor-462"><span class="linenos">462</span></a>        <span class="c1"># Create a new NonLinearMonitor object</span>
</span><span id="NonLinearMonitor-463"><a href="#NonLinearMonitor-463"><span class="linenos">463</span></a>        <span class="n">monitor</span> <span class="o">=</span> <span class="n">NonLinearMonitor</span><span class="p">()</span>
</span><span id="NonLinearMonitor-464"><a href="#NonLinearMonitor-464"><span class="linenos">464</span></a>
</span><span id="NonLinearMonitor-465"><a href="#NonLinearMonitor-465"><span class="linenos">465</span></a>        <span class="c1"># Fill in min/max number of iterations</span>
</span><span id="NonLinearMonitor-466"><a href="#NonLinearMonitor-466"><span class="linenos">466</span></a>        <span class="k">if</span> <span class="s1">&#39;minimum_iter_num&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
</span><span id="NonLinearMonitor-467"><a href="#NonLinearMonitor-467"><span class="linenos">467</span></a>            <span class="n">monitor</span><span class="o">.</span><span class="n">minimum_iter_num</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;minimum_iter_num&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor-468"><a href="#NonLinearMonitor-468"><span class="linenos">468</span></a>        <span class="k">if</span> <span class="s1">&#39;maximum_iter_num&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
</span><span id="NonLinearMonitor-469"><a href="#NonLinearMonitor-469"><span class="linenos">469</span></a>            <span class="n">maximum_iter_num</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;maximum_iter_num&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor-470"><a href="#NonLinearMonitor-470"><span class="linenos">470</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NonLinearMonitor-471"><a href="#NonLinearMonitor-471"><span class="linenos">471</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;&#39;maximum_iter_num&#39; must be specified by the user!&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-472"><a href="#NonLinearMonitor-472"><span class="linenos">472</span></a>        <span class="k">assert</span> <span class="n">monitor</span><span class="o">.</span><span class="n">minimum_iter_num</span> <span class="o">&lt;=</span> <span class="n">maximum_iter_num</span>
</span><span id="NonLinearMonitor-473"><a href="#NonLinearMonitor-473"><span class="linenos">473</span></a>
</span><span id="NonLinearMonitor-474"><a href="#NonLinearMonitor-474"><span class="linenos">474</span></a>        <span class="c1"># Fill in MaximumIterations criterion</span>
</span><span id="NonLinearMonitor-475"><a href="#NonLinearMonitor-475"><span class="linenos">475</span></a>        <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="NonLinearMonitor-476"><a href="#NonLinearMonitor-476"><span class="linenos">476</span></a>        <span class="n">max_iter_crit</span> <span class="o">=</span> <span class="n">MaximumIterations</span><span class="p">(</span><span class="n">maximum_iter_num</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="NonLinearMonitor-477"><a href="#NonLinearMonitor-477"><span class="linenos">477</span></a>        <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_iter_crit</span>
</span><span id="NonLinearMonitor-478"><a href="#NonLinearMonitor-478"><span class="linenos">478</span></a>
</span><span id="NonLinearMonitor-479"><a href="#NonLinearMonitor-479"><span class="linenos">479</span></a>        <span class="c1"># Fill in all other criteria</span>
</span><span id="NonLinearMonitor-480"><a href="#NonLinearMonitor-480"><span class="linenos">480</span></a>        <span class="n">criteria</span> <span class="o">=</span> <span class="n">args_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="NonLinearMonitor-481"><a href="#NonLinearMonitor-481"><span class="linenos">481</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_check_criteria_input</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
</span><span id="NonLinearMonitor-482"><a href="#NonLinearMonitor-482"><span class="linenos">482</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
</span><span id="NonLinearMonitor-483"><a href="#NonLinearMonitor-483"><span class="linenos">483</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor-484"><a href="#NonLinearMonitor-484"><span class="linenos">484</span></a>            <span class="n">threshold</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor-485"><a href="#NonLinearMonitor-485"><span class="linenos">485</span></a>            <span class="n">active</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor-486"><a href="#NonLinearMonitor-486"><span class="linenos">486</span></a>            <span class="n">look</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;look&#39;</span><span class="p">,</span> <span class="n">active</span><span class="p">)</span>
</span><span id="NonLinearMonitor-487"><a href="#NonLinearMonitor-487"><span class="linenos">487</span></a>            <span class="n">crit</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">criteria_class_dict</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">threshold</span><span class="p">,</span> <span class="n">look</span><span class="p">,</span> <span class="n">active</span><span class="p">)</span>
</span><span id="NonLinearMonitor-488"><a href="#NonLinearMonitor-488"><span class="linenos">488</span></a>            <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
</span><span id="NonLinearMonitor-489"><a href="#NonLinearMonitor-489"><span class="linenos">489</span></a>
</span><span id="NonLinearMonitor-490"><a href="#NonLinearMonitor-490"><span class="linenos">490</span></a>        <span class="k">return</span> <span class="n">monitor</span>
</span><span id="NonLinearMonitor-491"><a href="#NonLinearMonitor-491"><span class="linenos">491</span></a>
</span><span id="NonLinearMonitor-492"><a href="#NonLinearMonitor-492"><span class="linenos">492</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_criteria_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
</span><span id="NonLinearMonitor-493"><a href="#NonLinearMonitor-493"><span class="linenos">493</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-494"><a href="#NonLinearMonitor-494"><span class="linenos">494</span></a><span class="sd">        Display information regarding the registered criteria in</span>
</span><span id="NonLinearMonitor-495"><a href="#NonLinearMonitor-495"><span class="linenos">495</span></a><span class="sd">        `self.criteria`.</span>
</span><span id="NonLinearMonitor-496"><a href="#NonLinearMonitor-496"><span class="linenos">496</span></a>
</span><span id="NonLinearMonitor-497"><a href="#NonLinearMonitor-497"><span class="linenos">497</span></a><span class="sd">        Parameters</span>
</span><span id="NonLinearMonitor-498"><a href="#NonLinearMonitor-498"><span class="linenos">498</span></a><span class="sd">        ----------</span>
</span><span id="NonLinearMonitor-499"><a href="#NonLinearMonitor-499"><span class="linenos">499</span></a><span class="sd">        cols : Tuple[str]</span>
</span><span id="NonLinearMonitor-500"><a href="#NonLinearMonitor-500"><span class="linenos">500</span></a><span class="sd">            Keys for displayed information (see `valid_entries` in function</span>
</span><span id="NonLinearMonitor-501"><a href="#NonLinearMonitor-501"><span class="linenos">501</span></a><span class="sd">            definition).</span>
</span><span id="NonLinearMonitor-502"><a href="#NonLinearMonitor-502"><span class="linenos">502</span></a>
</span><span id="NonLinearMonitor-503"><a href="#NonLinearMonitor-503"><span class="linenos">503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-504"><a href="#NonLinearMonitor-504"><span class="linenos">504</span></a>
</span><span id="NonLinearMonitor-505"><a href="#NonLinearMonitor-505"><span class="linenos">505</span></a>        <span class="c1"># Preset</span>
</span><span id="NonLinearMonitor-506"><a href="#NonLinearMonitor-506"><span class="linenos">506</span></a>        <span class="n">valid_entries</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="NonLinearMonitor-507"><a href="#NonLinearMonitor-507"><span class="linenos">507</span></a>            <span class="s1">&#39;criterion&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">,</span> <span class="s1">&#39;look&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-508"><a href="#NonLinearMonitor-508"><span class="linenos">508</span></a>        <span class="n">actual_entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="NonLinearMonitor-509"><a href="#NonLinearMonitor-509"><span class="linenos">509</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span id="NonLinearMonitor-510"><a href="#NonLinearMonitor-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="s1">&#39;criterion&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="NonLinearMonitor-511"><a href="#NonLinearMonitor-511"><span class="linenos">511</span></a>            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;criterion&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-512"><a href="#NonLinearMonitor-512"><span class="linenos">512</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="NonLinearMonitor-513"><a href="#NonLinearMonitor-513"><span class="linenos">513</span></a>
</span><span id="NonLinearMonitor-514"><a href="#NonLinearMonitor-514"><span class="linenos">514</span></a>        <span class="n">criteria_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># shallow copy of dictionary</span>
</span><span id="NonLinearMonitor-515"><a href="#NonLinearMonitor-515"><span class="linenos">515</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="NonLinearMonitor-516"><a href="#NonLinearMonitor-516"><span class="linenos">516</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">crit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="NonLinearMonitor-517"><a href="#NonLinearMonitor-517"><span class="linenos">517</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crit</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="NonLinearMonitor-518"><a href="#NonLinearMonitor-518"><span class="linenos">518</span></a>                    <span class="n">criteria_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="NonLinearMonitor-519"><a href="#NonLinearMonitor-519"><span class="linenos">519</span></a>
</span><span id="NonLinearMonitor-520"><a href="#NonLinearMonitor-520"><span class="linenos">520</span></a>        <span class="c1"># Fill in data_dict</span>
</span><span id="NonLinearMonitor-521"><a href="#NonLinearMonitor-521"><span class="linenos">521</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="NonLinearMonitor-522"><a href="#NonLinearMonitor-522"><span class="linenos">522</span></a>            <span class="k">assert</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">valid_entries</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Entry &#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">&#39; is not valid!&quot;</span>
</span><span id="NonLinearMonitor-523"><a href="#NonLinearMonitor-523"><span class="linenos">523</span></a>            <span class="n">actual_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="NonLinearMonitor-524"><a href="#NonLinearMonitor-524"><span class="linenos">524</span></a>            <span class="n">entry_data_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="NonLinearMonitor-525"><a href="#NonLinearMonitor-525"><span class="linenos">525</span></a>
</span><span id="NonLinearMonitor-526"><a href="#NonLinearMonitor-526"><span class="linenos">526</span></a>            <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="s1">&#39;criterion&#39;</span><span class="p">:</span>
</span><span id="NonLinearMonitor-527"><a href="#NonLinearMonitor-527"><span class="linenos">527</span></a>                <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria_copy</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-528"><a href="#NonLinearMonitor-528"><span class="linenos">528</span></a>                    <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="NonLinearMonitor-529"><a href="#NonLinearMonitor-529"><span class="linenos">529</span></a>                <span class="n">data_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_data_list</span>
</span><span id="NonLinearMonitor-530"><a href="#NonLinearMonitor-530"><span class="linenos">530</span></a>                <span class="k">continue</span>
</span><span id="NonLinearMonitor-531"><a href="#NonLinearMonitor-531"><span class="linenos">531</span></a>
</span><span id="NonLinearMonitor-532"><a href="#NonLinearMonitor-532"><span class="linenos">532</span></a>            <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria_copy</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-533"><a href="#NonLinearMonitor-533"><span class="linenos">533</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">value</span>
</span><span id="NonLinearMonitor-534"><a href="#NonLinearMonitor-534"><span class="linenos">534</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
</span><span id="NonLinearMonitor-535"><a href="#NonLinearMonitor-535"><span class="linenos">535</span></a>                    <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="s1">&#39;value&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="NonLinearMonitor-536"><a href="#NonLinearMonitor-536"><span class="linenos">536</span></a>                        <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="NonLinearMonitor-537"><a href="#NonLinearMonitor-537"><span class="linenos">537</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="NonLinearMonitor-538"><a href="#NonLinearMonitor-538"><span class="linenos">538</span></a>                        <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">entry</span><span class="p">))</span>
</span><span id="NonLinearMonitor-539"><a href="#NonLinearMonitor-539"><span class="linenos">539</span></a>                <span class="k">elif</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>
</span><span id="NonLinearMonitor-540"><a href="#NonLinearMonitor-540"><span class="linenos">540</span></a>                    <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">entry</span><span class="p">])</span>
</span><span id="NonLinearMonitor-541"><a href="#NonLinearMonitor-541"><span class="linenos">541</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="NonLinearMonitor-542"><a href="#NonLinearMonitor-542"><span class="linenos">542</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find entry &#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-543"><a href="#NonLinearMonitor-543"><span class="linenos">543</span></a>                <span class="n">data_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_data_list</span>
</span><span id="NonLinearMonitor-544"><a href="#NonLinearMonitor-544"><span class="linenos">544</span></a>
</span><span id="NonLinearMonitor-545"><a href="#NonLinearMonitor-545"><span class="linenos">545</span></a>        <span class="c1"># Create pandas DataFrame and sort the columns</span>
</span><span id="NonLinearMonitor-546"><a href="#NonLinearMonitor-546"><span class="linenos">546</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
</span><span id="NonLinearMonitor-547"><a href="#NonLinearMonitor-547"><span class="linenos">547</span></a>        <span class="n">sort_key_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">valid_entries</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">actual_entries</span><span class="p">]</span>
</span><span id="NonLinearMonitor-548"><a href="#NonLinearMonitor-548"><span class="linenos">548</span></a>        <span class="n">sorted_zip</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sort_key_list</span><span class="p">,</span> <span class="n">actual_entries</span><span class="p">))</span>
</span><span id="NonLinearMonitor-549"><a href="#NonLinearMonitor-549"><span class="linenos">549</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">actual_entries</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">sorted_zip</span><span class="p">)</span>
</span><span id="NonLinearMonitor-550"><a href="#NonLinearMonitor-550"><span class="linenos">550</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">actual_entries</span><span class="p">)</span>
</span><span id="NonLinearMonitor-551"><a href="#NonLinearMonitor-551"><span class="linenos">551</span></a>
</span><span id="NonLinearMonitor-552"><a href="#NonLinearMonitor-552"><span class="linenos">552</span></a>        <span class="c1"># Display information</span>
</span><span id="NonLinearMonitor-553"><a href="#NonLinearMonitor-553"><span class="linenos">553</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_dataframe_string_iter</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="NonLinearMonitor-554"><a href="#NonLinearMonitor-554"><span class="linenos">554</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">output_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-555"><a href="#NonLinearMonitor-555"><span class="linenos">555</span></a>
</span><span id="NonLinearMonitor-556"><a href="#NonLinearMonitor-556"><span class="linenos">556</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_iterations_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-557"><a href="#NonLinearMonitor-557"><span class="linenos">557</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-558"><a href="#NonLinearMonitor-558"><span class="linenos">558</span></a><span class="sd">        Display criteria&#39;s value for all iterations.</span>
</span><span id="NonLinearMonitor-559"><a href="#NonLinearMonitor-559"><span class="linenos">559</span></a>
</span><span id="NonLinearMonitor-560"><a href="#NonLinearMonitor-560"><span class="linenos">560</span></a><span class="sd">        Notes</span>
</span><span id="NonLinearMonitor-561"><a href="#NonLinearMonitor-561"><span class="linenos">561</span></a><span class="sd">        -----</span>
</span><span id="NonLinearMonitor-562"><a href="#NonLinearMonitor-562"><span class="linenos">562</span></a><span class="sd">        The criteria considered here are those for which the `value` field is a</span>
</span><span id="NonLinearMonitor-563"><a href="#NonLinearMonitor-563"><span class="linenos">563</span></a><span class="sd">        number.</span>
</span><span id="NonLinearMonitor-564"><a href="#NonLinearMonitor-564"><span class="linenos">564</span></a>
</span><span id="NonLinearMonitor-565"><a href="#NonLinearMonitor-565"><span class="linenos">565</span></a><span class="sd">        todo: remove the NaN when the iterations stop before &#39;maximum_iter_num&#39;</span>
</span><span id="NonLinearMonitor-566"><a href="#NonLinearMonitor-566"><span class="linenos">566</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-567"><a href="#NonLinearMonitor-567"><span class="linenos">567</span></a>
</span><span id="NonLinearMonitor-568"><a href="#NonLinearMonitor-568"><span class="linenos">568</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NonLinearMonitor-569"><a href="#NonLinearMonitor-569"><span class="linenos">569</span></a>            <span class="s1">&#39;iter&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maximum_iter_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor-570"><a href="#NonLinearMonitor-570"><span class="linenos">570</span></a>        <span class="p">}</span>
</span><span id="NonLinearMonitor-571"><a href="#NonLinearMonitor-571"><span class="linenos">571</span></a>
</span><span id="NonLinearMonitor-572"><a href="#NonLinearMonitor-572"><span class="linenos">572</span></a>        <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-573"><a href="#NonLinearMonitor-573"><span class="linenos">573</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crit</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="ow">or</span> \
</span><span id="NonLinearMonitor-574"><a href="#NonLinearMonitor-574"><span class="linenos">574</span></a>                    <span class="n">crit</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MaximumIterations&#39;</span><span class="p">:</span>
</span><span id="NonLinearMonitor-575"><a href="#NonLinearMonitor-575"><span class="linenos">575</span></a>                <span class="k">continue</span>
</span><span id="NonLinearMonitor-576"><a href="#NonLinearMonitor-576"><span class="linenos">576</span></a>            <span class="n">data_dict</span><span class="p">[</span><span class="n">crit</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="NonLinearMonitor-577"><a href="#NonLinearMonitor-577"><span class="linenos">577</span></a>                <span class="n">crit</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="n">crit</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="NonLinearMonitor-578"><a href="#NonLinearMonitor-578"><span class="linenos">578</span></a>
</span><span id="NonLinearMonitor-579"><a href="#NonLinearMonitor-579"><span class="linenos">579</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
</span><span id="NonLinearMonitor-580"><a href="#NonLinearMonitor-580"><span class="linenos">580</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;iter&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-581"><a href="#NonLinearMonitor-581"><span class="linenos">581</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_iter_num</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
</span><span id="NonLinearMonitor-582"><a href="#NonLinearMonitor-582"><span class="linenos">582</span></a>                <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NonLinearMonitor-583"><a href="#NonLinearMonitor-583"><span class="linenos">583</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="s1">&#39;__&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NonLinearMonitor-584"><a href="#NonLinearMonitor-584"><span class="linenos">584</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_dataframe_string_report</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="NonLinearMonitor-585"><a href="#NonLinearMonitor-585"><span class="linenos">585</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">output_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-586"><a href="#NonLinearMonitor-586"><span class="linenos">586</span></a>
</span><span id="NonLinearMonitor-587"><a href="#NonLinearMonitor-587"><span class="linenos">587</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">link_monitor_to_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nl_solver</span><span class="p">:</span> <span class="s2">&quot;NonLinearSolver&quot;</span><span class="p">):</span>
</span><span id="NonLinearMonitor-588"><a href="#NonLinearMonitor-588"><span class="linenos">588</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-589"><a href="#NonLinearMonitor-589"><span class="linenos">589</span></a><span class="sd">        Link the current `NonLinearMonitor` instance to a given</span>
</span><span id="NonLinearMonitor-590"><a href="#NonLinearMonitor-590"><span class="linenos">590</span></a><span class="sd">        `NonLinearSolver` instance. This link is two-way in the sense that the</span>
</span><span id="NonLinearMonitor-591"><a href="#NonLinearMonitor-591"><span class="linenos">591</span></a><span class="sd">        two class instances hold themselves as attributes.</span>
</span><span id="NonLinearMonitor-592"><a href="#NonLinearMonitor-592"><span class="linenos">592</span></a>
</span><span id="NonLinearMonitor-593"><a href="#NonLinearMonitor-593"><span class="linenos">593</span></a><span class="sd">        Parameters</span>
</span><span id="NonLinearMonitor-594"><a href="#NonLinearMonitor-594"><span class="linenos">594</span></a><span class="sd">        ----------</span>
</span><span id="NonLinearMonitor-595"><a href="#NonLinearMonitor-595"><span class="linenos">595</span></a><span class="sd">        nl_solver : NonLinearSolver</span>
</span><span id="NonLinearMonitor-596"><a href="#NonLinearMonitor-596"><span class="linenos">596</span></a><span class="sd">            Instance of the class `NonLinearSolver` to be monitored.</span>
</span><span id="NonLinearMonitor-597"><a href="#NonLinearMonitor-597"><span class="linenos">597</span></a>
</span><span id="NonLinearMonitor-598"><a href="#NonLinearMonitor-598"><span class="linenos">598</span></a><span class="sd">        Notes</span>
</span><span id="NonLinearMonitor-599"><a href="#NonLinearMonitor-599"><span class="linenos">599</span></a><span class="sd">        -----</span>
</span><span id="NonLinearMonitor-600"><a href="#NonLinearMonitor-600"><span class="linenos">600</span></a><span class="sd">        One can either link with the present function, or equivalently with</span>
</span><span id="NonLinearMonitor-601"><a href="#NonLinearMonitor-601"><span class="linenos">601</span></a><span class="sd">        `NonLinearSolver.link_solver_to_monitor`.</span>
</span><span id="NonLinearMonitor-602"><a href="#NonLinearMonitor-602"><span class="linenos">602</span></a>
</span><span id="NonLinearMonitor-603"><a href="#NonLinearMonitor-603"><span class="linenos">603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-604"><a href="#NonLinearMonitor-604"><span class="linenos">604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nonlinear_solver</span> <span class="o">=</span> <span class="n">nl_solver</span>
</span><span id="NonLinearMonitor-605"><a href="#NonLinearMonitor-605"><span class="linenos">605</span></a>        <span class="n">nl_solver</span><span class="o">.</span><span class="n">nonlinear_monitor</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="NonLinearMonitor-606"><a href="#NonLinearMonitor-606"><span class="linenos">606</span></a>
</span><span id="NonLinearMonitor-607"><a href="#NonLinearMonitor-607"><span class="linenos">607</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-608"><a href="#NonLinearMonitor-608"><span class="linenos">608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-609"><a href="#NonLinearMonitor-609"><span class="linenos">609</span></a><span class="sd">        Update the `stop` attribute based on the status of all active criteria.</span>
</span><span id="NonLinearMonitor-610"><a href="#NonLinearMonitor-610"><span class="linenos">610</span></a><span class="sd">        todo: in the future, it might be nice to have the possibility to</span>
</span><span id="NonLinearMonitor-611"><a href="#NonLinearMonitor-611"><span class="linenos">611</span></a><span class="sd">            combine several criteria together for determining whether to stop</span>
</span><span id="NonLinearMonitor-612"><a href="#NonLinearMonitor-612"><span class="linenos">612</span></a><span class="sd">            the algorithm</span>
</span><span id="NonLinearMonitor-613"><a href="#NonLinearMonitor-613"><span class="linenos">613</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-614"><a href="#NonLinearMonitor-614"><span class="linenos">614</span></a>        <span class="c1"># Check if one criterion has been met</span>
</span><span id="NonLinearMonitor-615"><a href="#NonLinearMonitor-615"><span class="linenos">615</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_iter_num</span><span class="p">:</span>
</span><span id="NonLinearMonitor-616"><a href="#NonLinearMonitor-616"><span class="linenos">616</span></a>            <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-617"><a href="#NonLinearMonitor-617"><span class="linenos">617</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]:</span>
</span><span id="NonLinearMonitor-618"><a href="#NonLinearMonitor-618"><span class="linenos">618</span></a>                    <span class="k">continue</span>
</span><span id="NonLinearMonitor-619"><a href="#NonLinearMonitor-619"><span class="linenos">619</span></a>                <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]:</span>
</span><span id="NonLinearMonitor-620"><a href="#NonLinearMonitor-620"><span class="linenos">620</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="NonLinearMonitor-621"><a href="#NonLinearMonitor-621"><span class="linenos">621</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_fill_history_holes_with_none</span><span class="p">()</span>
</span><span id="NonLinearMonitor-622"><a href="#NonLinearMonitor-622"><span class="linenos">622</span></a>                    <span class="k">return</span>
</span><span id="NonLinearMonitor-623"><a href="#NonLinearMonitor-623"><span class="linenos">623</span></a>
</span><span id="NonLinearMonitor-624"><a href="#NonLinearMonitor-624"><span class="linenos">624</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_termination_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-625"><a href="#NonLinearMonitor-625"><span class="linenos">625</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the termination message associated with the criterion that has</span>
</span><span id="NonLinearMonitor-626"><a href="#NonLinearMonitor-626"><span class="linenos">626</span></a><span class="sd">        been met.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-627"><a href="#NonLinearMonitor-627"><span class="linenos">627</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-628"><a href="#NonLinearMonitor-628"><span class="linenos">628</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]:</span>
</span><span id="NonLinearMonitor-629"><a href="#NonLinearMonitor-629"><span class="linenos">629</span></a>                <span class="n">criterion</span><span class="o">.</span><span class="n">write_stop_message</span><span class="p">()</span>
</span><span id="NonLinearMonitor-630"><a href="#NonLinearMonitor-630"><span class="linenos">630</span></a>
</span><span id="NonLinearMonitor-631"><a href="#NonLinearMonitor-631"><span class="linenos">631</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_all_criteria</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-632"><a href="#NonLinearMonitor-632"><span class="linenos">632</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate all criteria registered in `self.criteria`.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-633"><a href="#NonLinearMonitor-633"><span class="linenos">633</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sorted_criteria_list</span><span class="p">():</span>
</span><span id="NonLinearMonitor-634"><a href="#NonLinearMonitor-634"><span class="linenos">634</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span>
</span><span id="NonLinearMonitor-635"><a href="#NonLinearMonitor-635"><span class="linenos">635</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;look&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]:</span>
</span><span id="NonLinearMonitor-636"><a href="#NonLinearMonitor-636"><span class="linenos">636</span></a>                <span class="k">continue</span>
</span><span id="NonLinearMonitor-637"><a href="#NonLinearMonitor-637"><span class="linenos">637</span></a>            <span class="n">criterion</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="NonLinearMonitor-638"><a href="#NonLinearMonitor-638"><span class="linenos">638</span></a>
</span><span id="NonLinearMonitor-639"><a href="#NonLinearMonitor-639"><span class="linenos">639</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">disable_all_criteria</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-640"><a href="#NonLinearMonitor-640"><span class="linenos">640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set `active=False` for all criteria but &#39;MaximumIterations&#39;.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-641"><a href="#NonLinearMonitor-641"><span class="linenos">641</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-642"><a href="#NonLinearMonitor-642"><span class="linenos">642</span></a>            <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="NonLinearMonitor-643"><a href="#NonLinearMonitor-643"><span class="linenos">643</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="NonLinearMonitor-644"><a href="#NonLinearMonitor-644"><span class="linenos">644</span></a>
</span><span id="NonLinearMonitor-645"><a href="#NonLinearMonitor-645"><span class="linenos">645</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_sorted_criteria_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Criterion</span><span class="p">]:</span>
</span><span id="NonLinearMonitor-646"><a href="#NonLinearMonitor-646"><span class="linenos">646</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-647"><a href="#NonLinearMonitor-647"><span class="linenos">647</span></a><span class="sd">        Sort values of `criteria` dictionary according to their `priority`</span>
</span><span id="NonLinearMonitor-648"><a href="#NonLinearMonitor-648"><span class="linenos">648</span></a><span class="sd">        attribute.</span>
</span><span id="NonLinearMonitor-649"><a href="#NonLinearMonitor-649"><span class="linenos">649</span></a>
</span><span id="NonLinearMonitor-650"><a href="#NonLinearMonitor-650"><span class="linenos">650</span></a><span class="sd">        Returns</span>
</span><span id="NonLinearMonitor-651"><a href="#NonLinearMonitor-651"><span class="linenos">651</span></a><span class="sd">        -------</span>
</span><span id="NonLinearMonitor-652"><a href="#NonLinearMonitor-652"><span class="linenos">652</span></a><span class="sd">        List of sorted `Criterion` instances.</span>
</span><span id="NonLinearMonitor-653"><a href="#NonLinearMonitor-653"><span class="linenos">653</span></a>
</span><span id="NonLinearMonitor-654"><a href="#NonLinearMonitor-654"><span class="linenos">654</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-655"><a href="#NonLinearMonitor-655"><span class="linenos">655</span></a>        <span class="n">criteria</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span>
</span><span id="NonLinearMonitor-656"><a href="#NonLinearMonitor-656"><span class="linenos">656</span></a>        <span class="n">priority_line</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="NonLinearMonitor-657"><a href="#NonLinearMonitor-657"><span class="linenos">657</span></a>        <span class="n">waiting_line</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="NonLinearMonitor-658"><a href="#NonLinearMonitor-658"><span class="linenos">658</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-659"><a href="#NonLinearMonitor-659"><span class="linenos">659</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">priority</span><span class="p">:</span>
</span><span id="NonLinearMonitor-660"><a href="#NonLinearMonitor-660"><span class="linenos">660</span></a>                <span class="n">priority_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span>
</span><span id="NonLinearMonitor-661"><a href="#NonLinearMonitor-661"><span class="linenos">661</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="NonLinearMonitor-662"><a href="#NonLinearMonitor-662"><span class="linenos">662</span></a>                <span class="n">waiting_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span>
</span><span id="NonLinearMonitor-663"><a href="#NonLinearMonitor-663"><span class="linenos">663</span></a>        <span class="k">return</span> <span class="n">priority_line</span> <span class="o">+</span> <span class="n">waiting_line</span>
</span><span id="NonLinearMonitor-664"><a href="#NonLinearMonitor-664"><span class="linenos">664</span></a>
</span><span id="NonLinearMonitor-665"><a href="#NonLinearMonitor-665"><span class="linenos">665</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_residual_vector_at_iteration</span><span class="p">(</span>
</span><span id="NonLinearMonitor-666"><a href="#NonLinearMonitor-666"><span class="linenos">666</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">iteration_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
</span><span id="NonLinearMonitor-667"><a href="#NonLinearMonitor-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve residual vector at a given iteration.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-668"><a href="#NonLinearMonitor-668"><span class="linenos">668</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-669"><a href="#NonLinearMonitor-669"><span class="linenos">669</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;ResidualVector&#39;</span><span class="p">:</span>
</span><span id="NonLinearMonitor-670"><a href="#NonLinearMonitor-670"><span class="linenos">670</span></a>                <span class="k">return</span> <span class="n">criterion</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">iteration_number</span><span class="p">]</span>
</span><span id="NonLinearMonitor-671"><a href="#NonLinearMonitor-671"><span class="linenos">671</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="NonLinearMonitor-672"><a href="#NonLinearMonitor-672"><span class="linenos">672</span></a>
</span><span id="NonLinearMonitor-673"><a href="#NonLinearMonitor-673"><span class="linenos">673</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_dataframe_string_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="NonLinearMonitor-674"><a href="#NonLinearMonitor-674"><span class="linenos">674</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format dataframe string for subsequent printing of iteration info.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-675"><a href="#NonLinearMonitor-675"><span class="linenos">675</span></a>        <span class="n">df_str</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">col_space</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
</span><span id="NonLinearMonitor-676"><a href="#NonLinearMonitor-676"><span class="linenos">676</span></a>                                     <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</span><span id="NonLinearMonitor-677"><a href="#NonLinearMonitor-677"><span class="linenos">677</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="NonLinearMonitor-678"><a href="#NonLinearMonitor-678"><span class="linenos">678</span></a>        <span class="n">it</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span>
</span><span id="NonLinearMonitor-679"><a href="#NonLinearMonitor-679"><span class="linenos">679</span></a>        <span class="k">if</span> <span class="n">it</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="NonLinearMonitor-680"><a href="#NonLinearMonitor-680"><span class="linenos">680</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; MONITORING PARAMETERS &quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-681"><a href="#NonLinearMonitor-681"><span class="linenos">681</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NonLinearMonitor-682"><a href="#NonLinearMonitor-682"><span class="linenos">682</span></a>            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; ITERATION NO </span><span class="si">{:d}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">it</span><span class="p">)</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-683"><a href="#NonLinearMonitor-683"><span class="linenos">683</span></a>        <span class="n">bottom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-684"><a href="#NonLinearMonitor-684"><span class="linenos">684</span></a>        <span class="k">return</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">df_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">bottom</span>
</span><span id="NonLinearMonitor-685"><a href="#NonLinearMonitor-685"><span class="linenos">685</span></a>
</span><span id="NonLinearMonitor-686"><a href="#NonLinearMonitor-686"><span class="linenos">686</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_dataframe_string_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataframe</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="NonLinearMonitor-687"><a href="#NonLinearMonitor-687"><span class="linenos">687</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Format dataframe string for subsequent printing of report info.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-688"><a href="#NonLinearMonitor-688"><span class="linenos">688</span></a>        <span class="n">df_str</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">col_space</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="NonLinearMonitor-689"><a href="#NonLinearMonitor-689"><span class="linenos">689</span></a>                                     <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
</span><span id="NonLinearMonitor-690"><a href="#NonLinearMonitor-690"><span class="linenos">690</span></a>                                     <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.2e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</span><span id="NonLinearMonitor-691"><a href="#NonLinearMonitor-691"><span class="linenos">691</span></a>        <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="NonLinearMonitor-692"><a href="#NonLinearMonitor-692"><span class="linenos">692</span></a>        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; RECAP OF ALL ITERATIONS &quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-693"><a href="#NonLinearMonitor-693"><span class="linenos">693</span></a>        <span class="n">bottom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-694"><a href="#NonLinearMonitor-694"><span class="linenos">694</span></a>        <span class="k">return</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">df_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">bottom</span>
</span><span id="NonLinearMonitor-695"><a href="#NonLinearMonitor-695"><span class="linenos">695</span></a>
</span><span id="NonLinearMonitor-696"><a href="#NonLinearMonitor-696"><span class="linenos">696</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_fill_history_holes_with_none</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor-697"><a href="#NonLinearMonitor-697"><span class="linenos">697</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maximum_iter_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="NonLinearMonitor-698"><a href="#NonLinearMonitor-698"><span class="linenos">698</span></a>            <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor-699"><a href="#NonLinearMonitor-699"><span class="linenos">699</span></a>                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">criterion</span><span class="o">.</span><span class="n">history</span><span class="p">:</span>
</span><span id="NonLinearMonitor-700"><a href="#NonLinearMonitor-700"><span class="linenos">700</span></a>                    <span class="n">criterion</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="NonLinearMonitor-701"><a href="#NonLinearMonitor-701"><span class="linenos">701</span></a>                <span class="n">criterion</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</span><span id="NonLinearMonitor-702"><a href="#NonLinearMonitor-702"><span class="linenos">702</span></a>
</span><span id="NonLinearMonitor-703"><a href="#NonLinearMonitor-703"><span class="linenos">703</span></a>    <span class="nd">@staticmethod</span>
</span><span id="NonLinearMonitor-704"><a href="#NonLinearMonitor-704"><span class="linenos">704</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_check_criteria_input</span><span class="p">(</span><span class="n">criteria</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Criterion</span><span class="p">]):</span>
</span><span id="NonLinearMonitor-705"><a href="#NonLinearMonitor-705"><span class="linenos">705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-706"><a href="#NonLinearMonitor-706"><span class="linenos">706</span></a><span class="sd">        Check that the user-provided `criteria` tuple complies with</span>
</span><span id="NonLinearMonitor-707"><a href="#NonLinearMonitor-707"><span class="linenos">707</span></a><span class="sd">        `from_scratch` method (see docstring above).</span>
</span><span id="NonLinearMonitor-708"><a href="#NonLinearMonitor-708"><span class="linenos">708</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor-709"><a href="#NonLinearMonitor-709"><span class="linenos">709</span></a>
</span><span id="NonLinearMonitor-710"><a href="#NonLinearMonitor-710"><span class="linenos">710</span></a>        <span class="k">if</span> <span class="n">criteria</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
</span><span id="NonLinearMonitor-711"><a href="#NonLinearMonitor-711"><span class="linenos">711</span></a>        <span class="n">mandatory_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor-712"><a href="#NonLinearMonitor-712"><span class="linenos">712</span></a>
</span><span id="NonLinearMonitor-713"><a href="#NonLinearMonitor-713"><span class="linenos">713</span></a>        <span class="c1"># Check that criteria is iterable</span>
</span><span id="NonLinearMonitor-714"><a href="#NonLinearMonitor-714"><span class="linenos">714</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criteria</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
</span><span id="NonLinearMonitor-715"><a href="#NonLinearMonitor-715"><span class="linenos">715</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;criteria&#39; should be a tuple, not a &quot;</span>
</span><span id="NonLinearMonitor-716"><a href="#NonLinearMonitor-716"><span class="linenos">716</span></a>                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-717"><a href="#NonLinearMonitor-717"><span class="linenos">717</span></a>
</span><span id="NonLinearMonitor-718"><a href="#NonLinearMonitor-718"><span class="linenos">718</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
</span><span id="NonLinearMonitor-719"><a href="#NonLinearMonitor-719"><span class="linenos">719</span></a>            <span class="c1"># Check type of each item</span>
</span><span id="NonLinearMonitor-720"><a href="#NonLinearMonitor-720"><span class="linenos">720</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="NonLinearMonitor-721"><a href="#NonLinearMonitor-721"><span class="linenos">721</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;criteria&#39; items should be dictionaries, &quot;</span>
</span><span id="NonLinearMonitor-722"><a href="#NonLinearMonitor-722"><span class="linenos">722</span></a>                                <span class="sa">f</span><span class="s2">&quot;but one item is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-723"><a href="#NonLinearMonitor-723"><span class="linenos">723</span></a>
</span><span id="NonLinearMonitor-724"><a href="#NonLinearMonitor-724"><span class="linenos">724</span></a>            <span class="c1"># Check keys of each item</span>
</span><span id="NonLinearMonitor-725"><a href="#NonLinearMonitor-725"><span class="linenos">725</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">criterion</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mandatory_keys</span><span class="p">):</span>
</span><span id="NonLinearMonitor-726"><a href="#NonLinearMonitor-726"><span class="linenos">726</span></a>                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="NonLinearMonitor-727"><a href="#NonLinearMonitor-727"><span class="linenos">727</span></a>                    <span class="sa">f</span><span class="s2">&quot;Missing (at least) one key from </span><span class="si">{</span><span class="n">mandatory_keys</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-728"><a href="#NonLinearMonitor-728"><span class="linenos">728</span></a>
</span><span id="NonLinearMonitor-729"><a href="#NonLinearMonitor-729"><span class="linenos">729</span></a>            <span class="c1"># Check name of the criterion</span>
</span><span id="NonLinearMonitor-730"><a href="#NonLinearMonitor-730"><span class="linenos">730</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NonLinearMonitor</span><span class="o">.</span><span class="n">criteria_class_dict</span><span class="p">:</span>
</span><span id="NonLinearMonitor-731"><a href="#NonLinearMonitor-731"><span class="linenos">731</span></a>                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="NonLinearMonitor-732"><a href="#NonLinearMonitor-732"><span class="linenos">732</span></a>                    <span class="sa">f</span><span class="s2">&quot;Criterion &#39;</span><span class="si">{</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; is not implemented yet&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-733"><a href="#NonLinearMonitor-733"><span class="linenos">733</span></a>
</span><span id="NonLinearMonitor-734"><a href="#NonLinearMonitor-734"><span class="linenos">734</span></a>            <span class="c1"># Check types</span>
</span><span id="NonLinearMonitor-735"><a href="#NonLinearMonitor-735"><span class="linenos">735</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">],</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="NonLinearMonitor-736"><a href="#NonLinearMonitor-736"><span class="linenos">736</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;threshold&#39; should be a float, but is of type&quot;</span>
</span><span id="NonLinearMonitor-737"><a href="#NonLinearMonitor-737"><span class="linenos">737</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> instead&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor-738"><a href="#NonLinearMonitor-738"><span class="linenos">738</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">],</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="NonLinearMonitor-739"><a href="#NonLinearMonitor-739"><span class="linenos">739</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;active&#39; should a boolean, but is of type&quot;</span>
</span><span id="NonLinearMonitor-740"><a href="#NonLinearMonitor-740"><span class="linenos">740</span></a>                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> instead&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class for monitoring a <code>NonLinearSolver</code> object while solving a nonlinear
problem.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>criteria_class_dict</strong> (dict):
Class attribute. (criterion-name: criterion-class) key-value pairs.</li>
<li><strong>stop</strong> (bool):
Toggle for putting an end to the iterative algorithm.</li>
<li><strong>current_iter_num</strong> (int):
Current iteration number.</li>
<li><strong>minimum_iter_num</strong> (int):
Minimum number of iterations to be completed (lower threshold).</li>
<li><strong>criteria</strong> (dict):
Dictionary of criteria (child instances of parent abstract class
<code><a href="#Criterion">Criterion</a></code>) to be evaluated at the end of each iteration.</li>
<li><strong>nonlinear_solver</strong> (NonLinearSolver):
Instance of the <code>NonLinearSolver</code> class that is being monitored.</li>
</ul>
</div>


                            <div id="NonLinearMonitor.criteria_class_dict" class="classattr">
                                <div class="attr variable">
            <span class="name">criteria_class_dict</span>        =
<input id="NonLinearMonitor.criteria_class_dict-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="NonLinearMonitor.criteria_class_dict-view-value"></label><span class="default_value">{&#39;AbsoluteDeltaSolutionNorm2&#39;: &lt;class &#39;<a href="#AbsoluteDeltaSolutionNorm2">AbsoluteDeltaSolutionNorm2</a>&#39;&gt;, &#39;MaximumIterations&#39;: &lt;class &#39;<a href="#MaximumIterations">MaximumIterations</a>&#39;&gt;, &#39;RelativeDeltaResidualNorm2&#39;: &lt;class &#39;<a href="#RelativeDeltaResidualNorm2">RelativeDeltaResidualNorm2</a>&#39;&gt;, &#39;RelativeDeltaSolutionNorm2&#39;: &lt;class &#39;<a href="#RelativeDeltaSolutionNorm2">RelativeDeltaSolutionNorm2</a>&#39;&gt;, &#39;ResidualReductionFactor&#39;: &lt;class &#39;<a href="#ResidualReductionFactor">ResidualReductionFactor</a>&#39;&gt;, &#39;ResidualVector&#39;: &lt;class &#39;<a href="#ResidualVector">ResidualVector</a>&#39;&gt;, &#39;ResidualVectorNorm2&#39;: &lt;class &#39;<a href="#ResidualVectorNorm2">ResidualVectorNorm2</a>&#39;&gt;, &#39;ResidualVectorParts&#39;: &lt;class &#39;<a href="#ResidualVectorParts">ResidualVectorParts</a>&#39;&gt;}</span>

        
    </div>
    <a class="headerlink" href="#NonLinearMonitor.criteria_class_dict"></a>
    
    

                            </div>
                            <div id="NonLinearMonitor.stop" class="classattr">
                                <div class="attr variable">
            <span class="name">stop</span>

        
    </div>
    <a class="headerlink" href="#NonLinearMonitor.stop"></a>
    
    

                            </div>
                            <div id="NonLinearMonitor.current_iter_num" class="classattr">
                                <div class="attr variable">
            <span class="name">current_iter_num</span>

        
    </div>
    <a class="headerlink" href="#NonLinearMonitor.current_iter_num"></a>
    
    

                            </div>
                            <div id="NonLinearMonitor.minimum_iter_num" class="classattr">
                                <div class="attr variable">
            <span class="name">minimum_iter_num</span>

        
    </div>
    <a class="headerlink" href="#NonLinearMonitor.minimum_iter_num"></a>
    
    

                            </div>
                            <div id="NonLinearMonitor.criteria" class="classattr">
                                <div class="attr variable">
            <span class="name">criteria</span>

        
    </div>
    <a class="headerlink" href="#NonLinearMonitor.criteria"></a>
    
    

                            </div>
                            <div id="NonLinearMonitor.nonlinear_solver" class="classattr">
                                <div class="attr variable">
            <span class="name">nonlinear_solver</span>

        
    </div>
    <a class="headerlink" href="#NonLinearMonitor.nonlinear_solver"></a>
    
    

                            </div>
                            <div id="NonLinearMonitor.maximum_iter_num" class="classattr">
                                        <input id="NonLinearMonitor.maximum_iter_num-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">maximum_iter_num</span>

                <label class="view-source-button" for="NonLinearMonitor.maximum_iter_num-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.maximum_iter_num"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.maximum_iter_num-412"><a href="#NonLinearMonitor.maximum_iter_num-412"><span class="linenos">412</span></a>    <span class="nd">@property</span>
</span><span id="NonLinearMonitor.maximum_iter_num-413"><a href="#NonLinearMonitor.maximum_iter_num-413"><span class="linenos">413</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">maximum_iter_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor.maximum_iter_num-414"><a href="#NonLinearMonitor.maximum_iter_num-414"><span class="linenos">414</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Maximum number of iterations to be completed (upper threshold).&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.maximum_iter_num-415"><a href="#NonLinearMonitor.maximum_iter_num-415"><span class="linenos">415</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">threshold</span>
</span></pre></div>


            <div class="docstring"><p>Maximum number of iterations to be completed (upper threshold).</p>
</div>


                            </div>
                            <div id="NonLinearMonitor.residual_vetor" class="classattr">
                                        <input id="NonLinearMonitor.residual_vetor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">residual_vetor</span>

                <label class="view-source-button" for="NonLinearMonitor.residual_vetor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.residual_vetor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.residual_vetor-417"><a href="#NonLinearMonitor.residual_vetor-417"><span class="linenos">417</span></a>    <span class="nd">@property</span>
</span><span id="NonLinearMonitor.residual_vetor-418"><a href="#NonLinearMonitor.residual_vetor-418"><span class="linenos">418</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">residual_vetor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor.residual_vetor-419"><a href="#NonLinearMonitor.residual_vetor-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="s1">&#39;ResidualVector&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">:</span>
</span><span id="NonLinearMonitor.residual_vetor-420"><a href="#NonLinearMonitor.residual_vetor-420"><span class="linenos">420</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;ResidualVector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
</span><span id="NonLinearMonitor.residual_vetor-421"><a href="#NonLinearMonitor.residual_vetor-421"><span class="linenos">421</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="NonLinearMonitor.set_maximum_iter_num" class="classattr">
                                        <input id="NonLinearMonitor.set_maximum_iter_num-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_maximum_iter_num</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">maximum_iter_num</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NonLinearMonitor.set_maximum_iter_num-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.set_maximum_iter_num"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.set_maximum_iter_num-423"><a href="#NonLinearMonitor.set_maximum_iter_num-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_maximum_iter_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maximum_iter_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="NonLinearMonitor.set_maximum_iter_num-424"><a href="#NonLinearMonitor.set_maximum_iter_num-424"><span class="linenos">424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">maximum_iter_num</span>
</span></pre></div>


    

                            </div>
                            <div id="NonLinearMonitor.from_scratch" class="classattr">
                                        <input id="NonLinearMonitor.from_scratch-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_scratch</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">) -> <span class="n"><a href="#NonLinearMonitor">NonLinearMonitor</a></span>:</span></span>

                <label class="view-source-button" for="NonLinearMonitor.from_scratch-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.from_scratch"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.from_scratch-426"><a href="#NonLinearMonitor.from_scratch-426"><span class="linenos">426</span></a>    <span class="nd">@classmethod</span>
</span><span id="NonLinearMonitor.from_scratch-427"><a href="#NonLinearMonitor.from_scratch-427"><span class="linenos">427</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_scratch</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">args_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NonLinearMonitor</span><span class="p">:</span>
</span><span id="NonLinearMonitor.from_scratch-428"><a href="#NonLinearMonitor.from_scratch-428"><span class="linenos">428</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.from_scratch-429"><a href="#NonLinearMonitor.from_scratch-429"><span class="linenos">429</span></a><span class="sd">        Create an instance of `NonLinearMonitor` and set its attributes using</span>
</span><span id="NonLinearMonitor.from_scratch-430"><a href="#NonLinearMonitor.from_scratch-430"><span class="linenos">430</span></a><span class="sd">        the user provided `args_dict`, which contains the following items:</span>
</span><span id="NonLinearMonitor.from_scratch-431"><a href="#NonLinearMonitor.from_scratch-431"><span class="linenos">431</span></a>
</span><span id="NonLinearMonitor.from_scratch-432"><a href="#NonLinearMonitor.from_scratch-432"><span class="linenos">432</span></a><span class="sd">        Parameters</span>
</span><span id="NonLinearMonitor.from_scratch-433"><a href="#NonLinearMonitor.from_scratch-433"><span class="linenos">433</span></a><span class="sd">        ----------</span>
</span><span id="NonLinearMonitor.from_scratch-434"><a href="#NonLinearMonitor.from_scratch-434"><span class="linenos">434</span></a><span class="sd">        minimum_iter_num : int</span>
</span><span id="NonLinearMonitor.from_scratch-435"><a href="#NonLinearMonitor.from_scratch-435"><span class="linenos">435</span></a><span class="sd">            Minimum number of iterations to be completed (lower threshold).</span>
</span><span id="NonLinearMonitor.from_scratch-436"><a href="#NonLinearMonitor.from_scratch-436"><span class="linenos">436</span></a><span class="sd">        maximum_iter_num : int</span>
</span><span id="NonLinearMonitor.from_scratch-437"><a href="#NonLinearMonitor.from_scratch-437"><span class="linenos">437</span></a><span class="sd">            Maximum number of iterations to be completed (upper threshold).</span>
</span><span id="NonLinearMonitor.from_scratch-438"><a href="#NonLinearMonitor.from_scratch-438"><span class="linenos">438</span></a><span class="sd">        criteria : Tuple[dict]</span>
</span><span id="NonLinearMonitor.from_scratch-439"><a href="#NonLinearMonitor.from_scratch-439"><span class="linenos">439</span></a><span class="sd">            Tuple of dictionaries. Each dictionary corresponds to a given</span>
</span><span id="NonLinearMonitor.from_scratch-440"><a href="#NonLinearMonitor.from_scratch-440"><span class="linenos">440</span></a><span class="sd">            criterion, with keys</span>
</span><span id="NonLinearMonitor.from_scratch-441"><a href="#NonLinearMonitor.from_scratch-441"><span class="linenos">441</span></a><span class="sd">                - &#39;name&#39;: the name of the criterion</span>
</span><span id="NonLinearMonitor.from_scratch-442"><a href="#NonLinearMonitor.from_scratch-442"><span class="linenos">442</span></a><span class="sd">                - &#39;threshold&#39;: the criterion&#39;s threshold</span>
</span><span id="NonLinearMonitor.from_scratch-443"><a href="#NonLinearMonitor.from_scratch-443"><span class="linenos">443</span></a><span class="sd">                - &#39;look&#39;: Whether the criterion should be evaluated</span>
</span><span id="NonLinearMonitor.from_scratch-444"><a href="#NonLinearMonitor.from_scratch-444"><span class="linenos">444</span></a><span class="sd">                - &#39;active&#39;: Whether the criterion is involved in the</span>
</span><span id="NonLinearMonitor.from_scratch-445"><a href="#NonLinearMonitor.from_scratch-445"><span class="linenos">445</span></a><span class="sd">                decision-making process for stopping the algorithm</span>
</span><span id="NonLinearMonitor.from_scratch-446"><a href="#NonLinearMonitor.from_scratch-446"><span class="linenos">446</span></a>
</span><span id="NonLinearMonitor.from_scratch-447"><a href="#NonLinearMonitor.from_scratch-447"><span class="linenos">447</span></a><span class="sd">        Notes</span>
</span><span id="NonLinearMonitor.from_scratch-448"><a href="#NonLinearMonitor.from_scratch-448"><span class="linenos">448</span></a><span class="sd">        -----</span>
</span><span id="NonLinearMonitor.from_scratch-449"><a href="#NonLinearMonitor.from_scratch-449"><span class="linenos">449</span></a><span class="sd">        Sometimes, one may want to evaluate a given criterion to get more</span>
</span><span id="NonLinearMonitor.from_scratch-450"><a href="#NonLinearMonitor.from_scratch-450"><span class="linenos">450</span></a><span class="sd">        information about the current state of the iterations without making</span>
</span><span id="NonLinearMonitor.from_scratch-451"><a href="#NonLinearMonitor.from_scratch-451"><span class="linenos">451</span></a><span class="sd">        the stopping of the algorithm dependent on it. This &#39;information only&#39;</span>
</span><span id="NonLinearMonitor.from_scratch-452"><a href="#NonLinearMonitor.from_scratch-452"><span class="linenos">452</span></a><span class="sd">        mode is achieved by specifying (&#39;active&#39; = False, &#39;look&#39; = True).</span>
</span><span id="NonLinearMonitor.from_scratch-453"><a href="#NonLinearMonitor.from_scratch-453"><span class="linenos">453</span></a><span class="sd">        On the other hand, if a given criterion is set active, it will</span>
</span><span id="NonLinearMonitor.from_scratch-454"><a href="#NonLinearMonitor.from_scratch-454"><span class="linenos">454</span></a><span class="sd">        automatically be evaluated, regardless of the &#39;look&#39; setting.</span>
</span><span id="NonLinearMonitor.from_scratch-455"><a href="#NonLinearMonitor.from_scratch-455"><span class="linenos">455</span></a>
</span><span id="NonLinearMonitor.from_scratch-456"><a href="#NonLinearMonitor.from_scratch-456"><span class="linenos">456</span></a><span class="sd">        Returns</span>
</span><span id="NonLinearMonitor.from_scratch-457"><a href="#NonLinearMonitor.from_scratch-457"><span class="linenos">457</span></a><span class="sd">        -------</span>
</span><span id="NonLinearMonitor.from_scratch-458"><a href="#NonLinearMonitor.from_scratch-458"><span class="linenos">458</span></a><span class="sd">        monitor : NonLinearMonitor</span>
</span><span id="NonLinearMonitor.from_scratch-459"><a href="#NonLinearMonitor.from_scratch-459"><span class="linenos">459</span></a><span class="sd">            The created NonLinearMonitor.</span>
</span><span id="NonLinearMonitor.from_scratch-460"><a href="#NonLinearMonitor.from_scratch-460"><span class="linenos">460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.from_scratch-461"><a href="#NonLinearMonitor.from_scratch-461"><span class="linenos">461</span></a>
</span><span id="NonLinearMonitor.from_scratch-462"><a href="#NonLinearMonitor.from_scratch-462"><span class="linenos">462</span></a>        <span class="c1"># Create a new NonLinearMonitor object</span>
</span><span id="NonLinearMonitor.from_scratch-463"><a href="#NonLinearMonitor.from_scratch-463"><span class="linenos">463</span></a>        <span class="n">monitor</span> <span class="o">=</span> <span class="n">NonLinearMonitor</span><span class="p">()</span>
</span><span id="NonLinearMonitor.from_scratch-464"><a href="#NonLinearMonitor.from_scratch-464"><span class="linenos">464</span></a>
</span><span id="NonLinearMonitor.from_scratch-465"><a href="#NonLinearMonitor.from_scratch-465"><span class="linenos">465</span></a>        <span class="c1"># Fill in min/max number of iterations</span>
</span><span id="NonLinearMonitor.from_scratch-466"><a href="#NonLinearMonitor.from_scratch-466"><span class="linenos">466</span></a>        <span class="k">if</span> <span class="s1">&#39;minimum_iter_num&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
</span><span id="NonLinearMonitor.from_scratch-467"><a href="#NonLinearMonitor.from_scratch-467"><span class="linenos">467</span></a>            <span class="n">monitor</span><span class="o">.</span><span class="n">minimum_iter_num</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;minimum_iter_num&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor.from_scratch-468"><a href="#NonLinearMonitor.from_scratch-468"><span class="linenos">468</span></a>        <span class="k">if</span> <span class="s1">&#39;maximum_iter_num&#39;</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="p">:</span>
</span><span id="NonLinearMonitor.from_scratch-469"><a href="#NonLinearMonitor.from_scratch-469"><span class="linenos">469</span></a>            <span class="n">maximum_iter_num</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="s1">&#39;maximum_iter_num&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor.from_scratch-470"><a href="#NonLinearMonitor.from_scratch-470"><span class="linenos">470</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NonLinearMonitor.from_scratch-471"><a href="#NonLinearMonitor.from_scratch-471"><span class="linenos">471</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;&#39;maximum_iter_num&#39; must be specified by the user!&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor.from_scratch-472"><a href="#NonLinearMonitor.from_scratch-472"><span class="linenos">472</span></a>        <span class="k">assert</span> <span class="n">monitor</span><span class="o">.</span><span class="n">minimum_iter_num</span> <span class="o">&lt;=</span> <span class="n">maximum_iter_num</span>
</span><span id="NonLinearMonitor.from_scratch-473"><a href="#NonLinearMonitor.from_scratch-473"><span class="linenos">473</span></a>
</span><span id="NonLinearMonitor.from_scratch-474"><a href="#NonLinearMonitor.from_scratch-474"><span class="linenos">474</span></a>        <span class="c1"># Fill in MaximumIterations criterion</span>
</span><span id="NonLinearMonitor.from_scratch-475"><a href="#NonLinearMonitor.from_scratch-475"><span class="linenos">475</span></a>        <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="NonLinearMonitor.from_scratch-476"><a href="#NonLinearMonitor.from_scratch-476"><span class="linenos">476</span></a>        <span class="n">max_iter_crit</span> <span class="o">=</span> <span class="n">MaximumIterations</span><span class="p">(</span><span class="n">maximum_iter_num</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="NonLinearMonitor.from_scratch-477"><a href="#NonLinearMonitor.from_scratch-477"><span class="linenos">477</span></a>        <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_iter_crit</span>
</span><span id="NonLinearMonitor.from_scratch-478"><a href="#NonLinearMonitor.from_scratch-478"><span class="linenos">478</span></a>
</span><span id="NonLinearMonitor.from_scratch-479"><a href="#NonLinearMonitor.from_scratch-479"><span class="linenos">479</span></a>        <span class="c1"># Fill in all other criteria</span>
</span><span id="NonLinearMonitor.from_scratch-480"><a href="#NonLinearMonitor.from_scratch-480"><span class="linenos">480</span></a>        <span class="n">criteria</span> <span class="o">=</span> <span class="n">args_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;criteria&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="NonLinearMonitor.from_scratch-481"><a href="#NonLinearMonitor.from_scratch-481"><span class="linenos">481</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_check_criteria_input</span><span class="p">(</span><span class="n">criteria</span><span class="p">)</span>
</span><span id="NonLinearMonitor.from_scratch-482"><a href="#NonLinearMonitor.from_scratch-482"><span class="linenos">482</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria</span><span class="p">:</span>
</span><span id="NonLinearMonitor.from_scratch-483"><a href="#NonLinearMonitor.from_scratch-483"><span class="linenos">483</span></a>            <span class="n">name</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor.from_scratch-484"><a href="#NonLinearMonitor.from_scratch-484"><span class="linenos">484</span></a>            <span class="n">threshold</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor.from_scratch-485"><a href="#NonLinearMonitor.from_scratch-485"><span class="linenos">485</span></a>            <span class="n">active</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor.from_scratch-486"><a href="#NonLinearMonitor.from_scratch-486"><span class="linenos">486</span></a>            <span class="n">look</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;look&#39;</span><span class="p">,</span> <span class="n">active</span><span class="p">)</span>
</span><span id="NonLinearMonitor.from_scratch-487"><a href="#NonLinearMonitor.from_scratch-487"><span class="linenos">487</span></a>            <span class="n">crit</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">criteria_class_dict</span><span class="p">[</span><span class="n">name</span><span class="p">](</span><span class="n">threshold</span><span class="p">,</span> <span class="n">look</span><span class="p">,</span> <span class="n">active</span><span class="p">)</span>
</span><span id="NonLinearMonitor.from_scratch-488"><a href="#NonLinearMonitor.from_scratch-488"><span class="linenos">488</span></a>            <span class="n">monitor</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
</span><span id="NonLinearMonitor.from_scratch-489"><a href="#NonLinearMonitor.from_scratch-489"><span class="linenos">489</span></a>
</span><span id="NonLinearMonitor.from_scratch-490"><a href="#NonLinearMonitor.from_scratch-490"><span class="linenos">490</span></a>        <span class="k">return</span> <span class="n">monitor</span>
</span></pre></div>


            <div class="docstring"><p>Create an instance of <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> and set its attributes using
the user provided <code>args_dict</code>, which contains the following items:</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>minimum_iter_num</strong> (int):
Minimum number of iterations to be completed (lower threshold).</li>
<li><strong>maximum_iter_num</strong> (int):
Maximum number of iterations to be completed (upper threshold).</li>
<li><strong>criteria</strong> (Tuple[dict]):
Tuple of dictionaries. Each dictionary corresponds to a given
criterion, with keys
    - 'name': the name of the criterion
    - 'threshold': the criterion's threshold
    - 'look': Whether the criterion should be evaluated
    - 'active': Whether the criterion is involved in the
    decision-making process for stopping the algorithm</li>
</ul>

<h6 id="notes">Notes</h6>

<p>Sometimes, one may want to evaluate a given criterion to get more
information about the current state of the iterations without making
the stopping of the algorithm dependent on it. This 'information only'
mode is achieved by specifying ('active' = False, 'look' = True).
On the other hand, if a given criterion is set active, it will
automatically be evaluated, regardless of the 'look' setting.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>monitor</strong> (NonLinearMonitor):
The created NonLinearMonitor.</li>
</ul>
</div>


                            </div>
                            <div id="NonLinearMonitor.display_criteria_info" class="classattr">
                                        <input id="NonLinearMonitor.display_criteria_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_criteria_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">cols</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NonLinearMonitor.display_criteria_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.display_criteria_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.display_criteria_info-492"><a href="#NonLinearMonitor.display_criteria_info-492"><span class="linenos">492</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_criteria_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">cols</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
</span><span id="NonLinearMonitor.display_criteria_info-493"><a href="#NonLinearMonitor.display_criteria_info-493"><span class="linenos">493</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.display_criteria_info-494"><a href="#NonLinearMonitor.display_criteria_info-494"><span class="linenos">494</span></a><span class="sd">        Display information regarding the registered criteria in</span>
</span><span id="NonLinearMonitor.display_criteria_info-495"><a href="#NonLinearMonitor.display_criteria_info-495"><span class="linenos">495</span></a><span class="sd">        `self.criteria`.</span>
</span><span id="NonLinearMonitor.display_criteria_info-496"><a href="#NonLinearMonitor.display_criteria_info-496"><span class="linenos">496</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-497"><a href="#NonLinearMonitor.display_criteria_info-497"><span class="linenos">497</span></a><span class="sd">        Parameters</span>
</span><span id="NonLinearMonitor.display_criteria_info-498"><a href="#NonLinearMonitor.display_criteria_info-498"><span class="linenos">498</span></a><span class="sd">        ----------</span>
</span><span id="NonLinearMonitor.display_criteria_info-499"><a href="#NonLinearMonitor.display_criteria_info-499"><span class="linenos">499</span></a><span class="sd">        cols : Tuple[str]</span>
</span><span id="NonLinearMonitor.display_criteria_info-500"><a href="#NonLinearMonitor.display_criteria_info-500"><span class="linenos">500</span></a><span class="sd">            Keys for displayed information (see `valid_entries` in function</span>
</span><span id="NonLinearMonitor.display_criteria_info-501"><a href="#NonLinearMonitor.display_criteria_info-501"><span class="linenos">501</span></a><span class="sd">            definition).</span>
</span><span id="NonLinearMonitor.display_criteria_info-502"><a href="#NonLinearMonitor.display_criteria_info-502"><span class="linenos">502</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-503"><a href="#NonLinearMonitor.display_criteria_info-503"><span class="linenos">503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.display_criteria_info-504"><a href="#NonLinearMonitor.display_criteria_info-504"><span class="linenos">504</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-505"><a href="#NonLinearMonitor.display_criteria_info-505"><span class="linenos">505</span></a>        <span class="c1"># Preset</span>
</span><span id="NonLinearMonitor.display_criteria_info-506"><a href="#NonLinearMonitor.display_criteria_info-506"><span class="linenos">506</span></a>        <span class="n">valid_entries</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="NonLinearMonitor.display_criteria_info-507"><a href="#NonLinearMonitor.display_criteria_info-507"><span class="linenos">507</span></a>            <span class="s1">&#39;criterion&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">,</span> <span class="s1">&#39;look&#39;</span><span class="p">,</span> <span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;threshold&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-508"><a href="#NonLinearMonitor.display_criteria_info-508"><span class="linenos">508</span></a>        <span class="n">actual_entries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="NonLinearMonitor.display_criteria_info-509"><a href="#NonLinearMonitor.display_criteria_info-509"><span class="linenos">509</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-510"><a href="#NonLinearMonitor.display_criteria_info-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="s1">&#39;criterion&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="NonLinearMonitor.display_criteria_info-511"><a href="#NonLinearMonitor.display_criteria_info-511"><span class="linenos">511</span></a>            <span class="n">cols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;criterion&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-512"><a href="#NonLinearMonitor.display_criteria_info-512"><span class="linenos">512</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="NonLinearMonitor.display_criteria_info-513"><a href="#NonLinearMonitor.display_criteria_info-513"><span class="linenos">513</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-514"><a href="#NonLinearMonitor.display_criteria_info-514"><span class="linenos">514</span></a>        <span class="n">criteria_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># shallow copy of dictionary</span>
</span><span id="NonLinearMonitor.display_criteria_info-515"><a href="#NonLinearMonitor.display_criteria_info-515"><span class="linenos">515</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="NonLinearMonitor.display_criteria_info-516"><a href="#NonLinearMonitor.display_criteria_info-516"><span class="linenos">516</span></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">crit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="NonLinearMonitor.display_criteria_info-517"><a href="#NonLinearMonitor.display_criteria_info-517"><span class="linenos">517</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crit</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="NonLinearMonitor.display_criteria_info-518"><a href="#NonLinearMonitor.display_criteria_info-518"><span class="linenos">518</span></a>                    <span class="n">criteria_copy</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-519"><a href="#NonLinearMonitor.display_criteria_info-519"><span class="linenos">519</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-520"><a href="#NonLinearMonitor.display_criteria_info-520"><span class="linenos">520</span></a>        <span class="c1"># Fill in data_dict</span>
</span><span id="NonLinearMonitor.display_criteria_info-521"><a href="#NonLinearMonitor.display_criteria_info-521"><span class="linenos">521</span></a>        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
</span><span id="NonLinearMonitor.display_criteria_info-522"><a href="#NonLinearMonitor.display_criteria_info-522"><span class="linenos">522</span></a>            <span class="k">assert</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">valid_entries</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Entry &#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">&#39; is not valid!&quot;</span>
</span><span id="NonLinearMonitor.display_criteria_info-523"><a href="#NonLinearMonitor.display_criteria_info-523"><span class="linenos">523</span></a>            <span class="n">actual_entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-524"><a href="#NonLinearMonitor.display_criteria_info-524"><span class="linenos">524</span></a>            <span class="n">entry_data_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="NonLinearMonitor.display_criteria_info-525"><a href="#NonLinearMonitor.display_criteria_info-525"><span class="linenos">525</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-526"><a href="#NonLinearMonitor.display_criteria_info-526"><span class="linenos">526</span></a>            <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="s1">&#39;criterion&#39;</span><span class="p">:</span>
</span><span id="NonLinearMonitor.display_criteria_info-527"><a href="#NonLinearMonitor.display_criteria_info-527"><span class="linenos">527</span></a>                <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria_copy</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor.display_criteria_info-528"><a href="#NonLinearMonitor.display_criteria_info-528"><span class="linenos">528</span></a>                    <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-529"><a href="#NonLinearMonitor.display_criteria_info-529"><span class="linenos">529</span></a>                <span class="n">data_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_data_list</span>
</span><span id="NonLinearMonitor.display_criteria_info-530"><a href="#NonLinearMonitor.display_criteria_info-530"><span class="linenos">530</span></a>                <span class="k">continue</span>
</span><span id="NonLinearMonitor.display_criteria_info-531"><a href="#NonLinearMonitor.display_criteria_info-531"><span class="linenos">531</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-532"><a href="#NonLinearMonitor.display_criteria_info-532"><span class="linenos">532</span></a>            <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">criteria_copy</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor.display_criteria_info-533"><a href="#NonLinearMonitor.display_criteria_info-533"><span class="linenos">533</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">value</span>
</span><span id="NonLinearMonitor.display_criteria_info-534"><a href="#NonLinearMonitor.display_criteria_info-534"><span class="linenos">534</span></a>                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
</span><span id="NonLinearMonitor.display_criteria_info-535"><a href="#NonLinearMonitor.display_criteria_info-535"><span class="linenos">535</span></a>                    <span class="k">if</span> <span class="n">entry</span> <span class="o">==</span> <span class="s1">&#39;value&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
</span><span id="NonLinearMonitor.display_criteria_info-536"><a href="#NonLinearMonitor.display_criteria_info-536"><span class="linenos">536</span></a>                        <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-537"><a href="#NonLinearMonitor.display_criteria_info-537"><span class="linenos">537</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="NonLinearMonitor.display_criteria_info-538"><a href="#NonLinearMonitor.display_criteria_info-538"><span class="linenos">538</span></a>                        <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">entry</span><span class="p">))</span>
</span><span id="NonLinearMonitor.display_criteria_info-539"><a href="#NonLinearMonitor.display_criteria_info-539"><span class="linenos">539</span></a>                <span class="k">elif</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>
</span><span id="NonLinearMonitor.display_criteria_info-540"><a href="#NonLinearMonitor.display_criteria_info-540"><span class="linenos">540</span></a>                    <span class="n">entry_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="n">entry</span><span class="p">])</span>
</span><span id="NonLinearMonitor.display_criteria_info-541"><a href="#NonLinearMonitor.display_criteria_info-541"><span class="linenos">541</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="NonLinearMonitor.display_criteria_info-542"><a href="#NonLinearMonitor.display_criteria_info-542"><span class="linenos">542</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot find entry &#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-543"><a href="#NonLinearMonitor.display_criteria_info-543"><span class="linenos">543</span></a>                <span class="n">data_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_data_list</span>
</span><span id="NonLinearMonitor.display_criteria_info-544"><a href="#NonLinearMonitor.display_criteria_info-544"><span class="linenos">544</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-545"><a href="#NonLinearMonitor.display_criteria_info-545"><span class="linenos">545</span></a>        <span class="c1"># Create pandas DataFrame and sort the columns</span>
</span><span id="NonLinearMonitor.display_criteria_info-546"><a href="#NonLinearMonitor.display_criteria_info-546"><span class="linenos">546</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-547"><a href="#NonLinearMonitor.display_criteria_info-547"><span class="linenos">547</span></a>        <span class="n">sort_key_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">valid_entries</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">actual_entries</span><span class="p">]</span>
</span><span id="NonLinearMonitor.display_criteria_info-548"><a href="#NonLinearMonitor.display_criteria_info-548"><span class="linenos">548</span></a>        <span class="n">sorted_zip</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sort_key_list</span><span class="p">,</span> <span class="n">actual_entries</span><span class="p">))</span>
</span><span id="NonLinearMonitor.display_criteria_info-549"><a href="#NonLinearMonitor.display_criteria_info-549"><span class="linenos">549</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">actual_entries</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">sorted_zip</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-550"><a href="#NonLinearMonitor.display_criteria_info-550"><span class="linenos">550</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">actual_entries</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-551"><a href="#NonLinearMonitor.display_criteria_info-551"><span class="linenos">551</span></a>
</span><span id="NonLinearMonitor.display_criteria_info-552"><a href="#NonLinearMonitor.display_criteria_info-552"><span class="linenos">552</span></a>        <span class="c1"># Display information</span>
</span><span id="NonLinearMonitor.display_criteria_info-553"><a href="#NonLinearMonitor.display_criteria_info-553"><span class="linenos">553</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_dataframe_string_iter</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_criteria_info-554"><a href="#NonLinearMonitor.display_criteria_info-554"><span class="linenos">554</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">output_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Display information regarding the registered criteria in
<code>self.criteria</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cols</strong> (Tuple[str]):
Keys for displayed information (see <code>valid_entries</code> in function
definition).</li>
</ul>
</div>


                            </div>
                            <div id="NonLinearMonitor.display_iterations_report" class="classattr">
                                        <input id="NonLinearMonitor.display_iterations_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">display_iterations_report</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NonLinearMonitor.display_iterations_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.display_iterations_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.display_iterations_report-556"><a href="#NonLinearMonitor.display_iterations_report-556"><span class="linenos">556</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">display_iterations_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor.display_iterations_report-557"><a href="#NonLinearMonitor.display_iterations_report-557"><span class="linenos">557</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.display_iterations_report-558"><a href="#NonLinearMonitor.display_iterations_report-558"><span class="linenos">558</span></a><span class="sd">        Display criteria&#39;s value for all iterations.</span>
</span><span id="NonLinearMonitor.display_iterations_report-559"><a href="#NonLinearMonitor.display_iterations_report-559"><span class="linenos">559</span></a>
</span><span id="NonLinearMonitor.display_iterations_report-560"><a href="#NonLinearMonitor.display_iterations_report-560"><span class="linenos">560</span></a><span class="sd">        Notes</span>
</span><span id="NonLinearMonitor.display_iterations_report-561"><a href="#NonLinearMonitor.display_iterations_report-561"><span class="linenos">561</span></a><span class="sd">        -----</span>
</span><span id="NonLinearMonitor.display_iterations_report-562"><a href="#NonLinearMonitor.display_iterations_report-562"><span class="linenos">562</span></a><span class="sd">        The criteria considered here are those for which the `value` field is a</span>
</span><span id="NonLinearMonitor.display_iterations_report-563"><a href="#NonLinearMonitor.display_iterations_report-563"><span class="linenos">563</span></a><span class="sd">        number.</span>
</span><span id="NonLinearMonitor.display_iterations_report-564"><a href="#NonLinearMonitor.display_iterations_report-564"><span class="linenos">564</span></a>
</span><span id="NonLinearMonitor.display_iterations_report-565"><a href="#NonLinearMonitor.display_iterations_report-565"><span class="linenos">565</span></a><span class="sd">        todo: remove the NaN when the iterations stop before &#39;maximum_iter_num&#39;</span>
</span><span id="NonLinearMonitor.display_iterations_report-566"><a href="#NonLinearMonitor.display_iterations_report-566"><span class="linenos">566</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.display_iterations_report-567"><a href="#NonLinearMonitor.display_iterations_report-567"><span class="linenos">567</span></a>
</span><span id="NonLinearMonitor.display_iterations_report-568"><a href="#NonLinearMonitor.display_iterations_report-568"><span class="linenos">568</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NonLinearMonitor.display_iterations_report-569"><a href="#NonLinearMonitor.display_iterations_report-569"><span class="linenos">569</span></a>            <span class="s1">&#39;iter&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maximum_iter_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span>
</span><span id="NonLinearMonitor.display_iterations_report-570"><a href="#NonLinearMonitor.display_iterations_report-570"><span class="linenos">570</span></a>        <span class="p">}</span>
</span><span id="NonLinearMonitor.display_iterations_report-571"><a href="#NonLinearMonitor.display_iterations_report-571"><span class="linenos">571</span></a>
</span><span id="NonLinearMonitor.display_iterations_report-572"><a href="#NonLinearMonitor.display_iterations_report-572"><span class="linenos">572</span></a>        <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor.display_iterations_report-573"><a href="#NonLinearMonitor.display_iterations_report-573"><span class="linenos">573</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crit</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span> <span class="ow">or</span> \
</span><span id="NonLinearMonitor.display_iterations_report-574"><a href="#NonLinearMonitor.display_iterations_report-574"><span class="linenos">574</span></a>                    <span class="n">crit</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MaximumIterations&#39;</span><span class="p">:</span>
</span><span id="NonLinearMonitor.display_iterations_report-575"><a href="#NonLinearMonitor.display_iterations_report-575"><span class="linenos">575</span></a>                <span class="k">continue</span>
</span><span id="NonLinearMonitor.display_iterations_report-576"><a href="#NonLinearMonitor.display_iterations_report-576"><span class="linenos">576</span></a>            <span class="n">data_dict</span><span class="p">[</span><span class="n">crit</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="NonLinearMonitor.display_iterations_report-577"><a href="#NonLinearMonitor.display_iterations_report-577"><span class="linenos">577</span></a>                <span class="n">crit</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="n">crit</span><span class="o">.</span><span class="n">threshold</span><span class="p">]</span>
</span><span id="NonLinearMonitor.display_iterations_report-578"><a href="#NonLinearMonitor.display_iterations_report-578"><span class="linenos">578</span></a>
</span><span id="NonLinearMonitor.display_iterations_report-579"><a href="#NonLinearMonitor.display_iterations_report-579"><span class="linenos">579</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_iterations_report-580"><a href="#NonLinearMonitor.display_iterations_report-580"><span class="linenos">580</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;iter&#39;</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_iterations_report-581"><a href="#NonLinearMonitor.display_iterations_report-581"><span class="linenos">581</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_iter_num</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span>
</span><span id="NonLinearMonitor.display_iterations_report-582"><a href="#NonLinearMonitor.display_iterations_report-582"><span class="linenos">582</span></a>                <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_iterations_report-583"><a href="#NonLinearMonitor.display_iterations_report-583"><span class="linenos">583</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="s1">&#39;__&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_iterations_report-584"><a href="#NonLinearMonitor.display_iterations_report-584"><span class="linenos">584</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_dataframe_string_report</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="NonLinearMonitor.display_iterations_report-585"><a href="#NonLinearMonitor.display_iterations_report-585"><span class="linenos">585</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">output_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Display criteria's value for all iterations.</p>

<h6 id="notes">Notes</h6>

<p>The criteria considered here are those for which the <code>value</code> field is a
number.</p>

<p>todo: remove the NaN when the iterations stop before 'maximum_iter_num'</p>
</div>


                            </div>
                            <div id="NonLinearMonitor.link_monitor_to_solver" class="classattr">
                                        <input id="NonLinearMonitor.link_monitor_to_solver-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">link_monitor_to_solver</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nl_solver</span><span class="p">:</span> <span class="n"><a href="solvers.html#NonLinearSolver">femtoscope.core.solvers.NonLinearSolver</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NonLinearMonitor.link_monitor_to_solver-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.link_monitor_to_solver"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.link_monitor_to_solver-587"><a href="#NonLinearMonitor.link_monitor_to_solver-587"><span class="linenos">587</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">link_monitor_to_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nl_solver</span><span class="p">:</span> <span class="s2">&quot;NonLinearSolver&quot;</span><span class="p">):</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-588"><a href="#NonLinearMonitor.link_monitor_to_solver-588"><span class="linenos">588</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-589"><a href="#NonLinearMonitor.link_monitor_to_solver-589"><span class="linenos">589</span></a><span class="sd">        Link the current `NonLinearMonitor` instance to a given</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-590"><a href="#NonLinearMonitor.link_monitor_to_solver-590"><span class="linenos">590</span></a><span class="sd">        `NonLinearSolver` instance. This link is two-way in the sense that the</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-591"><a href="#NonLinearMonitor.link_monitor_to_solver-591"><span class="linenos">591</span></a><span class="sd">        two class instances hold themselves as attributes.</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-592"><a href="#NonLinearMonitor.link_monitor_to_solver-592"><span class="linenos">592</span></a>
</span><span id="NonLinearMonitor.link_monitor_to_solver-593"><a href="#NonLinearMonitor.link_monitor_to_solver-593"><span class="linenos">593</span></a><span class="sd">        Parameters</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-594"><a href="#NonLinearMonitor.link_monitor_to_solver-594"><span class="linenos">594</span></a><span class="sd">        ----------</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-595"><a href="#NonLinearMonitor.link_monitor_to_solver-595"><span class="linenos">595</span></a><span class="sd">        nl_solver : NonLinearSolver</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-596"><a href="#NonLinearMonitor.link_monitor_to_solver-596"><span class="linenos">596</span></a><span class="sd">            Instance of the class `NonLinearSolver` to be monitored.</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-597"><a href="#NonLinearMonitor.link_monitor_to_solver-597"><span class="linenos">597</span></a>
</span><span id="NonLinearMonitor.link_monitor_to_solver-598"><a href="#NonLinearMonitor.link_monitor_to_solver-598"><span class="linenos">598</span></a><span class="sd">        Notes</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-599"><a href="#NonLinearMonitor.link_monitor_to_solver-599"><span class="linenos">599</span></a><span class="sd">        -----</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-600"><a href="#NonLinearMonitor.link_monitor_to_solver-600"><span class="linenos">600</span></a><span class="sd">        One can either link with the present function, or equivalently with</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-601"><a href="#NonLinearMonitor.link_monitor_to_solver-601"><span class="linenos">601</span></a><span class="sd">        `NonLinearSolver.link_solver_to_monitor`.</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-602"><a href="#NonLinearMonitor.link_monitor_to_solver-602"><span class="linenos">602</span></a>
</span><span id="NonLinearMonitor.link_monitor_to_solver-603"><a href="#NonLinearMonitor.link_monitor_to_solver-603"><span class="linenos">603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-604"><a href="#NonLinearMonitor.link_monitor_to_solver-604"><span class="linenos">604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nonlinear_solver</span> <span class="o">=</span> <span class="n">nl_solver</span>
</span><span id="NonLinearMonitor.link_monitor_to_solver-605"><a href="#NonLinearMonitor.link_monitor_to_solver-605"><span class="linenos">605</span></a>        <span class="n">nl_solver</span><span class="o">.</span><span class="n">nonlinear_monitor</span> <span class="o">=</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Link the current <code><a href="#NonLinearMonitor">NonLinearMonitor</a></code> instance to a given
<code>NonLinearSolver</code> instance. This link is two-way in the sense that the
two class instances hold themselves as attributes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nl_solver</strong> (NonLinearSolver):
Instance of the class <code>NonLinearSolver</code> to be monitored.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>One can either link with the present function, or equivalently with
<code>NonLinearSolver.link_solver_to_monitor</code>.</p>
</div>


                            </div>
                            <div id="NonLinearMonitor.update_status" class="classattr">
                                        <input id="NonLinearMonitor.update_status-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_status</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NonLinearMonitor.update_status-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.update_status"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.update_status-607"><a href="#NonLinearMonitor.update_status-607"><span class="linenos">607</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor.update_status-608"><a href="#NonLinearMonitor.update_status-608"><span class="linenos">608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.update_status-609"><a href="#NonLinearMonitor.update_status-609"><span class="linenos">609</span></a><span class="sd">        Update the `stop` attribute based on the status of all active criteria.</span>
</span><span id="NonLinearMonitor.update_status-610"><a href="#NonLinearMonitor.update_status-610"><span class="linenos">610</span></a><span class="sd">        todo: in the future, it might be nice to have the possibility to</span>
</span><span id="NonLinearMonitor.update_status-611"><a href="#NonLinearMonitor.update_status-611"><span class="linenos">611</span></a><span class="sd">            combine several criteria together for determining whether to stop</span>
</span><span id="NonLinearMonitor.update_status-612"><a href="#NonLinearMonitor.update_status-612"><span class="linenos">612</span></a><span class="sd">            the algorithm</span>
</span><span id="NonLinearMonitor.update_status-613"><a href="#NonLinearMonitor.update_status-613"><span class="linenos">613</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.update_status-614"><a href="#NonLinearMonitor.update_status-614"><span class="linenos">614</span></a>        <span class="c1"># Check if one criterion has been met</span>
</span><span id="NonLinearMonitor.update_status-615"><a href="#NonLinearMonitor.update_status-615"><span class="linenos">615</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_iter_num</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_iter_num</span><span class="p">:</span>
</span><span id="NonLinearMonitor.update_status-616"><a href="#NonLinearMonitor.update_status-616"><span class="linenos">616</span></a>            <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor.update_status-617"><a href="#NonLinearMonitor.update_status-617"><span class="linenos">617</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]:</span>
</span><span id="NonLinearMonitor.update_status-618"><a href="#NonLinearMonitor.update_status-618"><span class="linenos">618</span></a>                    <span class="k">continue</span>
</span><span id="NonLinearMonitor.update_status-619"><a href="#NonLinearMonitor.update_status-619"><span class="linenos">619</span></a>                <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]:</span>
</span><span id="NonLinearMonitor.update_status-620"><a href="#NonLinearMonitor.update_status-620"><span class="linenos">620</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="NonLinearMonitor.update_status-621"><a href="#NonLinearMonitor.update_status-621"><span class="linenos">621</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_fill_history_holes_with_none</span><span class="p">()</span>
</span><span id="NonLinearMonitor.update_status-622"><a href="#NonLinearMonitor.update_status-622"><span class="linenos">622</span></a>                    <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>Update the <code><a href="#NonLinearMonitor.stop">stop</a></code> attribute based on the status of all active criteria.
todo: in the future, it might be nice to have the possibility to
    combine several criteria together for determining whether to stop
    the algorithm</p>
</div>


                            </div>
                            <div id="NonLinearMonitor.write_termination_status" class="classattr">
                                        <input id="NonLinearMonitor.write_termination_status-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_termination_status</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NonLinearMonitor.write_termination_status-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.write_termination_status"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.write_termination_status-624"><a href="#NonLinearMonitor.write_termination_status-624"><span class="linenos">624</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_termination_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor.write_termination_status-625"><a href="#NonLinearMonitor.write_termination_status-625"><span class="linenos">625</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the termination message associated with the criterion that has</span>
</span><span id="NonLinearMonitor.write_termination_status-626"><a href="#NonLinearMonitor.write_termination_status-626"><span class="linenos">626</span></a><span class="sd">        been met.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.write_termination_status-627"><a href="#NonLinearMonitor.write_termination_status-627"><span class="linenos">627</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor.write_termination_status-628"><a href="#NonLinearMonitor.write_termination_status-628"><span class="linenos">628</span></a>            <span class="k">if</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]:</span>
</span><span id="NonLinearMonitor.write_termination_status-629"><a href="#NonLinearMonitor.write_termination_status-629"><span class="linenos">629</span></a>                <span class="n">criterion</span><span class="o">.</span><span class="n">write_stop_message</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Print the termination message associated with the criterion that has
been met.</p>
</div>


                            </div>
                            <div id="NonLinearMonitor.evaluate_all_criteria" class="classattr">
                                        <input id="NonLinearMonitor.evaluate_all_criteria-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">evaluate_all_criteria</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NonLinearMonitor.evaluate_all_criteria-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.evaluate_all_criteria"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.evaluate_all_criteria-631"><a href="#NonLinearMonitor.evaluate_all_criteria-631"><span class="linenos">631</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_all_criteria</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor.evaluate_all_criteria-632"><a href="#NonLinearMonitor.evaluate_all_criteria-632"><span class="linenos">632</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate all criteria registered in `self.criteria`.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.evaluate_all_criteria-633"><a href="#NonLinearMonitor.evaluate_all_criteria-633"><span class="linenos">633</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sorted_criteria_list</span><span class="p">():</span>
</span><span id="NonLinearMonitor.evaluate_all_criteria-634"><a href="#NonLinearMonitor.evaluate_all_criteria-634"><span class="linenos">634</span></a>            <span class="n">status</span> <span class="o">=</span> <span class="n">criterion</span><span class="o">.</span><span class="n">status</span>
</span><span id="NonLinearMonitor.evaluate_all_criteria-635"><a href="#NonLinearMonitor.evaluate_all_criteria-635"><span class="linenos">635</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;look&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]:</span>
</span><span id="NonLinearMonitor.evaluate_all_criteria-636"><a href="#NonLinearMonitor.evaluate_all_criteria-636"><span class="linenos">636</span></a>                <span class="k">continue</span>
</span><span id="NonLinearMonitor.evaluate_all_criteria-637"><a href="#NonLinearMonitor.evaluate_all_criteria-637"><span class="linenos">637</span></a>            <span class="n">criterion</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Evaluate all criteria registered in <code>self.criteria</code>.</p>
</div>


                            </div>
                            <div id="NonLinearMonitor.disable_all_criteria" class="classattr">
                                        <input id="NonLinearMonitor.disable_all_criteria-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">disable_all_criteria</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NonLinearMonitor.disable_all_criteria-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NonLinearMonitor.disable_all_criteria"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NonLinearMonitor.disable_all_criteria-639"><a href="#NonLinearMonitor.disable_all_criteria-639"><span class="linenos">639</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">disable_all_criteria</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NonLinearMonitor.disable_all_criteria-640"><a href="#NonLinearMonitor.disable_all_criteria-640"><span class="linenos">640</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set `active=False` for all criteria but &#39;MaximumIterations&#39;.&quot;&quot;&quot;</span>
</span><span id="NonLinearMonitor.disable_all_criteria-641"><a href="#NonLinearMonitor.disable_all_criteria-641"><span class="linenos">641</span></a>        <span class="k">for</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="NonLinearMonitor.disable_all_criteria-642"><a href="#NonLinearMonitor.disable_all_criteria-642"><span class="linenos">642</span></a>            <span class="n">criterion</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="NonLinearMonitor.disable_all_criteria-643"><a href="#NonLinearMonitor.disable_all_criteria-643"><span class="linenos">643</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">criteria</span><span class="p">[</span><span class="s1">&#39;MaximumIterations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Set <code>active=False</code> for all criteria but 'MaximumIterations'.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>