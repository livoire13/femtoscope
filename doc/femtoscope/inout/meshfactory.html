<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>femtoscope.inout.meshfactory API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../inout.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;femtoscope.inout</a>

            <img src="file://C:/Users/ericd/Desktop/femtoscope/femtoscope/images/logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#MeshingTools">MeshingTools</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MeshingTools.__init__">MeshingTools</a>
                        </li>
                        <li>
                                <a class="class" href="#MeshingTools.Decorators">MeshingTools.Decorators</a>
                                        <ul class="memberlist">
                                    <li>
                                            <a class="function" href="#MeshingTools.Decorators.check_dimension">check_dimension</a>
                                    </li>
                            </ul>

                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.dim">dim</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.Rcut">Rcut</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.boundaries">boundaries</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.sources">sources</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.refinement_settings">refinement_settings</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.number_sources">number_sources</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.number_boundaries">number_boundaries</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.min_length">min_length</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshingTools.geom">geom</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.open_gmsh">open_gmsh</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.close_gmsh">close_gmsh</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.generate_mesh">generate_mesh</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_subdomain">create_subdomain</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_inversed_exterior_domain_3d">create_inversed_exterior_domain_3d</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_ellipse">create_ellipse</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_rectangle">create_rectangle</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_disk_from_pts">create_disk_from_pts</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.points_to_surface">points_to_surface</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_ellipsoid">create_ellipsoid</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_box">create_box</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_cylinder">create_cylinder</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.create_torus">create_torus</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.points_to_volume">points_to_volume</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.rectangle_cutout">rectangle_cutout</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.radial_cutoff">radial_cutoff</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.add_shapes">add_shapes</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.subtract_shapes">subtract_shapes</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.intersect_shapes">intersect_shapes</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.non_intersect_shapes">non_intersect_shapes</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.rotate">rotate</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshingTools.translate">translate</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#generate_mesh_from_geo">generate_mesh_from_geo</a>
            </li>
            <li>
                    <a class="function" href="#convert_mesh_for_sfepy">convert_mesh_for_sfepy</a>
            </li>
            <li>
                    <a class="function" href="#adjust_boundary_nodes">adjust_boundary_nodes</a>
            </li>
            <li>
                    <a class="function" href="#split_spheres_from_mesh">split_spheres_from_mesh</a>
            </li>
            <li>
                    <a class="function" href="#make_absolute_mesh_name">make_absolute_mesh_name</a>
            </li>
            <li>
                    <a class="function" href="#make_absolute_geo_name">make_absolute_geo_name</a>
            </li>
            <li>
                    <a class="function" href="#read_Rcut_from_mesh_file">read_Rcut_from_mesh_file</a>
            </li>
            <li>
                    <a class="function" href="#read_dimension_from_mesh_file">read_dimension_from_mesh_file</a>
            </li>
            <li>
                    <a class="function" href="#read_physical_groups_from_mesh_file">read_physical_groups_from_mesh_file</a>
            </li>
            <li>
                    <a class="function" href="#generate_uniform_1d_mesh">generate_uniform_1d_mesh</a>
            </li>
            <li>
                    <a class="function" href="#generate_1d_mesh_from_array">generate_1d_mesh_from_array</a>
            </li>
    </ul>


            <footer>Hugo LÃ©vy PhD Thesis</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../femtoscope.html">femtoscope</a><wbr>.<a href="./../inout.html">inout</a><wbr>.meshfactory    </h1>

                        <div class="docstring"><p>Created on Fri Feb  2 13:59:06 2024
Module dedicated to the creation and manipulation of Gmsh meshes (&amp; more!).</p>
</div>

                        <input id="mod-meshfactory-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-meshfactory-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">Created on Fri Feb  2 13:59:06 2024</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">Module dedicated to the creation and manipulation of Gmsh meshes (&amp; more!).</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">inspect</span><span class="w"> </span><span class="kn">import</span> <span class="n">cleandoc</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">gmsh</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">meshio</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">pi</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sfepy.base.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">output</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">sfepy.discrete.fem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mesh</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">femtoscope</span><span class="w"> </span><span class="kn">import</span> <span class="n">MESH_DIR</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">femtoscope.misc.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">numpyit</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MeshingTools</span><span class="p">:</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="sd">    Construct and manipulate user-defined meshes through the Gmsh Python API.</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">    Gmsh Python API is initialized when the class is instantiated.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd">    Following Gmsh&#39;s terminology, a dimTag is a pair of integers (dim, tag) and</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd">    a dimTags is a list of several dimTag.</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">    Attributes</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="sd">    ----------</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">    dim : int</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd">        Dimension of the mesh, 2 or 3.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">    Rcut : float</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="sd">        Truncation radius of the mesh.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd">    boundaries : list</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="sd">        List of dimTags representing boundary shapes of dimension `dim`-1.</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">    sources : list</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">        List of dimTags representing source shapes of dimension `dim`.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">    refinement_settings : list</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">        List of mesh refinement settings (see `create_subdomain` method), one</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">        per source shape.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">    number_sources : int</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">        Number of source shapes currently defined in the Gmsh model.</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">    number_boundaries : int</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">        Number of boundary shapes currently defined in the Gmsh model.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">    min_length : float</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">        Minimum distance between neighbouring points.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">    geom : class gmsh.model.occ</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">        Shortcut.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Decorators</span><span class="p">:</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Inner class for defining decorators.&quot;&quot;&quot;</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>        <span class="nd">@staticmethod</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">check_dimension</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Decorator for checking that the current `MeshingTools` instance</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">            has its dimension set to `dim`.&quot;&quot;&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>            <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>                <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>            <span class="k">return</span> <span class="n">decorator</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Rcut</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">        Parameters</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">        ----------</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">        dimension : int</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">            Dimension of the mesh, 2 or 3.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">        Rcut : float, optional</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">            Truncation radius of the mesh. The default is None.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>        <span class="c1"># Check dimension</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>        <span class="k">assert</span> <span class="n">dimension</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;Dimension should be 2 or 3.&quot;</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>        <span class="c1"># Set attributes</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dimension</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Rcut</span> <span class="o">=</span> <span class="n">Rcut</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span> <span class="o">=</span> <span class="mf">1.3e-6</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">occ</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>        <span class="c1"># open gmsh</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_gmsh</span><span class="p">()</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_gmsh</span><span class="p">():</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Gmsh Python API.&quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;General.Verbosity&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">close_gmsh</span><span class="p">():</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;To be called when one is done using the Gmsh Python API.&quot;&quot;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">        Generate the mesh and save it.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">        Parameters</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">        ----------</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">        mesh_name : str</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">            Name of the mesh file to be created. If not specified as an absolute</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">            path name, will be stored in the `MESH_DIR` directory.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">        show_mesh : bool, optional</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">            Open the Gmsh graphical user interface to inspect the mesh.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a><span class="sd">            The default is False.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">        Other Parameters</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">        ----------------</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">        ignored_tags : list, optional</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">            List of physical groups not to be included in the final .vtk file.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">            The default is [].</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">        convert : bool, optional</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">            Convert the .vtk mesh file created by Gmsh into a .vtk file readable</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">            by Sfepy. The default is True.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">        embed_origin : bool, optional</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">            Force the embedding of the origin (i.e. point of coordinates x=0,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">            y=0, [z=0]) into the mesh. The default is False.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">        origin_rf : list, optional</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">            Settings for refinement around the origin, namely</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">            [size_min, size_max, dist_min, dist_max].</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">            The default is [1e-2, 1e-1, 0.1, 1.0].</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">        unique_boundary_tags : bool, optional</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">            Assign a single physical group will be created for all elementary</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">            entities that are parts of a shape&#39;s boundary. The default is True.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">        cylindrical_symmetry : bool, optional</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">            Whether the 2D mesh corresponds to a cylindrically symmetric</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">            problem. The default is False.</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">        verbose : bool, optional</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="sd">            The default is False.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="sd">        Returns</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">        -------</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">        mesh_path_name : str</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">            Absolute path name of the created mesh file.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>        <span class="c1"># Get keyword arguments</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>        <span class="n">ignored_tags</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ignored_tags&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>        <span class="n">convert</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;convert&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="n">embed_origin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;embed_origin&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>        <span class="n">origin_rf</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;origin_rf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="n">unique_boundary_tags</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unique_boundary_tags&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="n">cylindrical_symmetry</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cylindrical_symmetry&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>        <span class="n">origin_tag</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_subdomain</span><span class="p">()</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>        <span class="k">if</span> <span class="n">cylindrical_symmetry</span><span class="p">:</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_cylindrical_symmetry</span><span class="p">()</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>            <span class="n">origin_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>        <span class="c1"># Refinement settings</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_refinement_settings</span><span class="p">(</span><span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>  <span class="c1"># Force the embedding of the origin to the mesh</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>            <span class="n">is_on_curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cylindrical_symmetry</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_embed_origin_to_mesh</span><span class="p">(</span><span class="n">origin_tag</span><span class="p">,</span> <span class="n">is_on_curve</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>        <span class="c1"># Assign physical groups</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assign_physical_groups</span><span class="p">(</span><span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>                                     <span class="n">unique_boundary_tags</span><span class="p">)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>        <span class="c1"># Actual mesh generation</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">removeDuplicateNodes</span><span class="p">()</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>        <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Inspect the log:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>            <span class="n">log</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logger has recorded </span><span class="si">{}</span><span class="s2"> lines&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">log</span><span class="p">)))</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="k">if</span> <span class="n">show_mesh</span><span class="p">:</span>  <span class="c1"># open Gmsh graphical interface</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>        <span class="k">return</span> <span class="n">mesh_path_name</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_subdomain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>                         <span class="n">cell_size_min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">cell_size_max</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>                         <span class="n">dist_min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dist_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>                         <span class="n">number_pts_per_curve</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">        Creates a subdomain from the shapes currently in an open gmsh window.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">        Shapes already present in previous subdomains will not be added to the</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">        new one. This subdomain will be labeled by an index value corresponding</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        to the next available integer value.</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        The size of mesh cells at distances less than &#39;DistMin&#39; from the</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">        boundary of this subdomain will be &#39;SizeMin&#39;, while at distances</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">        greater than &#39;DistMax&#39; cell size is &#39;SizeMax&#39;. Between &#39;DistMin&#39;</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">        and &#39;DistMax&#39; cell size will increase linearly.</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">        Parameters</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        ----------</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">        cell_size_min : float, optional</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">            Minimum size of the mesh cells. The default is 0.1.</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">        cell_size_max : float, optional</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a><span class="sd">            Maximum size of the mesh cells. The default is 0.1.</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="sd">        dist_min : float, optional</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">            At distances less than this value, the cell size is set to its</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">            minimum. The default is 0.0.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="sd">        dist_max : float, optional</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="sd">            At distances greater than this value, the cell size is set to its</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">            maximum. The default is 1.0.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">        number_pts_per_curve : int, optional</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">            Number of points used to define each curve. The default is 1000.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="c1"># Save sources, remove duplicates, and update the number of sources.</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">))</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span><span class="p">]</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>            <span class="c1"># Save boundary information</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span><span class="p">]</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>            <span class="c1"># Record refinement settings for this subdomain.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">cell_size_min</span><span class="p">,</span> <span class="n">cell_size_max</span><span class="p">,</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>                                             <span class="n">dist_min</span><span class="p">,</span> <span class="n">dist_max</span><span class="p">,</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>                                             <span class="n">number_pts_per_curve</span><span class="p">])</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># new entry is empty</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_inversed_exterior_domain_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">        Create a solid sphere whose surface DOFs match the last created shape</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">        boundary. Because the exterior mesh has to be spatially separated from</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">        all other geometries, its center of mass is set three radii away from</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="sd">        the interior domain along the x-axis.</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a><span class="sd">        Returns</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="sd">        -------</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a><span class="sd">        inversed_exterior_domain_3d : list</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">            List containing tuple representing the inversed exterior domain</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">            (which is a sphere).</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>        <span class="n">Rcut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Rcut</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>        <span class="k">if</span> <span class="n">Rcut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>            <span class="c1"># Retrieve Rc assuming the interior domain is spherical</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>            <span class="n">bb</span> <span class="o">=</span> <span class="n">numpyit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>            <span class="n">Rcut</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>            <span class="n">Rcut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Rcut</span><span class="p">))</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Rcut</span> <span class="o">=</span> <span class="n">Rcut</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>        <span class="c1"># Retrieve master boundary</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>        <span class="n">master_tags</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        <span class="c1"># create new shape</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="n">inversed_exterior_domain_3d</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>            <span class="n">xc</span><span class="o">=</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">Rcut</span><span class="p">))]</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="n">srf_tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getBoundary</span><span class="p">(</span><span class="n">inversed_exterior_domain_3d</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>        <span class="n">translation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setPeriodic</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">srf_tags</span><span class="p">,</span> <span class="n">master_tags</span><span class="p">,</span> <span class="n">translation</span><span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>        <span class="k">return</span> <span class="n">inversed_exterior_domain_3d</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_ellipse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a><span class="sd">        Create an ellipse with given semi-major axis / semi-minor axis and</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="sd">        center position.</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="sd">        Parameters</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">        ----------</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">        rx : float, optional</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">            Ellipse radial size along x-axis. The default is 0.1.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">        ry : float, optional</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">            Ellipse radial size along y-axis. The default is 0.1.</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">        xc : float, optional</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">            Ellipse center along x-axis. The default is 0.0.</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">        yc : float, optional</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">            Ellipse center along y-axis. The defautl is 0.0.</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">        Returns</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="sd">        -------</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">        ellipse : list</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">            List containing the ellipse dimTag.</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>        <span class="n">rx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rx</span><span class="p">))</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="n">ry</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ry</span><span class="p">))</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>        <span class="k">if</span> <span class="n">rx</span> <span class="o">&gt;=</span> <span class="n">ry</span><span class="p">:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>            <span class="n">ellipse</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>                                             <span class="n">rx</span><span class="o">=</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="n">ry</span><span class="p">))]</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>            <span class="n">ellipse</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>                                             <span class="n">rx</span><span class="o">=</span><span class="n">ry</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="n">rx</span><span class="p">))]</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ellipse</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>                             <span class="n">ax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="k">return</span> <span class="n">ellipse</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">xll</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yll</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">centered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>                         <span class="n">vperiodic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hperiodic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">        Create a rectangle specified by its side lengths and position.</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">        Parameters</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">        ----------</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">        dx : float, optional</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">            Length of rectangle along x-axis. The default is 1.0.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">        dy : float, optional</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">            Length of rectangle along y-axis. The default is 1.0.</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">        xll : float, optional</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">            Low left corner x-coordinate. The default is 0.0.</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a><span class="sd">        yll : float, optional</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">            Low left corner y-coordinate. The default is 0.0.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">        centered : bool, optional</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">            Whether the rectangle is origin-centered. If True, ignores keyword</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="sd">            parameters `xll` and `yll`. The default is False.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">        vperiodic : bool, optional</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">            Whether the mesh is periodic in the vertical direction.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">            The default is False.</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">        hperiodic : bool, optional</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">            Whether the mesh is periodic in the horizontal direction.</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">            The default is False.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">        Returns</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">        -------</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">        rectangle : list</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">            List containing the rectangle dimTag.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        <span class="n">dx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">))</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="n">dy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">))</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="k">if</span> <span class="n">centered</span><span class="p">:</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>            <span class="n">rectangle</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="n">dy</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>                                                    <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">))]</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>            <span class="n">rectangle</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xll</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yll</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>                                                    <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">))]</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>        <span class="n">tags</span> <span class="o">=</span> <span class="n">MeshingTools</span><span class="o">.</span><span class="n">_extract_tags</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>        <span class="k">if</span> <span class="n">vperiodic</span><span class="p">:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>            <span class="n">vtranslation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setPeriodic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">vtranslation</span><span class="p">)</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>        <span class="k">if</span> <span class="n">hperiodic</span><span class="p">:</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>            <span class="n">htranslation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setPeriodic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">htranslation</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="k">return</span> <span class="n">rectangle</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_disk_from_pts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">        @author: Hugo LÃ©vy</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">        Generates a disk with a given number of evenly spaced points across</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">        the circular boundary.</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a><span class="sd">        Parameters</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">        ----------</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">        radius : float</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">            Radius of the disk.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a><span class="sd">        N : int, optional</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a><span class="sd">            Number of points defining the boundary. The default is 100.</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">        Returns</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">        -------</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">        disk : list</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">            List containing the disk dimTag.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>        <span class="n">angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">N</span><span class="p">))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>        <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>        <span class="n">coors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>        <span class="n">disk</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points_to_surface</span><span class="p">(</span><span class="n">coors</span><span class="p">)]</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="k">return</span> <span class="n">disk</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">points_to_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points_list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">        Create a closed surface whose boundary is defined by a list of points.</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">        Parameters</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">        ----------</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">        points_list : list or ndarray</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a><span class="sd">            List containing the points which define the surface boundary.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">            Each element of the list is a triplet (x, y, z) corresponding to</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">            the coordinates of the point it represents.</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">        Returns</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">        -------</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">        surface_dimTag : tuple</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">            Tuple containing the dimension and tag (i.e. dimTag) of the</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">            created surface.</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&#39;points_list&#39; requires a minimum of 3 points.&quot;</span><span class="p">)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>        <span class="n">Pl</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>        <span class="n">Ll</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>        <span class="c1"># Set points.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points_list</span><span class="p">:</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>            <span class="n">Pl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>        <span class="c1"># Join points as lines.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points_list</span><span class="p">):</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>            <span class="n">Ll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">Pl</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Pl</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="c1"># Join lines as a closed loop and surface.</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="n">sf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">Ll</span><span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>        <span class="n">surface_dimTag</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="n">sf</span><span class="p">]))</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>        <span class="k">return</span> <span class="n">surface_dimTag</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_ellipsoid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>                         <span class="n">xc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a><span class="sd">        Create an ellipsoid specified by the length of its semi-axes.</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a><span class="sd">        Parameters</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a><span class="sd">        ----------</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a><span class="sd">        rx, ry, rz : float, optional</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a><span class="sd">            Ellipsoid radial size along (x, y, z)-axis. The default is 0.1.</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="sd">        xc, yc, zc : float, optional</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="sd">            Ellipsoid center along (x, y, z)-axis. The default is 0.0.</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a><span class="sd">        Returns</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a><span class="sd">        -------</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a><span class="sd">        ellipsoid : list</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="sd">            List containing the ellipsoid dimTag.</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>        <span class="n">rx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rx</span><span class="p">))</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>        <span class="n">ry</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ry</span><span class="p">))</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>        <span class="n">rz</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rz</span><span class="p">))</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="n">ellipsoid</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="n">zc</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">))]</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">zc</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">rx</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">ry</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">rz</span><span class="p">)</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>        <span class="k">return</span> <span class="n">ellipsoid</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">        Create a box specified by its side lengths and centered at the origin.</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">        Parameters</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="sd">        ----------</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">        dx, dy, dz : float, optional</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">            Length of box along (x, y, z)-axis. The default is 0.2.</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">        Returns</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a><span class="sd">        -------</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a><span class="sd">        box : list tuple</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="sd">            List containing the box dimTag.</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>        <span class="n">dx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">))</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="n">dy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">))</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>        <span class="n">dz</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dz</span><span class="p">))</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>        <span class="n">box</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addBox</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="n">dy</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="n">dz</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>                                    <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">))]</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="k">return</span> <span class="n">box</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_cylinder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a><span class="sd">        @author: Chad Briddon</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="sd">        Create a cylinder</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a><span class="sd">        Parameters</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a><span class="sd">        ----------</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a><span class="sd">        height : float, optional</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a><span class="sd">            Length of cylinder. The default is 0.1.</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a><span class="sd">        radius : float, optional</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a><span class="sd">            Radial size of cylinder. The default is 0.1.</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a><span class="sd">        Returns</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a><span class="sd">        -------</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a><span class="sd">        cylinder : list tuple</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="sd">            List containing the cylinder dimTag.</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">height</span><span class="p">))</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">radius</span><span class="p">))</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>        <span class="n">cylinder</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addCylinder</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>                                              <span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">))]</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="k">return</span> <span class="n">cylinder</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_torus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r_hole</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">r_tube</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a><span class="sd">        @author: Chad Briddon</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="sd">        Generates a torus in an open gmsh window with its centre of mass at</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">        the origin.</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a><span class="sd">        Parameters</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">        ----------</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a><span class="sd">        r_hole : float, optional</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">            Radius of hole through centre of the torus. The default is 0.1.</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a><span class="sd">        r_tube : float, optional</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="sd">            Radius of the torus tube. The default is 0.1.</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a><span class="sd">        Returns</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="sd">        -------</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="sd">        torus : list tuple</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a><span class="sd">            List containing the torus dimTag.</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>        <span class="n">r_hole</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r_hole</span><span class="p">))</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>        <span class="n">r_tube</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r_tube</span><span class="p">))</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>        <span class="n">torus</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addTorus</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>                                        <span class="n">r1</span><span class="o">=</span><span class="n">r_hole</span><span class="o">+</span><span class="n">r_tube</span><span class="p">,</span> <span class="n">r2</span><span class="o">=</span><span class="n">r_tube</span><span class="p">))]</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>        <span class="k">return</span> <span class="n">torus</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">points_to_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contour_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">        Creates a closed volume whose boundary is defined by list of contours.</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">        Parameters</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        ----------</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        contour_list : list</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">            List containing the contours which define the volume boundary. The</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">            contours are themselves a list whose elements are lists, each</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">            containing the x, y, and z coordinates of the point it represents.</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">        Returns</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">        -------</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">        volume_dimTag : tuple</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">            Tuple containing the dimension and tag of the generated volume.</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>        <span class="k">for</span> <span class="n">points_list</span> <span class="ow">in</span> <span class="n">contour_list</span><span class="p">:</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>                    <span class="s2">&quot;One or more contours does not have enough points. (min 3)&quot;</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>                <span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>        <span class="n">L_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>        <span class="k">for</span> <span class="n">points_list</span> <span class="ow">in</span> <span class="n">contour_list</span><span class="p">:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>            <span class="c1"># Create data lists.</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>            <span class="n">Pl</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>            <span class="n">Ll</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>            <span class="c1"># Set points.</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points_list</span><span class="p">:</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>                <span class="n">Pl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>            <span class="c1"># Join points as lines.</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points_list</span><span class="p">):</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>                <span class="n">Ll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">Pl</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Pl</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>            <span class="c1"># Join lines as a closed loop and surface.</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>            <span class="n">L_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">Ll</span><span class="p">))</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>        <span class="n">volume_dimTag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addThruSections</span><span class="p">(</span><span class="n">L_list</span><span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="c1"># Delete contour lines.</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>        <span class="k">return</span> <span class="n">volume_dimTag</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">rectangle_cutout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_dimTags</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">xll</span><span class="p">,</span> <span class="n">yll</span><span class="p">):</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">        Intersect the provided shapes with a rectangle (truncation).</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="sd">        Parameters</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a><span class="sd">        ----------</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">        shapes_dimTags : list</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a><span class="sd">            List of dimTags associated with the shapes to be cutout.</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">        dx : float</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="sd">            Length of rectangle along x-axis.</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">        dy : float</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">            Length of rectangle along y-axis.</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">        xll : float</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">            Low left corner x-coordinate.</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a><span class="sd">        yll : float</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a><span class="sd">            Low left corner y-coordinate.</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>        <span class="n">concatenated_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shapes_dimTags</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>        <span class="n">tool_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">xll</span><span class="p">,</span> <span class="n">yll</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>        <span class="n">tool_dimTags</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">tool_tag</span><span class="p">)]</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">objectDimTags</span><span class="o">=</span><span class="n">concatenated_shapes</span><span class="p">,</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>                            <span class="n">toolDimTags</span><span class="o">=</span><span class="n">tool_dimTags</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">radial_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_dimTags</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="sd">        Intersect the provided shapes with a disk (truncation).</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">        Parameters</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">        ----------</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">        shapes_dimTags : list</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">            List of dimTags associated with the shapes to be cutout.</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="sd">        cutoff_radius : float, optional</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="sd">            The radial size of the cutoff. Any part of a shape that is further</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="sd">            away from the origin than this radius will be erased.</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">            The default is 1.0.</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>        <span class="n">dim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shapes_dimTags</span><span class="p">])</span>  <span class="c1"># dimension of shapes</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>            <span class="n">cutoff</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>                                              <span class="n">radius</span><span class="o">=</span><span class="n">cutoff_radius</span><span class="p">))]</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>            <span class="n">cutoff</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>                                            <span class="n">cutoff_radius</span><span class="p">))]</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No cutoff for 1D shapes!&quot;</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">objectDimTags</span><span class="o">=</span><span class="n">shapes_dimTags</span><span class="p">,</span> <span class="n">toolDimTags</span><span class="o">=</span><span class="n">cutoff</span><span class="p">)</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        Fuse together elements of `shapes_1` and `shapes_2` to form new group</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        of shapes.</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">        Parameters</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">        ----------</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a><span class="sd">        Returns</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a><span class="sd">        -------</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a><span class="sd">        new_shapes : list</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">fuse</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">,</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>                                           <span class="n">removeObject</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>                                           <span class="n">removeTool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>            <span class="c1"># Get rid of unneeded shapes</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes_1</span><span class="p">:</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>                <span class="k">if</span> <span class="n">shape</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_shapes</span><span class="p">:</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>                <span class="k">if</span> <span class="n">shape</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_shapes</span><span class="p">:</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">subtract_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>                        <span class="n">removeObject</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">        Subtract elements of `shapes_2` from `shapes_1` to form new group of</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">        shapes.</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">        Parameters</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">        ----------</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">        removeObject : bool, optional</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="sd">            Delete the object shape if set to True. The default is False.</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">        removeTool : bool, optional</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">            Delete the tool shape if set to True. The default is False.</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="sd">        Returns</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">        -------</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">        new_shapes : list</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>                                          <span class="n">shapes_2</span><span class="p">,</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>                                          <span class="n">removeObject</span><span class="o">=</span><span class="n">removeObject</span><span class="p">,</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>                                          <span class="n">removeTool</span><span class="o">=</span><span class="n">removeTool</span><span class="p">)</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="n">shapes_1</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">intersect_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">        Create group of shapes consisting of the intersection of elements</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">        from `shapes_1` and `shapes_2`.</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">        Parameters</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">        ----------</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">        Returns</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">        -------</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="sd">        new_shapes : list</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">)</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">non_intersect_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">        Create group of shapes consisting of the non-intersection of elements</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">        from `shapes_1` and `shapes_2`.</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a><span class="sd">        Parameters</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">        ----------</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">        Returns</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">        -------</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">        new_shapes : list of tuple</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>            <span class="n">_</span><span class="p">,</span> <span class="n">fragment_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">fragment</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">)</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>            <span class="n">shape_fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fragment_map</span><span class="p">:</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>                <span class="n">shape_fragments</span> <span class="o">+=</span> <span class="n">s</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>            <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>            <span class="k">while</span> <span class="n">shape_fragments</span><span class="p">:</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>                <span class="n">in_overlap</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shape_fragments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>                    <span class="k">if</span> <span class="n">shape_fragments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>                        <span class="n">to_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>                        <span class="n">in_overlap</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>                <span class="k">if</span> <span class="n">in_overlap</span><span class="p">:</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>                    <span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>                    <span class="n">new_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">to_remove</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">        Rotates group of shapes around the x-axis.</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">        Parameters</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">        ----------</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="sd">        shapes : list of tuple</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a><span class="sd">        angle : float</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="sd">            Angle of rotation in radians.</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">        axis : str</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="sd">            Axis of rotation {&#39;x&#39;, &#39;y&#39;, &#39;z&#39;}.</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">        Returns</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">        -------</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">        shapes : list tuple</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">            List of tuples representing the group of shapes. Is identical to</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">            input &#39;shapes&#39;.</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>        <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]:</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;axis should be either &#39;x&#39; or &#39;y&#39; or &#39;z&#39;&quot;</span><span class="p">)</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>                         <span class="n">ax</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>                         <span class="n">ay</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>                         <span class="n">az</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">),</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>                         <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>        <span class="k">return</span> <span class="n">shapes</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">        @author: Chad Briddon</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="sd">        Translates group of shapes in the x-direction.</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">        Parameters</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">        ----------</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">        shapes : list of tuple</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">            List of tuples representing a groups of shapes. Each tuple contains</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">            the dimension and tag of its corresponding shape.</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a><span class="sd">        dx, dy, dz : float</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">            Amount the group of shapes is to be translated by in the positive</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a><span class="sd">            (x, y, z)-direction. If negative then translation will be in the</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a><span class="sd">            negative (x, y, z)-direction.</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a><span class="sd">        Returns</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">        -------</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a><span class="sd">        shapes : list tuple</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a><span class="sd">            List of tuples representing the group of shapes. Is identical to</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="sd">            input &#39;shapes&#39;.</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">)</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>        <span class="k">return</span> <span class="n">shapes</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_name</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">        Save the mesh generated by Gmsh.</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">        Parameters</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">        ----------</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">        mesh_name : str</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">            Name of the mesh file to be saved. If not specified as an absolute</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">            path name, will be stored in the `MESH_DIR` directory.</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">        convert : bool</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">            Convert the .vtk mesh file created by Gmsh into a .vtk file readable</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">            by Sfepy.</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">        ignored_tags : list</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">            List of physical groups not to be included in the final .vtk file.</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">        verbose : bool</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">        Returns</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">        -------</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">        mesh_path_name : str</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">            Absolute path name of the saved mesh file.</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>        <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>        <span class="k">if</span> <span class="n">convert</span><span class="p">:</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>            <span class="n">convert_mesh_for_sfepy</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="o">=</span><span class="n">ignored_tags</span><span class="p">,</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>                                   <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>        <span class="k">return</span> <span class="n">mesh_path_name</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_cylindrical_symmetry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">        If the problem to be solved has cylindrical symmetry, it is possible</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">        to reduce the dimension of the problem from 3 (r, theta, z) to 2 (r, z).</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">        In that case, only keep the half-plane r&gt;0 of the 2D mesh.</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>        <span class="c1"># Determination of a suitable cutout distance</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>        <span class="n">distance_cutout</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>            <span class="k">for</span> <span class="n">dimTag</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>                <span class="n">bbox</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">(</span><span class="o">*</span><span class="n">dimTag</span><span class="p">)</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>                <span class="n">xur</span><span class="p">,</span> <span class="n">yur</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>  <span class="c1"># upper-right corner</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>                <span class="n">dist</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">xur</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">yur</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>                <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;</span> <span class="n">distance_cutout</span><span class="p">:</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>                    <span class="n">distance_cutout</span> <span class="o">=</span> <span class="n">dist</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>        <span class="n">distance_cutout</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># safety margin</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="c1"># Apply cutout</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">distance_cutout</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">distance_cutout</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">distance_cutout</span><span class="p">]</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rectangle_cutout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>        <span class="c1"># Repair boundaries</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="k">for</span> <span class="n">dimTags</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>            <span class="n">blist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>            <span class="k">for</span> <span class="n">dimTag</span> <span class="ow">in</span> <span class="n">dimTags</span><span class="p">:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>                <span class="n">boundary</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getBoundary</span><span class="p">([</span><span class="n">dimTag</span><span class="p">])</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>                <span class="k">for</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">boundary</span><span class="p">:</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>                    <span class="k">if</span> <span class="n">curve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>                        <span class="k">continue</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">(</span><span class="n">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">curve</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>                    <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-5</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-5</span><span class="p">:</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>                        <span class="n">blist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blist</span><span class="p">)</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_embed_origin_to_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span> <span class="n">is_on_curve</span><span class="p">):</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="sd">        Force the point of coordinates x=0, y=0, [z=0] to be part of the mesh</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">        vertices.</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">        Parameters</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">        ----------</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a><span class="sd">        origin_tag : int</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">            Tag of the origin point.</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">        is_on_curve : bool</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">            Whether the origin lies on a curve. This happens e.g. when</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">            `cylindrical_symmetry` is set to True.</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>        <span class="c1"># Gmsh hack to embed a point on a curve</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>        <span class="c1"># see https://gitlab.onelab.info/gmsh/gmsh/-/issues/1591</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="k">if</span> <span class="n">is_on_curve</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">fragment</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">)],</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">())</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>        <span class="c1"># Gmsh traditional way to embed a point in surface / volume</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>            <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>                <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">source</span><span class="p">]:</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>                    <span class="k">if</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">isInside</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>                        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">origin_tag</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>                        <span class="k">break</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_refinement_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">):</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the refinement settings to the mesh being created.&quot;&quot;&quot;</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>        <span class="c1"># Get boundary type</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>            <span class="n">boundary_type</span> <span class="o">=</span> <span class="s2">&quot;CurvesList&quot;</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>            <span class="n">boundary_type</span> <span class="o">=</span> <span class="s2">&quot;SurfacesList&quot;</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Gmsh can only deal with 2d or 3d meshes!&quot;</span><span class="p">)</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>        <span class="c1"># Group boundaries together and define distance fields</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>        <span class="k">for</span> <span class="n">boundary</span><span class="p">,</span> <span class="n">rf</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span><span class="p">):</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">boundary_type</span><span class="p">,</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>                                             <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boundary</span><span class="p">])</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;NumPointsPerCurve&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;PointsList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">origin_tag</span><span class="p">])</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>        <span class="c1"># Define threshold fields.</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span><span class="p">:</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;InField&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;SizeMin&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;SizeMax&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;DistMin&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;DistMax&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;InField&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;SizeMin&quot;</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;SizeMax&quot;</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;DistMin&quot;</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;DistMax&quot;</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>        <span class="c1"># Set mesh resolution.</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Min&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;FieldsList&quot;</span><span class="p">,</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>                                         <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MeshSizeExtendFromBoundary&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MeshSizeFromPoints&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MeshSizeFromCurvature&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_assign_physical_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>                                <span class="n">unique_boundary_tags</span><span class="p">):</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign physical groups to geometrical entities of the mesh.&quot;&quot;&quot;</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>        <span class="c1"># 0-dimensional entities</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">origin_tag</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>        <span class="c1"># (D-1)-dimensional entities</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">boundary</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">):</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>            <span class="k">if</span> <span class="n">unique_boundary_tags</span><span class="p">:</span>  <span class="c1"># same tag for all parts of a boundary</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>                <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>                                            <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boundary</span><span class="p">],</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>                                            <span class="n">tag</span><span class="o">=</span><span class="mi">200</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># separate tag for each part of a boundary</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>                <span class="n">inc</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">])</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>                <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">dimTag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boundary</span><span class="p">):</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>                    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>                                                <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">dimTag</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>                                                <span class="n">tag</span><span class="o">=</span><span class="mi">200</span> <span class="o">+</span> <span class="p">(</span><span class="n">inc</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="c1"># D-dimensional entities</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">source</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">):</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>                                        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">source</span><span class="p">],</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>                                        <span class="n">tag</span><span class="o">=</span><span class="mi">300</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_tags</span><span class="p">(</span><span class="n">dimTags</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return list of tags from a list of dimTag.&quot;&quot;&quot;</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">dimTags</span><span class="p">:</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_mesh_from_geo</span><span class="p">(</span><span class="n">geo_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>                           <span class="n">ignored_tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">    Generate a mesh from an existing .geo file with Gmsh.</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">    Parameters</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="sd">    ----------</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">    geo_name : str</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a><span class="sd">        Name of the .geo file.</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">    param_dict : dict</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">        Dictionary containing key/value pairs to be modified.</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">        The default is None.</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">    show_mesh : bool, optional</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">        If True, will open a window to allow viewing of the generated mesh.</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">        The default is False.</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">    ignored_tags : list, optional</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">            List of physical groups not to be included in the final .vtk file.</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">            The default is None.</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">    convert : bool, optional</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">        Convert the .vtk mesh file created by Gmsh into a .vtk file readable</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">        by Sfepy. The default is True.</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">    Other Parameters</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">    ----------------</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">    mesh_name : str, optional</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a><span class="sd">        Output file name. Will be the same as the .geo file if not specified.</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="sd">        The default is None.</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="sd">    verbose : bool, optional</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">        Display user information. The default is False.</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">    Returns</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a><span class="sd">    -------</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a><span class="sd">    mesh_path_name : str</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a><span class="sd">        Absolute path name of the created mesh file.</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>    <span class="c1"># Get keyword arguments</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>    <span class="k">if</span> <span class="n">param_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>        <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>    <span class="n">mesh_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mesh_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>    <span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>    <span class="c1"># Write parameters to the existing .geo file</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>    <span class="n">geo_path_name</span> <span class="o">=</span> <span class="n">make_absolute_geo_name</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>    <span class="n">_write_geo_params</span><span class="p">(</span><span class="n">geo_path_name</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">)</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>    <span class="k">if</span> <span class="n">mesh_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>        <span class="n">mesh_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;General.Verbosity&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">geo_path_name</span><span class="p">)</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model&#39;</span> <span class="o">+</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getCurrent</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;D)&#39;</span><span class="p">)</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Inspect the log</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="n">log</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logger has recorded </span><span class="si">{}</span><span class="s2"> lines&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">log</span><span class="p">)))</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>    <span class="k">if</span> <span class="n">show_mesh</span><span class="p">:</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>    <span class="c1"># save the generated mesh</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>    <span class="c1"># convert the mesh to a .vtk file readable by Sfepy</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>    <span class="k">if</span> <span class="n">convert</span><span class="p">:</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>        <span class="n">convert_mesh_for_sfepy</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>                               <span class="n">ignored_tags</span><span class="o">=</span><span class="n">ignored_tags</span><span class="p">,</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>                               <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>    <span class="k">return</span> <span class="n">mesh_path_name</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_mesh_for_sfepy</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">    Convert a .vtk mesh file written by Gmsh into a new .vtk file which</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a><span class="sd">    facilitates topological entity selection with Sfepy. Vertices are given a</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="sd">    unique group id following the convention:</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">    [0 - 99]    --&gt; vertex tag (i.e. entity of dimension 0)</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">    [100 - 199] --&gt; edge tag (i.e. entity of dimension 1)</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">    [200 - 299] --&gt; facet tag (i.e. entity of dimension D-1)</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a><span class="sd">    [300 - xxx] --&gt; cell tag (i.e. entity of dimension D)</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a><span class="sd">    If one node belongs to several topological entities, it will be tagged with</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="sd">    the lowest dimension group id. For instance, a vertex belonging to a facet</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="sd">    of tag 200 and a subvolume of tag 300 will be tagged 200. This is</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="sd">    problematic for subvolume selection. This difficulty is overcome by taking</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="sd">    advantage of the &#39;mat_ids&#39; field that is readable by Sfepy.</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">    Parameters</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">    ----------</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">    mesh_name : str</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">        Name of the mesh file to be created. If not specified as an absolute</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">        path name, will be stored in the `MESH_DIR` directory.</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">    ignored_tags : list, optional</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">        List of tags to be ignored in the new .vtk mesh. The default is None.</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">    verbose : bool, optional</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">        Toggle for Sfepy automatic console messages. The default is False.</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>    <span class="n">output</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>    <span class="k">if</span> <span class="n">ignored_tags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>        <span class="n">ignored_tags</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>    <span class="n">cell_dim</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">dim</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>    <span class="c1"># All the necessary &amp; sufficient information for defining a mesh</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">_get_io_data</span><span class="p">(</span><span class="n">cell_dim_only</span><span class="o">=</span><span class="n">cell_dim</span><span class="p">))</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>    <span class="c1"># Managing vertex groups</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>    <span class="n">ngroups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">n_nod</span><span class="p">)])</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">cells_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">cells_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>        <span class="n">former_tags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">cell_data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">former_tags</span><span class="p">):</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignored_tags</span><span class="p">:</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">conn</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>                    <span class="k">if</span> <span class="n">ngroups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>                        <span class="n">ngroups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>    <span class="n">ngroups</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ngroups</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">400</span>  <span class="c1"># default marker for untagged</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>    <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ngroups</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>    <span class="c1"># Managing cell groups</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>    <span class="n">conns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">cells_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># entities of highest dim</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>    <span class="n">mat_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ngroups</span><span class="p">[</span><span class="n">conns</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>    <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_ids</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)]</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>    <span class="c1"># Overwrite the former mesh</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>    <span class="n">mesh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a><span class="k">def</span><span class="w"> </span><span class="nf">adjust_boundary_nodes</span><span class="p">(</span><span class="n">mesh_name_ref</span><span class="p">,</span> <span class="n">mesh_name_mod</span><span class="p">,</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>                          <span class="n">boundary_tag_ref</span><span class="p">,</span> <span class="n">boundary_tag_mod</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a><span class="sd">    Adjust the coordinates of the nodes belonging to the boundary tagged</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a><span class="sd">    `boundary_tag_mod` of mesh `mesh_name_mod` in order to match those of</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a><span class="sd">    `mesh_name_ref` with tag `boundary_tag_ref`.</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a><span class="sd">    Parameters</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a><span class="sd">    ----------</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">    mesh_name_ref : str</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">        Name of the reference mesh file (read only). If not specified as an</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a><span class="sd">        absolute path name, will be searched for in the `MESH_DIR` directory.</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a><span class="sd">    mesh_name_mod : str</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="sd">        Name of the mesh file to be modified if its boundary nodes do not match</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">        those of the reference mesh file. If not specified as an absolute path</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">        name, will be searched for in the `MESH_DIR` directory.</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">    boundary_tag_ref : int</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">        Physical group of the reference boundary nodes.</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">    boundary_tag_mod : int</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">        Physical group of the boundary nodes to be adjusted.</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a><span class="sd">    Other Parameters</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">    ----------------</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="sd">    verbose : bool, optional</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">        The default is False.</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>    <span class="n">mesh_path_name_ref</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name_ref</span><span class="p">)</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>    <span class="n">mesh_path_name_mod</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name_mod</span><span class="p">)</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>    <span class="c1"># Read the meshes, get boundary indices and associated coordinates</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>    <span class="n">mesh_ref</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name_ref</span><span class="p">)</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>    <span class="n">mesh_mod</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name_mod</span><span class="p">)</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>    <span class="n">ind_ref</span><span class="p">,</span> <span class="n">ind_mod</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mesh_ref</span><span class="o">.</span><span class="n">point_data</span><span class="p">[</span><span class="s1">&#39;node_groups&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">boundary_tag_ref</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mesh_mod</span><span class="o">.</span><span class="n">point_data</span><span class="p">[</span><span class="s1">&#39;node_groups&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">boundary_tag_mod</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>    <span class="p">)</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_ref</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_mod</span><span class="p">),</span> <span class="s2">&quot;Number of DOFs does not match!&quot;</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>    <span class="n">pts_ref</span> <span class="o">=</span> <span class="n">mesh_ref</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">ind_ref</span><span class="p">]</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>    <span class="n">pts_mod</span> <span class="o">=</span> <span class="n">mesh_mod</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">ind_mod</span><span class="p">]</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>    <span class="c1"># Check for non-matching nodes between mesh_ref and mesh_mod</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>    <span class="n">actually_modified</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">ptmod</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pts_mod</span><span class="p">):</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pts_ref</span> <span class="o">-</span> <span class="n">ptmod</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>            <span class="n">ind</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pts_ref</span> <span class="o">-</span> <span class="n">ptmod</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>            <span class="n">actually_modified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind_mod</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>            <span class="n">ptmod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pts_ref</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>  <span class="c1"># in place modification</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>            <span class="n">mesh_mod</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">ind_mod</span><span class="p">[</span><span class="n">kk</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ptmod</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>    <span class="c1"># If applicable, overwrite mesh_mod with adjusted boundary nodes</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">actually_modified</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adjusting the position of some boundary nodes...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>        <span class="n">mesh_overwrite</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">mesh_path_name_mod</span><span class="p">)</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>        <span class="n">coors_mod</span> <span class="o">=</span> <span class="n">mesh_mod</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="p">:</span><span class="n">mesh_overwrite</span><span class="o">.</span><span class="n">dim</span><span class="p">]</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>        <span class="n">mesh_overwrite</span><span class="o">.</span><span class="n">coors</span><span class="p">[</span><span class="n">actually_modified</span><span class="p">]</span> <span class="o">=</span> <span class="n">coors_mod</span><span class="p">[</span><span class="n">actually_modified</span><span class="p">]</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>        <span class="n">mesh_overwrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mesh_path_name_mod</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="k">def</span><span class="w"> </span><span class="nf">split_spheres_from_mesh</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">Rcut</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">    Split two meshed spheres that are geometrically separable by a hyperplane</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">    into two distinct mesh files. The original mesh is then deleted. The </span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">    original mesh must have gone through the `convert_mesh_for_sfepy` routine</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">    before being processed by `split_spheres_from_mesh`!</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="sd">    Parameters</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">    ----------</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a><span class="sd">    mesh_name : str</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a><span class="sd">        Name of the mesh file to be read. If not specified as an absolute</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a><span class="sd">        path name, will be searched for in the `MESH_DIR` directory.</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">    Rcut : float</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="sd">        Truncation radius.</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="sd">    Other Parameters</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">    ----------------</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">    verbose : bool, optional</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">        Toggle for Sfepy automatic console messages. The default is False.</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">    Returns</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">    -------</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">    out_files : list</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">        List of absolute path of output mesh files.</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>    <span class="n">output</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>    <span class="c1"># Retrieve data</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">_get_io_data</span><span class="p">(</span><span class="n">cell_dim_only</span><span class="o">=</span><span class="n">mesh</span><span class="o">.</span><span class="n">dim</span><span class="p">))</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>    <span class="n">data_int</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>    <span class="n">data_ext</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>    <span class="c1"># Classify nodes belonging to sphere_int and sphere_ext</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>    <span class="n">norms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>    <span class="n">idx_node_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">norms</span> <span class="o">&lt;</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>    <span class="n">idx_node_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">norms</span> <span class="o">&gt;</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>    <span class="c1"># Sort out data structures according to node class</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>    <span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_int</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx_node_int</span><span class="p">]</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_int</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx_node_int</span><span class="p">]</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ext</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx_node_ext</span><span class="p">]</span> <span class="o">-</span> <span class="n">offset</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ext</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx_node_ext</span><span class="p">]</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>    <span class="n">extTag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>    <span class="n">idx_cell_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">extTag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx_cell_ext</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data_int</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx_cell_ext</span><span class="p">)]</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">idx_cell_ext</span><span class="p">]]</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_ext</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">idx_cell_ext</span><span class="p">]]</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>    <span class="c1"># Repair connectivity because it has been broken!</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>    <span class="n">conn_int</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>    <span class="n">conn_ext</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>    <span class="n">min_int</span> <span class="o">=</span> <span class="n">conn_int</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>    <span class="n">conn_int</span> <span class="o">-=</span> <span class="n">min_int</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">min_int</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>    <span class="n">idx_node_int</span> <span class="o">-=</span> <span class="n">min_int</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>    <span class="n">min_ext</span> <span class="o">=</span> <span class="n">conn_ext</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>    <span class="n">conn_ext</span> <span class="o">-=</span> <span class="n">min_ext</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">min_ext</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>    <span class="n">idx_node_ext</span> <span class="o">-=</span> <span class="n">min_ext</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>    <span class="n">gaps_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">idx_node_int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>    <span class="n">gaps_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">idx_node_ext</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">gap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gaps_int</span><span class="p">):</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>        <span class="k">if</span> <span class="n">gap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>            <span class="n">conn_int</span><span class="p">[</span><span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">idx_node_int</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">-=</span> <span class="n">gap</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">gap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gaps_ext</span><span class="p">):</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>        <span class="k">if</span> <span class="n">gap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>            <span class="n">conn_ext</span><span class="p">[</span><span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">idx_node_ext</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">-=</span> <span class="n">gap</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">conn_int</span><span class="p">]</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">conn_ext</span><span class="p">]</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>    <span class="c1"># I/O stuff</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>    <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>    <span class="n">name_int</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">with_name</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_int&#39;</span><span class="p">)</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>    <span class="n">name_ext</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">with_name</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_ext&#39;</span><span class="p">)</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>    <span class="n">mesh_int</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_int</span><span class="p">),</span> <span class="o">*</span><span class="n">data_int</span><span class="p">)</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>    <span class="n">mesh_int</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_int</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>    <span class="n">mesh_ext</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_ext</span><span class="p">),</span> <span class="o">*</span><span class="n">data_ext</span><span class="p">)</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>    <span class="n">mesh_ext</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_ext</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.vtk&#39;</span><span class="p">)</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>    <span class="c1"># Return new file names</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>    <span class="n">out_files</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">name_int</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)),</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>                 <span class="nb">str</span><span class="p">(</span><span class="n">name_ext</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">))]</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>    <span class="k">return</span> <span class="n">out_files</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a><span class="k">def</span><span class="w"> </span><span class="nf">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an absolute path name from a mesh name, with .vtk extension.</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a><span class="sd">    The default path is `MESH_DIR`.&quot;&quot;&quot;</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>            <span class="s2">&quot;mesh_name is of type &#39;</span><span class="si">{}</span><span class="s2">&#39; but should be a string instead&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>                <span class="nb">type</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh_path_name</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">():</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>        <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">MESH_DIR</span> <span class="o">/</span> <span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a><span class="k">def</span><span class="w"> </span><span class="nf">make_absolute_geo_name</span><span class="p">(</span><span class="n">geo_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an absolute path name from a mesh name, with .geo extension.</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a><span class="sd">    The default path is `MESH_DIR`/geo.&quot;&quot;&quot;</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geo_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>            <span class="s2">&quot;geo_name is of type &#39;</span><span class="si">{}</span><span class="s2">&#39; but should be a string instead&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>                <span class="nb">type</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>    <span class="n">geo_name_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.geo&#39;</span><span class="p">)</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">geo_name_path</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">():</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="n">geo_name_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">MESH_DIR</span> <span class="o">/</span> <span class="s2">&quot;geo&quot;</span> <span class="o">/</span> <span class="n">geo_name_path</span><span class="p">)</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">geo_name_path</span><span class="p">)</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a><span class="k">def</span><span class="w"> </span><span class="nf">read_Rcut_from_mesh_file</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">coorsys</span><span class="o">=</span><span class="s1">&#39;cartesian&#39;</span><span class="p">):</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a><span class="sd">    Read truncation radius Rc from existing .vtk mesh file.</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a><span class="sd">    Parameters</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a><span class="sd">    ----------</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a><span class="sd">    mesh_name : str</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a><span class="sd">        Name of the mesh file to be read. If not specified as an absolute</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a><span class="sd">        path name, will be searched for in the `MESH_DIR` directory.</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a><span class="sd">    coorsys : str</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a><span class="sd">        Coordinate system to be used in accordance with the mesh.</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a><span class="sd">    Returns</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a><span class="sd">    -------</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a><span class="sd">    Rc : float</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a><span class="sd">        Truncation radius.</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>    <span class="n">coors</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">points</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>    <span class="k">if</span> <span class="n">coorsys</span> <span class="o">==</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">:</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>        <span class="n">Rcut</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">coors</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>    <span class="k">elif</span> <span class="n">coorsys</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;polar_mu&#39;</span><span class="p">]:</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>        <span class="n">Rcut</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">coors</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not implemented coordinates system: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">coorsys</span><span class="p">)</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>    <span class="k">return</span> <span class="n">Rcut</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a><span class="k">def</span><span class="w"> </span><span class="nf">read_dimension_from_mesh_file</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read dimension from existing .vtk mesh file.&quot;&quot;&quot;</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>    <span class="n">Z</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Z</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>        <span class="k">return</span> <span class="mi">2</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>        <span class="k">return</span> <span class="mi">3</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a><span class="k">def</span><span class="w"> </span><span class="nf">read_physical_groups_from_mesh_file</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a><span class="sd">    Read the physical groups present in the mesh and return them as a</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">    list.</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">point_data</span><span class="p">[</span><span class="s2">&quot;node_groups&quot;</span><span class="p">]))</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_uniform_1d_mesh</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">number_nodes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>                             <span class="n">mesh_name</span><span class="o">=</span><span class="s1">&#39;mesh1d&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mesh</span><span class="p">:</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a><span class="sd">    Generate uniform one-dimensional mesh on the interval [`start`, `stop`]</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a><span class="sd">    using `number_nodes` nodes. Unlike higher dimensional meshes, the resulting</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a><span class="sd">    mesh is not saved as a .vtk file. Instead, it is directly returned as an</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="sd">    instance of the class `sfepy.discrete.fem.mesh.Mesh`.</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">    Parameters</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a><span class="sd">    ----------</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">    start : float</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">        Lower bound of the interval to be meshed.</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">    stop : float</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a><span class="sd">        Upper bound of the interval to be meshed.</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a><span class="sd">    number_nodes : int</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a><span class="sd">        Number of nodes evenly  spaced across the interval (including</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="sd">        endpoints).</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a><span class="sd">    mesh_name : str, optional</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a><span class="sd">        Name of the mesh. The default is &#39;mesh1d&#39;.</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="sd">    Returns</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a><span class="sd">    -------</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">    mesh : `sfepy.discrete.fem.mesh.Mesh`</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">        Uniform one-dimensional mesh (instance of Sfepy&#39;s class `Mesh`).</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a>    <span class="n">number_nodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">number_nodes</span><span class="p">)</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">number_nodes</span><span class="p">)</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>    <span class="k">return</span> <span class="n">generate_1d_mesh_from_array</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">mesh_name</span><span class="o">=</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_1d_mesh_from_array</span><span class="p">(</span><span class="n">coors_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>                                <span class="n">mesh_name</span><span class="o">=</span><span class="s1">&#39;mesh1d&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mesh</span><span class="p">:</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a><span class="sd">    Generate a one-dimensional mesh from a 1d Numpy array. Unlike higher</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="sd">    dimensional meshes, the resulting mesh is not saved as a .vtk file.</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a><span class="sd">    Instead, it is directly returned as an instance of the class</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a><span class="sd">    `sfepy.discrete.fem.mesh.Mesh`.</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">    Parameters</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">    ----------</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a><span class="sd">    coors_array : np.ndarray</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">        Coordinates of the mesh vertices (1st-order nodes only).</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a><span class="sd">    mesh_name : str, optional</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a><span class="sd">        Name of the mesh. The default is &#39;mesh1d&#39;.</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a><span class="sd">    Returns</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a><span class="sd">    -------</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a><span class="sd">    mesh : `sfepy.discrete.fem.mesh.Mesh`</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="sd">        Uniform one-dimensional mesh (instance of Sfepy&#39;s class `Mesh`).</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">coors_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>    <span class="n">mat_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">conn</span><span class="p">],</span> <span class="p">[</span><span class="n">mat_ids</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1_2&#39;</span><span class="p">])</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>    <span class="k">return</span> <span class="n">mesh</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a><span class="k">def</span><span class="w"> </span><span class="nf">_write_geo_params</span><span class="p">(</span><span class="n">geo_name</span><span class="p">,</span> <span class="n">param_dic</span><span class="p">):</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a><span class="sd">    Modify a .geo file according to the key/value pairs specified by the user</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a><span class="sd">    in the `param_dict` dictionary.</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a><span class="sd">    Parameters</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">    ----------</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="sd">    geo_name : str</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a><span class="sd">        Name of the .geo file.</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">    param_dic : dict</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a><span class="sd">        Dictionary containing key/value pairs to be modified.</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>    <span class="n">geo_path_name</span> <span class="o">=</span> <span class="n">make_absolute_geo_name</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>    <span class="n">param_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">param_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>    <span class="n">separator</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>    <span class="c1"># Read .geo file</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>    <span class="n">old_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">geo_path_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>    <span class="n">lines</span> <span class="o">=</span> <span class="n">old_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>    <span class="n">old_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>    <span class="c1"># Write to a new .geo file</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>    <span class="n">new_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">geo_path_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>        <span class="n">curr_str</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>        <span class="k">if</span> <span class="n">curr_str</span> <span class="ow">and</span> <span class="n">curr_str</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">param_keys</span><span class="p">:</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>            <span class="n">newline</span> <span class="o">=</span> <span class="n">curr_str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>            <span class="n">newline</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">param_dic</span><span class="p">[</span><span class="n">curr_str</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">+</span> <span class="s1">&#39;;&#39;</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>            <span class="n">newline</span> <span class="o">=</span> <span class="n">separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">newline</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>            <span class="n">new_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">newline</span><span class="p">)</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>            <span class="n">new_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>    <span class="n">new_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="MeshingTools">
                            <input id="MeshingTools-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MeshingTools</span>:

                <label class="view-source-button" for="MeshingTools-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools-24"><a href="#MeshingTools-24"><span class="linenos">  24</span></a><span class="k">class</span><span class="w"> </span><span class="nc">MeshingTools</span><span class="p">:</span>
</span><span id="MeshingTools-25"><a href="#MeshingTools-25"><span class="linenos">  25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-26"><a href="#MeshingTools-26"><span class="linenos">  26</span></a><span class="sd">    Construct and manipulate user-defined meshes through the Gmsh Python API.</span>
</span><span id="MeshingTools-27"><a href="#MeshingTools-27"><span class="linenos">  27</span></a><span class="sd">    Gmsh Python API is initialized when the class is instantiated.</span>
</span><span id="MeshingTools-28"><a href="#MeshingTools-28"><span class="linenos">  28</span></a><span class="sd">    Following Gmsh&#39;s terminology, a dimTag is a pair of integers (dim, tag) and</span>
</span><span id="MeshingTools-29"><a href="#MeshingTools-29"><span class="linenos">  29</span></a><span class="sd">    a dimTags is a list of several dimTag.</span>
</span><span id="MeshingTools-30"><a href="#MeshingTools-30"><span class="linenos">  30</span></a>
</span><span id="MeshingTools-31"><a href="#MeshingTools-31"><span class="linenos">  31</span></a><span class="sd">    Attributes</span>
</span><span id="MeshingTools-32"><a href="#MeshingTools-32"><span class="linenos">  32</span></a><span class="sd">    ----------</span>
</span><span id="MeshingTools-33"><a href="#MeshingTools-33"><span class="linenos">  33</span></a><span class="sd">    dim : int</span>
</span><span id="MeshingTools-34"><a href="#MeshingTools-34"><span class="linenos">  34</span></a><span class="sd">        Dimension of the mesh, 2 or 3.</span>
</span><span id="MeshingTools-35"><a href="#MeshingTools-35"><span class="linenos">  35</span></a><span class="sd">    Rcut : float</span>
</span><span id="MeshingTools-36"><a href="#MeshingTools-36"><span class="linenos">  36</span></a><span class="sd">        Truncation radius of the mesh.</span>
</span><span id="MeshingTools-37"><a href="#MeshingTools-37"><span class="linenos">  37</span></a><span class="sd">    boundaries : list</span>
</span><span id="MeshingTools-38"><a href="#MeshingTools-38"><span class="linenos">  38</span></a><span class="sd">        List of dimTags representing boundary shapes of dimension `dim`-1.</span>
</span><span id="MeshingTools-39"><a href="#MeshingTools-39"><span class="linenos">  39</span></a><span class="sd">    sources : list</span>
</span><span id="MeshingTools-40"><a href="#MeshingTools-40"><span class="linenos">  40</span></a><span class="sd">        List of dimTags representing source shapes of dimension `dim`.</span>
</span><span id="MeshingTools-41"><a href="#MeshingTools-41"><span class="linenos">  41</span></a><span class="sd">    refinement_settings : list</span>
</span><span id="MeshingTools-42"><a href="#MeshingTools-42"><span class="linenos">  42</span></a><span class="sd">        List of mesh refinement settings (see `create_subdomain` method), one</span>
</span><span id="MeshingTools-43"><a href="#MeshingTools-43"><span class="linenos">  43</span></a><span class="sd">        per source shape.</span>
</span><span id="MeshingTools-44"><a href="#MeshingTools-44"><span class="linenos">  44</span></a><span class="sd">    number_sources : int</span>
</span><span id="MeshingTools-45"><a href="#MeshingTools-45"><span class="linenos">  45</span></a><span class="sd">        Number of source shapes currently defined in the Gmsh model.</span>
</span><span id="MeshingTools-46"><a href="#MeshingTools-46"><span class="linenos">  46</span></a><span class="sd">    number_boundaries : int</span>
</span><span id="MeshingTools-47"><a href="#MeshingTools-47"><span class="linenos">  47</span></a><span class="sd">        Number of boundary shapes currently defined in the Gmsh model.</span>
</span><span id="MeshingTools-48"><a href="#MeshingTools-48"><span class="linenos">  48</span></a><span class="sd">    min_length : float</span>
</span><span id="MeshingTools-49"><a href="#MeshingTools-49"><span class="linenos">  49</span></a><span class="sd">        Minimum distance between neighbouring points.</span>
</span><span id="MeshingTools-50"><a href="#MeshingTools-50"><span class="linenos">  50</span></a><span class="sd">    geom : class gmsh.model.occ</span>
</span><span id="MeshingTools-51"><a href="#MeshingTools-51"><span class="linenos">  51</span></a><span class="sd">        Shortcut.</span>
</span><span id="MeshingTools-52"><a href="#MeshingTools-52"><span class="linenos">  52</span></a>
</span><span id="MeshingTools-53"><a href="#MeshingTools-53"><span class="linenos">  53</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MeshingTools-54"><a href="#MeshingTools-54"><span class="linenos">  54</span></a>
</span><span id="MeshingTools-55"><a href="#MeshingTools-55"><span class="linenos">  55</span></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Decorators</span><span class="p">:</span>
</span><span id="MeshingTools-56"><a href="#MeshingTools-56"><span class="linenos">  56</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Inner class for defining decorators.&quot;&quot;&quot;</span>
</span><span id="MeshingTools-57"><a href="#MeshingTools-57"><span class="linenos">  57</span></a>
</span><span id="MeshingTools-58"><a href="#MeshingTools-58"><span class="linenos">  58</span></a>        <span class="nd">@staticmethod</span>
</span><span id="MeshingTools-59"><a href="#MeshingTools-59"><span class="linenos">  59</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">check_dimension</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
</span><span id="MeshingTools-60"><a href="#MeshingTools-60"><span class="linenos">  60</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Decorator for checking that the current `MeshingTools` instance</span>
</span><span id="MeshingTools-61"><a href="#MeshingTools-61"><span class="linenos">  61</span></a><span class="sd">            has its dimension set to `dim`.&quot;&quot;&quot;</span>
</span><span id="MeshingTools-62"><a href="#MeshingTools-62"><span class="linenos">  62</span></a>            <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="MeshingTools-63"><a href="#MeshingTools-63"><span class="linenos">  63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools-64"><a href="#MeshingTools-64"><span class="linenos">  64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools-65"><a href="#MeshingTools-65"><span class="linenos">  65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools-66"><a href="#MeshingTools-66"><span class="linenos">  66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools-67"><a href="#MeshingTools-67"><span class="linenos">  67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools-68"><a href="#MeshingTools-68"><span class="linenos">  68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools-69"><a href="#MeshingTools-69"><span class="linenos">  69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MeshingTools-70"><a href="#MeshingTools-70"><span class="linenos">  70</span></a>                <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="MeshingTools-71"><a href="#MeshingTools-71"><span class="linenos">  71</span></a>            <span class="k">return</span> <span class="n">decorator</span>
</span><span id="MeshingTools-72"><a href="#MeshingTools-72"><span class="linenos">  72</span></a>
</span><span id="MeshingTools-73"><a href="#MeshingTools-73"><span class="linenos">  73</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Rcut</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="MeshingTools-74"><a href="#MeshingTools-74"><span class="linenos">  74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-75"><a href="#MeshingTools-75"><span class="linenos">  75</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-76"><a href="#MeshingTools-76"><span class="linenos">  76</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-77"><a href="#MeshingTools-77"><span class="linenos">  77</span></a><span class="sd">        dimension : int</span>
</span><span id="MeshingTools-78"><a href="#MeshingTools-78"><span class="linenos">  78</span></a><span class="sd">            Dimension of the mesh, 2 or 3.</span>
</span><span id="MeshingTools-79"><a href="#MeshingTools-79"><span class="linenos">  79</span></a><span class="sd">        Rcut : float, optional</span>
</span><span id="MeshingTools-80"><a href="#MeshingTools-80"><span class="linenos">  80</span></a><span class="sd">            Truncation radius of the mesh. The default is None.</span>
</span><span id="MeshingTools-81"><a href="#MeshingTools-81"><span class="linenos">  81</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-82"><a href="#MeshingTools-82"><span class="linenos">  82</span></a>
</span><span id="MeshingTools-83"><a href="#MeshingTools-83"><span class="linenos">  83</span></a>        <span class="c1"># Check dimension</span>
</span><span id="MeshingTools-84"><a href="#MeshingTools-84"><span class="linenos">  84</span></a>        <span class="k">assert</span> <span class="n">dimension</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;Dimension should be 2 or 3.&quot;</span>
</span><span id="MeshingTools-85"><a href="#MeshingTools-85"><span class="linenos">  85</span></a>
</span><span id="MeshingTools-86"><a href="#MeshingTools-86"><span class="linenos">  86</span></a>        <span class="c1"># Set attributes</span>
</span><span id="MeshingTools-87"><a href="#MeshingTools-87"><span class="linenos">  87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dimension</span>
</span><span id="MeshingTools-88"><a href="#MeshingTools-88"><span class="linenos">  88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Rcut</span> <span class="o">=</span> <span class="n">Rcut</span>
</span><span id="MeshingTools-89"><a href="#MeshingTools-89"><span class="linenos">  89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-90"><a href="#MeshingTools-90"><span class="linenos">  90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-91"><a href="#MeshingTools-91"><span class="linenos">  91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-92"><a href="#MeshingTools-92"><span class="linenos">  92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MeshingTools-93"><a href="#MeshingTools-93"><span class="linenos">  93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MeshingTools-94"><a href="#MeshingTools-94"><span class="linenos">  94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span> <span class="o">=</span> <span class="mf">1.3e-6</span>
</span><span id="MeshingTools-95"><a href="#MeshingTools-95"><span class="linenos">  95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">occ</span>
</span><span id="MeshingTools-96"><a href="#MeshingTools-96"><span class="linenos">  96</span></a>
</span><span id="MeshingTools-97"><a href="#MeshingTools-97"><span class="linenos">  97</span></a>        <span class="c1"># open gmsh</span>
</span><span id="MeshingTools-98"><a href="#MeshingTools-98"><span class="linenos">  98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools-99"><a href="#MeshingTools-99"><span class="linenos">  99</span></a>
</span><span id="MeshingTools-100"><a href="#MeshingTools-100"><span class="linenos"> 100</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MeshingTools-101"><a href="#MeshingTools-101"><span class="linenos"> 101</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_gmsh</span><span class="p">():</span>
</span><span id="MeshingTools-102"><a href="#MeshingTools-102"><span class="linenos"> 102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Gmsh Python API.&quot;&quot;&quot;</span>
</span><span id="MeshingTools-103"><a href="#MeshingTools-103"><span class="linenos"> 103</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</span><span id="MeshingTools-104"><a href="#MeshingTools-104"><span class="linenos"> 104</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;General.Verbosity&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="MeshingTools-105"><a href="#MeshingTools-105"><span class="linenos"> 105</span></a>
</span><span id="MeshingTools-106"><a href="#MeshingTools-106"><span class="linenos"> 106</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MeshingTools-107"><a href="#MeshingTools-107"><span class="linenos"> 107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">close_gmsh</span><span class="p">():</span>
</span><span id="MeshingTools-108"><a href="#MeshingTools-108"><span class="linenos"> 108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;To be called when one is done using the Gmsh Python API.&quot;&quot;&quot;</span>
</span><span id="MeshingTools-109"><a href="#MeshingTools-109"><span class="linenos"> 109</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="MeshingTools-110"><a href="#MeshingTools-110"><span class="linenos"> 110</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span><span id="MeshingTools-111"><a href="#MeshingTools-111"><span class="linenos"> 111</span></a>
</span><span id="MeshingTools-112"><a href="#MeshingTools-112"><span class="linenos"> 112</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MeshingTools-113"><a href="#MeshingTools-113"><span class="linenos"> 113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-114"><a href="#MeshingTools-114"><span class="linenos"> 114</span></a><span class="sd">        Generate the mesh and save it.</span>
</span><span id="MeshingTools-115"><a href="#MeshingTools-115"><span class="linenos"> 115</span></a>
</span><span id="MeshingTools-116"><a href="#MeshingTools-116"><span class="linenos"> 116</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-117"><a href="#MeshingTools-117"><span class="linenos"> 117</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-118"><a href="#MeshingTools-118"><span class="linenos"> 118</span></a><span class="sd">        mesh_name : str</span>
</span><span id="MeshingTools-119"><a href="#MeshingTools-119"><span class="linenos"> 119</span></a><span class="sd">            Name of the mesh file to be created. If not specified as an absolute</span>
</span><span id="MeshingTools-120"><a href="#MeshingTools-120"><span class="linenos"> 120</span></a><span class="sd">            path name, will be stored in the `MESH_DIR` directory.</span>
</span><span id="MeshingTools-121"><a href="#MeshingTools-121"><span class="linenos"> 121</span></a><span class="sd">        show_mesh : bool, optional</span>
</span><span id="MeshingTools-122"><a href="#MeshingTools-122"><span class="linenos"> 122</span></a><span class="sd">            Open the Gmsh graphical user interface to inspect the mesh.</span>
</span><span id="MeshingTools-123"><a href="#MeshingTools-123"><span class="linenos"> 123</span></a><span class="sd">            The default is False.</span>
</span><span id="MeshingTools-124"><a href="#MeshingTools-124"><span class="linenos"> 124</span></a>
</span><span id="MeshingTools-125"><a href="#MeshingTools-125"><span class="linenos"> 125</span></a><span class="sd">        Other Parameters</span>
</span><span id="MeshingTools-126"><a href="#MeshingTools-126"><span class="linenos"> 126</span></a><span class="sd">        ----------------</span>
</span><span id="MeshingTools-127"><a href="#MeshingTools-127"><span class="linenos"> 127</span></a><span class="sd">        ignored_tags : list, optional</span>
</span><span id="MeshingTools-128"><a href="#MeshingTools-128"><span class="linenos"> 128</span></a><span class="sd">            List of physical groups not to be included in the final .vtk file.</span>
</span><span id="MeshingTools-129"><a href="#MeshingTools-129"><span class="linenos"> 129</span></a><span class="sd">            The default is [].</span>
</span><span id="MeshingTools-130"><a href="#MeshingTools-130"><span class="linenos"> 130</span></a><span class="sd">        convert : bool, optional</span>
</span><span id="MeshingTools-131"><a href="#MeshingTools-131"><span class="linenos"> 131</span></a><span class="sd">            Convert the .vtk mesh file created by Gmsh into a .vtk file readable</span>
</span><span id="MeshingTools-132"><a href="#MeshingTools-132"><span class="linenos"> 132</span></a><span class="sd">            by Sfepy. The default is True.</span>
</span><span id="MeshingTools-133"><a href="#MeshingTools-133"><span class="linenos"> 133</span></a><span class="sd">        embed_origin : bool, optional</span>
</span><span id="MeshingTools-134"><a href="#MeshingTools-134"><span class="linenos"> 134</span></a><span class="sd">            Force the embedding of the origin (i.e. point of coordinates x=0,</span>
</span><span id="MeshingTools-135"><a href="#MeshingTools-135"><span class="linenos"> 135</span></a><span class="sd">            y=0, [z=0]) into the mesh. The default is False.</span>
</span><span id="MeshingTools-136"><a href="#MeshingTools-136"><span class="linenos"> 136</span></a><span class="sd">        origin_rf : list, optional</span>
</span><span id="MeshingTools-137"><a href="#MeshingTools-137"><span class="linenos"> 137</span></a><span class="sd">            Settings for refinement around the origin, namely</span>
</span><span id="MeshingTools-138"><a href="#MeshingTools-138"><span class="linenos"> 138</span></a><span class="sd">            [size_min, size_max, dist_min, dist_max].</span>
</span><span id="MeshingTools-139"><a href="#MeshingTools-139"><span class="linenos"> 139</span></a><span class="sd">            The default is [1e-2, 1e-1, 0.1, 1.0].</span>
</span><span id="MeshingTools-140"><a href="#MeshingTools-140"><span class="linenos"> 140</span></a><span class="sd">        unique_boundary_tags : bool, optional</span>
</span><span id="MeshingTools-141"><a href="#MeshingTools-141"><span class="linenos"> 141</span></a><span class="sd">            Assign a single physical group will be created for all elementary</span>
</span><span id="MeshingTools-142"><a href="#MeshingTools-142"><span class="linenos"> 142</span></a><span class="sd">            entities that are parts of a shape&#39;s boundary. The default is True.</span>
</span><span id="MeshingTools-143"><a href="#MeshingTools-143"><span class="linenos"> 143</span></a><span class="sd">        cylindrical_symmetry : bool, optional</span>
</span><span id="MeshingTools-144"><a href="#MeshingTools-144"><span class="linenos"> 144</span></a><span class="sd">            Whether the 2D mesh corresponds to a cylindrically symmetric</span>
</span><span id="MeshingTools-145"><a href="#MeshingTools-145"><span class="linenos"> 145</span></a><span class="sd">            problem. The default is False.</span>
</span><span id="MeshingTools-146"><a href="#MeshingTools-146"><span class="linenos"> 146</span></a><span class="sd">        verbose : bool, optional</span>
</span><span id="MeshingTools-147"><a href="#MeshingTools-147"><span class="linenos"> 147</span></a><span class="sd">            The default is False.</span>
</span><span id="MeshingTools-148"><a href="#MeshingTools-148"><span class="linenos"> 148</span></a>
</span><span id="MeshingTools-149"><a href="#MeshingTools-149"><span class="linenos"> 149</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-150"><a href="#MeshingTools-150"><span class="linenos"> 150</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-151"><a href="#MeshingTools-151"><span class="linenos"> 151</span></a><span class="sd">        mesh_path_name : str</span>
</span><span id="MeshingTools-152"><a href="#MeshingTools-152"><span class="linenos"> 152</span></a><span class="sd">            Absolute path name of the created mesh file.</span>
</span><span id="MeshingTools-153"><a href="#MeshingTools-153"><span class="linenos"> 153</span></a>
</span><span id="MeshingTools-154"><a href="#MeshingTools-154"><span class="linenos"> 154</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-155"><a href="#MeshingTools-155"><span class="linenos"> 155</span></a>
</span><span id="MeshingTools-156"><a href="#MeshingTools-156"><span class="linenos"> 156</span></a>        <span class="c1"># Get keyword arguments</span>
</span><span id="MeshingTools-157"><a href="#MeshingTools-157"><span class="linenos"> 157</span></a>        <span class="n">ignored_tags</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ignored_tags&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="MeshingTools-158"><a href="#MeshingTools-158"><span class="linenos"> 158</span></a>        <span class="n">convert</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;convert&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-159"><a href="#MeshingTools-159"><span class="linenos"> 159</span></a>        <span class="n">embed_origin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;embed_origin&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MeshingTools-160"><a href="#MeshingTools-160"><span class="linenos"> 160</span></a>        <span class="n">origin_rf</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;origin_rf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="MeshingTools-161"><a href="#MeshingTools-161"><span class="linenos"> 161</span></a>        <span class="n">unique_boundary_tags</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unique_boundary_tags&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-162"><a href="#MeshingTools-162"><span class="linenos"> 162</span></a>        <span class="n">cylindrical_symmetry</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cylindrical_symmetry&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MeshingTools-163"><a href="#MeshingTools-163"><span class="linenos"> 163</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MeshingTools-164"><a href="#MeshingTools-164"><span class="linenos"> 164</span></a>        <span class="n">origin_tag</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MeshingTools-165"><a href="#MeshingTools-165"><span class="linenos"> 165</span></a>
</span><span id="MeshingTools-166"><a href="#MeshingTools-166"><span class="linenos"> 166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_subdomain</span><span class="p">()</span>
</span><span id="MeshingTools-167"><a href="#MeshingTools-167"><span class="linenos"> 167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-168"><a href="#MeshingTools-168"><span class="linenos"> 168</span></a>
</span><span id="MeshingTools-169"><a href="#MeshingTools-169"><span class="linenos"> 169</span></a>        <span class="k">if</span> <span class="n">cylindrical_symmetry</span><span class="p">:</span>
</span><span id="MeshingTools-170"><a href="#MeshingTools-170"><span class="linenos"> 170</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_cylindrical_symmetry</span><span class="p">()</span>
</span><span id="MeshingTools-171"><a href="#MeshingTools-171"><span class="linenos"> 171</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="MeshingTools-172"><a href="#MeshingTools-172"><span class="linenos"> 172</span></a>            <span class="n">origin_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="MeshingTools-173"><a href="#MeshingTools-173"><span class="linenos"> 173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-174"><a href="#MeshingTools-174"><span class="linenos"> 174</span></a>
</span><span id="MeshingTools-175"><a href="#MeshingTools-175"><span class="linenos"> 175</span></a>        <span class="c1"># Refinement settings</span>
</span><span id="MeshingTools-176"><a href="#MeshingTools-176"><span class="linenos"> 176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_refinement_settings</span><span class="p">(</span><span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">)</span>
</span><span id="MeshingTools-177"><a href="#MeshingTools-177"><span class="linenos"> 177</span></a>
</span><span id="MeshingTools-178"><a href="#MeshingTools-178"><span class="linenos"> 178</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>  <span class="c1"># Force the embedding of the origin to the mesh</span>
</span><span id="MeshingTools-179"><a href="#MeshingTools-179"><span class="linenos"> 179</span></a>            <span class="n">is_on_curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cylindrical_symmetry</span>
</span><span id="MeshingTools-180"><a href="#MeshingTools-180"><span class="linenos"> 180</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_embed_origin_to_mesh</span><span class="p">(</span><span class="n">origin_tag</span><span class="p">,</span> <span class="n">is_on_curve</span><span class="p">)</span>
</span><span id="MeshingTools-181"><a href="#MeshingTools-181"><span class="linenos"> 181</span></a>
</span><span id="MeshingTools-182"><a href="#MeshingTools-182"><span class="linenos"> 182</span></a>        <span class="c1"># Assign physical groups</span>
</span><span id="MeshingTools-183"><a href="#MeshingTools-183"><span class="linenos"> 183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assign_physical_groups</span><span class="p">(</span><span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span>
</span><span id="MeshingTools-184"><a href="#MeshingTools-184"><span class="linenos"> 184</span></a>                                     <span class="n">unique_boundary_tags</span><span class="p">)</span>
</span><span id="MeshingTools-185"><a href="#MeshingTools-185"><span class="linenos"> 185</span></a>
</span><span id="MeshingTools-186"><a href="#MeshingTools-186"><span class="linenos"> 186</span></a>        <span class="c1"># Actual mesh generation</span>
</span><span id="MeshingTools-187"><a href="#MeshingTools-187"><span class="linenos"> 187</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
</span><span id="MeshingTools-188"><a href="#MeshingTools-188"><span class="linenos"> 188</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">removeDuplicateNodes</span><span class="p">()</span>
</span><span id="MeshingTools-189"><a href="#MeshingTools-189"><span class="linenos"> 189</span></a>
</span><span id="MeshingTools-190"><a href="#MeshingTools-190"><span class="linenos"> 190</span></a>        <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Inspect the log:</span>
</span><span id="MeshingTools-191"><a href="#MeshingTools-191"><span class="linenos"> 191</span></a>            <span class="n">log</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="MeshingTools-192"><a href="#MeshingTools-192"><span class="linenos"> 192</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logger has recorded </span><span class="si">{}</span><span class="s2"> lines&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">log</span><span class="p">)))</span>
</span><span id="MeshingTools-193"><a href="#MeshingTools-193"><span class="linenos"> 193</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="MeshingTools-194"><a href="#MeshingTools-194"><span class="linenos"> 194</span></a>
</span><span id="MeshingTools-195"><a href="#MeshingTools-195"><span class="linenos"> 195</span></a>        <span class="k">if</span> <span class="n">show_mesh</span><span class="p">:</span>  <span class="c1"># open Gmsh graphical interface</span>
</span><span id="MeshingTools-196"><a href="#MeshingTools-196"><span class="linenos"> 196</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="MeshingTools-197"><a href="#MeshingTools-197"><span class="linenos"> 197</span></a>        <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="MeshingTools-198"><a href="#MeshingTools-198"><span class="linenos"> 198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools-199"><a href="#MeshingTools-199"><span class="linenos"> 199</span></a>
</span><span id="MeshingTools-200"><a href="#MeshingTools-200"><span class="linenos"> 200</span></a>        <span class="k">return</span> <span class="n">mesh_path_name</span>
</span><span id="MeshingTools-201"><a href="#MeshingTools-201"><span class="linenos"> 201</span></a>
</span><span id="MeshingTools-202"><a href="#MeshingTools-202"><span class="linenos"> 202</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_subdomain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="MeshingTools-203"><a href="#MeshingTools-203"><span class="linenos"> 203</span></a>                         <span class="n">cell_size_min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">cell_size_max</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="MeshingTools-204"><a href="#MeshingTools-204"><span class="linenos"> 204</span></a>                         <span class="n">dist_min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dist_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="MeshingTools-205"><a href="#MeshingTools-205"><span class="linenos"> 205</span></a>                         <span class="n">number_pts_per_curve</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="MeshingTools-206"><a href="#MeshingTools-206"><span class="linenos"> 206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-207"><a href="#MeshingTools-207"><span class="linenos"> 207</span></a><span class="sd">        Creates a subdomain from the shapes currently in an open gmsh window.</span>
</span><span id="MeshingTools-208"><a href="#MeshingTools-208"><span class="linenos"> 208</span></a><span class="sd">        Shapes already present in previous subdomains will not be added to the</span>
</span><span id="MeshingTools-209"><a href="#MeshingTools-209"><span class="linenos"> 209</span></a><span class="sd">        new one. This subdomain will be labeled by an index value corresponding</span>
</span><span id="MeshingTools-210"><a href="#MeshingTools-210"><span class="linenos"> 210</span></a><span class="sd">        to the next available integer value.</span>
</span><span id="MeshingTools-211"><a href="#MeshingTools-211"><span class="linenos"> 211</span></a><span class="sd">        The size of mesh cells at distances less than &#39;DistMin&#39; from the</span>
</span><span id="MeshingTools-212"><a href="#MeshingTools-212"><span class="linenos"> 212</span></a><span class="sd">        boundary of this subdomain will be &#39;SizeMin&#39;, while at distances</span>
</span><span id="MeshingTools-213"><a href="#MeshingTools-213"><span class="linenos"> 213</span></a><span class="sd">        greater than &#39;DistMax&#39; cell size is &#39;SizeMax&#39;. Between &#39;DistMin&#39;</span>
</span><span id="MeshingTools-214"><a href="#MeshingTools-214"><span class="linenos"> 214</span></a><span class="sd">        and &#39;DistMax&#39; cell size will increase linearly.</span>
</span><span id="MeshingTools-215"><a href="#MeshingTools-215"><span class="linenos"> 215</span></a>
</span><span id="MeshingTools-216"><a href="#MeshingTools-216"><span class="linenos"> 216</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-217"><a href="#MeshingTools-217"><span class="linenos"> 217</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-218"><a href="#MeshingTools-218"><span class="linenos"> 218</span></a><span class="sd">        cell_size_min : float, optional</span>
</span><span id="MeshingTools-219"><a href="#MeshingTools-219"><span class="linenos"> 219</span></a><span class="sd">            Minimum size of the mesh cells. The default is 0.1.</span>
</span><span id="MeshingTools-220"><a href="#MeshingTools-220"><span class="linenos"> 220</span></a><span class="sd">        cell_size_max : float, optional</span>
</span><span id="MeshingTools-221"><a href="#MeshingTools-221"><span class="linenos"> 221</span></a><span class="sd">            Maximum size of the mesh cells. The default is 0.1.</span>
</span><span id="MeshingTools-222"><a href="#MeshingTools-222"><span class="linenos"> 222</span></a><span class="sd">        dist_min : float, optional</span>
</span><span id="MeshingTools-223"><a href="#MeshingTools-223"><span class="linenos"> 223</span></a><span class="sd">            At distances less than this value, the cell size is set to its</span>
</span><span id="MeshingTools-224"><a href="#MeshingTools-224"><span class="linenos"> 224</span></a><span class="sd">            minimum. The default is 0.0.</span>
</span><span id="MeshingTools-225"><a href="#MeshingTools-225"><span class="linenos"> 225</span></a><span class="sd">        dist_max : float, optional</span>
</span><span id="MeshingTools-226"><a href="#MeshingTools-226"><span class="linenos"> 226</span></a><span class="sd">            At distances greater than this value, the cell size is set to its</span>
</span><span id="MeshingTools-227"><a href="#MeshingTools-227"><span class="linenos"> 227</span></a><span class="sd">            maximum. The default is 1.0.</span>
</span><span id="MeshingTools-228"><a href="#MeshingTools-228"><span class="linenos"> 228</span></a><span class="sd">        number_pts_per_curve : int, optional</span>
</span><span id="MeshingTools-229"><a href="#MeshingTools-229"><span class="linenos"> 229</span></a><span class="sd">            Number of points used to define each curve. The default is 1000.</span>
</span><span id="MeshingTools-230"><a href="#MeshingTools-230"><span class="linenos"> 230</span></a>
</span><span id="MeshingTools-231"><a href="#MeshingTools-231"><span class="linenos"> 231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-232"><a href="#MeshingTools-232"><span class="linenos"> 232</span></a>
</span><span id="MeshingTools-233"><a href="#MeshingTools-233"><span class="linenos"> 233</span></a>        <span class="c1"># Save sources, remove duplicates, and update the number of sources.</span>
</span><span id="MeshingTools-234"><a href="#MeshingTools-234"><span class="linenos"> 234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">))</span>
</span><span id="MeshingTools-235"><a href="#MeshingTools-235"><span class="linenos"> 235</span></a>        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span><span class="p">]</span>
</span><span id="MeshingTools-236"><a href="#MeshingTools-236"><span class="linenos"> 236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MeshingTools-237"><a href="#MeshingTools-237"><span class="linenos"> 237</span></a>
</span><span id="MeshingTools-238"><a href="#MeshingTools-238"><span class="linenos"> 238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="MeshingTools-239"><a href="#MeshingTools-239"><span class="linenos"> 239</span></a>
</span><span id="MeshingTools-240"><a href="#MeshingTools-240"><span class="linenos"> 240</span></a>            <span class="c1"># Save boundary information</span>
</span><span id="MeshingTools-241"><a href="#MeshingTools-241"><span class="linenos"> 241</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="MeshingTools-242"><a href="#MeshingTools-242"><span class="linenos"> 242</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span><span class="p">]</span>
</span><span id="MeshingTools-243"><a href="#MeshingTools-243"><span class="linenos"> 243</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MeshingTools-244"><a href="#MeshingTools-244"><span class="linenos"> 244</span></a>
</span><span id="MeshingTools-245"><a href="#MeshingTools-245"><span class="linenos"> 245</span></a>            <span class="c1"># Record refinement settings for this subdomain.</span>
</span><span id="MeshingTools-246"><a href="#MeshingTools-246"><span class="linenos"> 246</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">cell_size_min</span><span class="p">,</span> <span class="n">cell_size_max</span><span class="p">,</span>
</span><span id="MeshingTools-247"><a href="#MeshingTools-247"><span class="linenos"> 247</span></a>                                             <span class="n">dist_min</span><span class="p">,</span> <span class="n">dist_max</span><span class="p">,</span>
</span><span id="MeshingTools-248"><a href="#MeshingTools-248"><span class="linenos"> 248</span></a>                                             <span class="n">number_pts_per_curve</span><span class="p">])</span>
</span><span id="MeshingTools-249"><a href="#MeshingTools-249"><span class="linenos"> 249</span></a>
</span><span id="MeshingTools-250"><a href="#MeshingTools-250"><span class="linenos"> 250</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># new entry is empty</span>
</span><span id="MeshingTools-251"><a href="#MeshingTools-251"><span class="linenos"> 251</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MeshingTools-252"><a href="#MeshingTools-252"><span class="linenos"> 252</span></a>
</span><span id="MeshingTools-253"><a href="#MeshingTools-253"><span class="linenos"> 253</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="MeshingTools-254"><a href="#MeshingTools-254"><span class="linenos"> 254</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_inversed_exterior_domain_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MeshingTools-255"><a href="#MeshingTools-255"><span class="linenos"> 255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-256"><a href="#MeshingTools-256"><span class="linenos"> 256</span></a><span class="sd">        Create a solid sphere whose surface DOFs match the last created shape</span>
</span><span id="MeshingTools-257"><a href="#MeshingTools-257"><span class="linenos"> 257</span></a><span class="sd">        boundary. Because the exterior mesh has to be spatially separated from</span>
</span><span id="MeshingTools-258"><a href="#MeshingTools-258"><span class="linenos"> 258</span></a><span class="sd">        all other geometries, its center of mass is set three radii away from</span>
</span><span id="MeshingTools-259"><a href="#MeshingTools-259"><span class="linenos"> 259</span></a><span class="sd">        the interior domain along the x-axis.</span>
</span><span id="MeshingTools-260"><a href="#MeshingTools-260"><span class="linenos"> 260</span></a>
</span><span id="MeshingTools-261"><a href="#MeshingTools-261"><span class="linenos"> 261</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-262"><a href="#MeshingTools-262"><span class="linenos"> 262</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-263"><a href="#MeshingTools-263"><span class="linenos"> 263</span></a><span class="sd">        inversed_exterior_domain_3d : list</span>
</span><span id="MeshingTools-264"><a href="#MeshingTools-264"><span class="linenos"> 264</span></a><span class="sd">            List containing tuple representing the inversed exterior domain</span>
</span><span id="MeshingTools-265"><a href="#MeshingTools-265"><span class="linenos"> 265</span></a><span class="sd">            (which is a sphere).</span>
</span><span id="MeshingTools-266"><a href="#MeshingTools-266"><span class="linenos"> 266</span></a>
</span><span id="MeshingTools-267"><a href="#MeshingTools-267"><span class="linenos"> 267</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-268"><a href="#MeshingTools-268"><span class="linenos"> 268</span></a>
</span><span id="MeshingTools-269"><a href="#MeshingTools-269"><span class="linenos"> 269</span></a>        <span class="n">Rcut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Rcut</span>
</span><span id="MeshingTools-270"><a href="#MeshingTools-270"><span class="linenos"> 270</span></a>        <span class="k">if</span> <span class="n">Rcut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MeshingTools-271"><a href="#MeshingTools-271"><span class="linenos"> 271</span></a>            <span class="c1"># Retrieve Rc assuming the interior domain is spherical</span>
</span><span id="MeshingTools-272"><a href="#MeshingTools-272"><span class="linenos"> 272</span></a>            <span class="n">bb</span> <span class="o">=</span> <span class="n">numpyit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="MeshingTools-273"><a href="#MeshingTools-273"><span class="linenos"> 273</span></a>            <span class="n">Rcut</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="MeshingTools-274"><a href="#MeshingTools-274"><span class="linenos"> 274</span></a>            <span class="n">Rcut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Rcut</span><span class="p">))</span>
</span><span id="MeshingTools-275"><a href="#MeshingTools-275"><span class="linenos"> 275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Rcut</span> <span class="o">=</span> <span class="n">Rcut</span>
</span><span id="MeshingTools-276"><a href="#MeshingTools-276"><span class="linenos"> 276</span></a>
</span><span id="MeshingTools-277"><a href="#MeshingTools-277"><span class="linenos"> 277</span></a>        <span class="c1"># Retrieve master boundary</span>
</span><span id="MeshingTools-278"><a href="#MeshingTools-278"><span class="linenos"> 278</span></a>        <span class="n">master_tags</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="MeshingTools-279"><a href="#MeshingTools-279"><span class="linenos"> 279</span></a>
</span><span id="MeshingTools-280"><a href="#MeshingTools-280"><span class="linenos"> 280</span></a>        <span class="c1"># create new shape</span>
</span><span id="MeshingTools-281"><a href="#MeshingTools-281"><span class="linenos"> 281</span></a>        <span class="n">inversed_exterior_domain_3d</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span>
</span><span id="MeshingTools-282"><a href="#MeshingTools-282"><span class="linenos"> 282</span></a>            <span class="n">xc</span><span class="o">=</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">Rcut</span><span class="p">))]</span>
</span><span id="MeshingTools-283"><a href="#MeshingTools-283"><span class="linenos"> 283</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-284"><a href="#MeshingTools-284"><span class="linenos"> 284</span></a>        <span class="n">srf_tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getBoundary</span><span class="p">(</span><span class="n">inversed_exterior_domain_3d</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="MeshingTools-285"><a href="#MeshingTools-285"><span class="linenos"> 285</span></a>        <span class="n">translation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="MeshingTools-286"><a href="#MeshingTools-286"><span class="linenos"> 286</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setPeriodic</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">srf_tags</span><span class="p">,</span> <span class="n">master_tags</span><span class="p">,</span> <span class="n">translation</span><span class="p">)</span>
</span><span id="MeshingTools-287"><a href="#MeshingTools-287"><span class="linenos"> 287</span></a>
</span><span id="MeshingTools-288"><a href="#MeshingTools-288"><span class="linenos"> 288</span></a>        <span class="k">return</span> <span class="n">inversed_exterior_domain_3d</span>
</span><span id="MeshingTools-289"><a href="#MeshingTools-289"><span class="linenos"> 289</span></a>
</span><span id="MeshingTools-290"><a href="#MeshingTools-290"><span class="linenos"> 290</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="MeshingTools-291"><a href="#MeshingTools-291"><span class="linenos"> 291</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_ellipse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-292"><a href="#MeshingTools-292"><span class="linenos"> 292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-293"><a href="#MeshingTools-293"><span class="linenos"> 293</span></a><span class="sd">        Create an ellipse with given semi-major axis / semi-minor axis and</span>
</span><span id="MeshingTools-294"><a href="#MeshingTools-294"><span class="linenos"> 294</span></a><span class="sd">        center position.</span>
</span><span id="MeshingTools-295"><a href="#MeshingTools-295"><span class="linenos"> 295</span></a>
</span><span id="MeshingTools-296"><a href="#MeshingTools-296"><span class="linenos"> 296</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-297"><a href="#MeshingTools-297"><span class="linenos"> 297</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-298"><a href="#MeshingTools-298"><span class="linenos"> 298</span></a><span class="sd">        rx : float, optional</span>
</span><span id="MeshingTools-299"><a href="#MeshingTools-299"><span class="linenos"> 299</span></a><span class="sd">            Ellipse radial size along x-axis. The default is 0.1.</span>
</span><span id="MeshingTools-300"><a href="#MeshingTools-300"><span class="linenos"> 300</span></a><span class="sd">        ry : float, optional</span>
</span><span id="MeshingTools-301"><a href="#MeshingTools-301"><span class="linenos"> 301</span></a><span class="sd">            Ellipse radial size along y-axis. The default is 0.1.</span>
</span><span id="MeshingTools-302"><a href="#MeshingTools-302"><span class="linenos"> 302</span></a><span class="sd">        xc : float, optional</span>
</span><span id="MeshingTools-303"><a href="#MeshingTools-303"><span class="linenos"> 303</span></a><span class="sd">            Ellipse center along x-axis. The default is 0.0.</span>
</span><span id="MeshingTools-304"><a href="#MeshingTools-304"><span class="linenos"> 304</span></a><span class="sd">        yc : float, optional</span>
</span><span id="MeshingTools-305"><a href="#MeshingTools-305"><span class="linenos"> 305</span></a><span class="sd">            Ellipse center along y-axis. The defautl is 0.0.</span>
</span><span id="MeshingTools-306"><a href="#MeshingTools-306"><span class="linenos"> 306</span></a>
</span><span id="MeshingTools-307"><a href="#MeshingTools-307"><span class="linenos"> 307</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-308"><a href="#MeshingTools-308"><span class="linenos"> 308</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-309"><a href="#MeshingTools-309"><span class="linenos"> 309</span></a><span class="sd">        ellipse : list</span>
</span><span id="MeshingTools-310"><a href="#MeshingTools-310"><span class="linenos"> 310</span></a><span class="sd">            List containing the ellipse dimTag.</span>
</span><span id="MeshingTools-311"><a href="#MeshingTools-311"><span class="linenos"> 311</span></a>
</span><span id="MeshingTools-312"><a href="#MeshingTools-312"><span class="linenos"> 312</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-313"><a href="#MeshingTools-313"><span class="linenos"> 313</span></a>
</span><span id="MeshingTools-314"><a href="#MeshingTools-314"><span class="linenos"> 314</span></a>        <span class="n">rx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rx</span><span class="p">))</span>
</span><span id="MeshingTools-315"><a href="#MeshingTools-315"><span class="linenos"> 315</span></a>        <span class="n">ry</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ry</span><span class="p">))</span>
</span><span id="MeshingTools-316"><a href="#MeshingTools-316"><span class="linenos"> 316</span></a>
</span><span id="MeshingTools-317"><a href="#MeshingTools-317"><span class="linenos"> 317</span></a>        <span class="k">if</span> <span class="n">rx</span> <span class="o">&gt;=</span> <span class="n">ry</span><span class="p">:</span>
</span><span id="MeshingTools-318"><a href="#MeshingTools-318"><span class="linenos"> 318</span></a>            <span class="n">ellipse</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools-319"><a href="#MeshingTools-319"><span class="linenos"> 319</span></a>                                             <span class="n">rx</span><span class="o">=</span><span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="n">ry</span><span class="p">))]</span>
</span><span id="MeshingTools-320"><a href="#MeshingTools-320"><span class="linenos"> 320</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-321"><a href="#MeshingTools-321"><span class="linenos"> 321</span></a>            <span class="n">ellipse</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools-322"><a href="#MeshingTools-322"><span class="linenos"> 322</span></a>                                             <span class="n">rx</span><span class="o">=</span><span class="n">ry</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="n">rx</span><span class="p">))]</span>
</span><span id="MeshingTools-323"><a href="#MeshingTools-323"><span class="linenos"> 323</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">ellipse</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools-324"><a href="#MeshingTools-324"><span class="linenos"> 324</span></a>                             <span class="n">ax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span><span id="MeshingTools-325"><a href="#MeshingTools-325"><span class="linenos"> 325</span></a>        <span class="k">return</span> <span class="n">ellipse</span>
</span><span id="MeshingTools-326"><a href="#MeshingTools-326"><span class="linenos"> 326</span></a>
</span><span id="MeshingTools-327"><a href="#MeshingTools-327"><span class="linenos"> 327</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="MeshingTools-328"><a href="#MeshingTools-328"><span class="linenos"> 328</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_rectangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">xll</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yll</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">centered</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="MeshingTools-329"><a href="#MeshingTools-329"><span class="linenos"> 329</span></a>                         <span class="n">vperiodic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hperiodic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-330"><a href="#MeshingTools-330"><span class="linenos"> 330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-331"><a href="#MeshingTools-331"><span class="linenos"> 331</span></a><span class="sd">        Create a rectangle specified by its side lengths and position.</span>
</span><span id="MeshingTools-332"><a href="#MeshingTools-332"><span class="linenos"> 332</span></a>
</span><span id="MeshingTools-333"><a href="#MeshingTools-333"><span class="linenos"> 333</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-334"><a href="#MeshingTools-334"><span class="linenos"> 334</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-335"><a href="#MeshingTools-335"><span class="linenos"> 335</span></a><span class="sd">        dx : float, optional</span>
</span><span id="MeshingTools-336"><a href="#MeshingTools-336"><span class="linenos"> 336</span></a><span class="sd">            Length of rectangle along x-axis. The default is 1.0.</span>
</span><span id="MeshingTools-337"><a href="#MeshingTools-337"><span class="linenos"> 337</span></a><span class="sd">        dy : float, optional</span>
</span><span id="MeshingTools-338"><a href="#MeshingTools-338"><span class="linenos"> 338</span></a><span class="sd">            Length of rectangle along y-axis. The default is 1.0.</span>
</span><span id="MeshingTools-339"><a href="#MeshingTools-339"><span class="linenos"> 339</span></a><span class="sd">        xll : float, optional</span>
</span><span id="MeshingTools-340"><a href="#MeshingTools-340"><span class="linenos"> 340</span></a><span class="sd">            Low left corner x-coordinate. The default is 0.0.</span>
</span><span id="MeshingTools-341"><a href="#MeshingTools-341"><span class="linenos"> 341</span></a><span class="sd">        yll : float, optional</span>
</span><span id="MeshingTools-342"><a href="#MeshingTools-342"><span class="linenos"> 342</span></a><span class="sd">            Low left corner y-coordinate. The default is 0.0.</span>
</span><span id="MeshingTools-343"><a href="#MeshingTools-343"><span class="linenos"> 343</span></a><span class="sd">        centered : bool, optional</span>
</span><span id="MeshingTools-344"><a href="#MeshingTools-344"><span class="linenos"> 344</span></a><span class="sd">            Whether the rectangle is origin-centered. If True, ignores keyword</span>
</span><span id="MeshingTools-345"><a href="#MeshingTools-345"><span class="linenos"> 345</span></a><span class="sd">            parameters `xll` and `yll`. The default is False.</span>
</span><span id="MeshingTools-346"><a href="#MeshingTools-346"><span class="linenos"> 346</span></a><span class="sd">        vperiodic : bool, optional</span>
</span><span id="MeshingTools-347"><a href="#MeshingTools-347"><span class="linenos"> 347</span></a><span class="sd">            Whether the mesh is periodic in the vertical direction.</span>
</span><span id="MeshingTools-348"><a href="#MeshingTools-348"><span class="linenos"> 348</span></a><span class="sd">            The default is False.</span>
</span><span id="MeshingTools-349"><a href="#MeshingTools-349"><span class="linenos"> 349</span></a><span class="sd">        hperiodic : bool, optional</span>
</span><span id="MeshingTools-350"><a href="#MeshingTools-350"><span class="linenos"> 350</span></a><span class="sd">            Whether the mesh is periodic in the horizontal direction.</span>
</span><span id="MeshingTools-351"><a href="#MeshingTools-351"><span class="linenos"> 351</span></a><span class="sd">            The default is False.</span>
</span><span id="MeshingTools-352"><a href="#MeshingTools-352"><span class="linenos"> 352</span></a>
</span><span id="MeshingTools-353"><a href="#MeshingTools-353"><span class="linenos"> 353</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-354"><a href="#MeshingTools-354"><span class="linenos"> 354</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-355"><a href="#MeshingTools-355"><span class="linenos"> 355</span></a><span class="sd">        rectangle : list</span>
</span><span id="MeshingTools-356"><a href="#MeshingTools-356"><span class="linenos"> 356</span></a><span class="sd">            List containing the rectangle dimTag.</span>
</span><span id="MeshingTools-357"><a href="#MeshingTools-357"><span class="linenos"> 357</span></a>
</span><span id="MeshingTools-358"><a href="#MeshingTools-358"><span class="linenos"> 358</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-359"><a href="#MeshingTools-359"><span class="linenos"> 359</span></a>
</span><span id="MeshingTools-360"><a href="#MeshingTools-360"><span class="linenos"> 360</span></a>        <span class="n">dx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">))</span>
</span><span id="MeshingTools-361"><a href="#MeshingTools-361"><span class="linenos"> 361</span></a>        <span class="n">dy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">))</span>
</span><span id="MeshingTools-362"><a href="#MeshingTools-362"><span class="linenos"> 362</span></a>
</span><span id="MeshingTools-363"><a href="#MeshingTools-363"><span class="linenos"> 363</span></a>        <span class="k">if</span> <span class="n">centered</span><span class="p">:</span>
</span><span id="MeshingTools-364"><a href="#MeshingTools-364"><span class="linenos"> 364</span></a>            <span class="n">rectangle</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="n">dy</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools-365"><a href="#MeshingTools-365"><span class="linenos"> 365</span></a>                                                    <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">))]</span>
</span><span id="MeshingTools-366"><a href="#MeshingTools-366"><span class="linenos"> 366</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-367"><a href="#MeshingTools-367"><span class="linenos"> 367</span></a>            <span class="n">rectangle</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xll</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yll</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools-368"><a href="#MeshingTools-368"><span class="linenos"> 368</span></a>                                                    <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">))]</span>
</span><span id="MeshingTools-369"><a href="#MeshingTools-369"><span class="linenos"> 369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-370"><a href="#MeshingTools-370"><span class="linenos"> 370</span></a>
</span><span id="MeshingTools-371"><a href="#MeshingTools-371"><span class="linenos"> 371</span></a>        <span class="n">tags</span> <span class="o">=</span> <span class="n">MeshingTools</span><span class="o">.</span><span class="n">_extract_tags</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
</span><span id="MeshingTools-372"><a href="#MeshingTools-372"><span class="linenos"> 372</span></a>        <span class="k">if</span> <span class="n">vperiodic</span><span class="p">:</span>
</span><span id="MeshingTools-373"><a href="#MeshingTools-373"><span class="linenos"> 373</span></a>            <span class="n">vtranslation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="MeshingTools-374"><a href="#MeshingTools-374"><span class="linenos"> 374</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setPeriodic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">vtranslation</span><span class="p">)</span>
</span><span id="MeshingTools-375"><a href="#MeshingTools-375"><span class="linenos"> 375</span></a>
</span><span id="MeshingTools-376"><a href="#MeshingTools-376"><span class="linenos"> 376</span></a>        <span class="k">if</span> <span class="n">hperiodic</span><span class="p">:</span>
</span><span id="MeshingTools-377"><a href="#MeshingTools-377"><span class="linenos"> 377</span></a>            <span class="n">htranslation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="MeshingTools-378"><a href="#MeshingTools-378"><span class="linenos"> 378</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setPeriodic</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="p">[</span><span class="n">tags</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">htranslation</span><span class="p">)</span>
</span><span id="MeshingTools-379"><a href="#MeshingTools-379"><span class="linenos"> 379</span></a>
</span><span id="MeshingTools-380"><a href="#MeshingTools-380"><span class="linenos"> 380</span></a>        <span class="k">return</span> <span class="n">rectangle</span>
</span><span id="MeshingTools-381"><a href="#MeshingTools-381"><span class="linenos"> 381</span></a>
</span><span id="MeshingTools-382"><a href="#MeshingTools-382"><span class="linenos"> 382</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="MeshingTools-383"><a href="#MeshingTools-383"><span class="linenos"> 383</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_disk_from_pts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-384"><a href="#MeshingTools-384"><span class="linenos"> 384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-385"><a href="#MeshingTools-385"><span class="linenos"> 385</span></a><span class="sd">        @author: Hugo LÃ©vy</span>
</span><span id="MeshingTools-386"><a href="#MeshingTools-386"><span class="linenos"> 386</span></a><span class="sd">        Generates a disk with a given number of evenly spaced points across</span>
</span><span id="MeshingTools-387"><a href="#MeshingTools-387"><span class="linenos"> 387</span></a><span class="sd">        the circular boundary.</span>
</span><span id="MeshingTools-388"><a href="#MeshingTools-388"><span class="linenos"> 388</span></a>
</span><span id="MeshingTools-389"><a href="#MeshingTools-389"><span class="linenos"> 389</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-390"><a href="#MeshingTools-390"><span class="linenos"> 390</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-391"><a href="#MeshingTools-391"><span class="linenos"> 391</span></a><span class="sd">        radius : float</span>
</span><span id="MeshingTools-392"><a href="#MeshingTools-392"><span class="linenos"> 392</span></a><span class="sd">            Radius of the disk.</span>
</span><span id="MeshingTools-393"><a href="#MeshingTools-393"><span class="linenos"> 393</span></a><span class="sd">        N : int, optional</span>
</span><span id="MeshingTools-394"><a href="#MeshingTools-394"><span class="linenos"> 394</span></a><span class="sd">            Number of points defining the boundary. The default is 100.</span>
</span><span id="MeshingTools-395"><a href="#MeshingTools-395"><span class="linenos"> 395</span></a>
</span><span id="MeshingTools-396"><a href="#MeshingTools-396"><span class="linenos"> 396</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-397"><a href="#MeshingTools-397"><span class="linenos"> 397</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-398"><a href="#MeshingTools-398"><span class="linenos"> 398</span></a><span class="sd">        disk : list</span>
</span><span id="MeshingTools-399"><a href="#MeshingTools-399"><span class="linenos"> 399</span></a><span class="sd">            List containing the disk dimTag.</span>
</span><span id="MeshingTools-400"><a href="#MeshingTools-400"><span class="linenos"> 400</span></a>
</span><span id="MeshingTools-401"><a href="#MeshingTools-401"><span class="linenos"> 401</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-402"><a href="#MeshingTools-402"><span class="linenos"> 402</span></a>        <span class="n">angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">,</span> <span class="n">N</span><span class="p">))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MeshingTools-403"><a href="#MeshingTools-403"><span class="linenos"> 403</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span><span id="MeshingTools-404"><a href="#MeshingTools-404"><span class="linenos"> 404</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span><span id="MeshingTools-405"><a href="#MeshingTools-405"><span class="linenos"> 405</span></a>        <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="MeshingTools-406"><a href="#MeshingTools-406"><span class="linenos"> 406</span></a>        <span class="n">coors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MeshingTools-407"><a href="#MeshingTools-407"><span class="linenos"> 407</span></a>        <span class="n">disk</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">points_to_surface</span><span class="p">(</span><span class="n">coors</span><span class="p">)]</span>
</span><span id="MeshingTools-408"><a href="#MeshingTools-408"><span class="linenos"> 408</span></a>        <span class="k">return</span> <span class="n">disk</span>
</span><span id="MeshingTools-409"><a href="#MeshingTools-409"><span class="linenos"> 409</span></a>
</span><span id="MeshingTools-410"><a href="#MeshingTools-410"><span class="linenos"> 410</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="MeshingTools-411"><a href="#MeshingTools-411"><span class="linenos"> 411</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">points_to_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points_list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="MeshingTools-412"><a href="#MeshingTools-412"><span class="linenos"> 412</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-413"><a href="#MeshingTools-413"><span class="linenos"> 413</span></a><span class="sd">        Create a closed surface whose boundary is defined by a list of points.</span>
</span><span id="MeshingTools-414"><a href="#MeshingTools-414"><span class="linenos"> 414</span></a>
</span><span id="MeshingTools-415"><a href="#MeshingTools-415"><span class="linenos"> 415</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-416"><a href="#MeshingTools-416"><span class="linenos"> 416</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-417"><a href="#MeshingTools-417"><span class="linenos"> 417</span></a><span class="sd">        points_list : list or ndarray</span>
</span><span id="MeshingTools-418"><a href="#MeshingTools-418"><span class="linenos"> 418</span></a><span class="sd">            List containing the points which define the surface boundary.</span>
</span><span id="MeshingTools-419"><a href="#MeshingTools-419"><span class="linenos"> 419</span></a><span class="sd">            Each element of the list is a triplet (x, y, z) corresponding to</span>
</span><span id="MeshingTools-420"><a href="#MeshingTools-420"><span class="linenos"> 420</span></a><span class="sd">            the coordinates of the point it represents.</span>
</span><span id="MeshingTools-421"><a href="#MeshingTools-421"><span class="linenos"> 421</span></a>
</span><span id="MeshingTools-422"><a href="#MeshingTools-422"><span class="linenos"> 422</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-423"><a href="#MeshingTools-423"><span class="linenos"> 423</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-424"><a href="#MeshingTools-424"><span class="linenos"> 424</span></a><span class="sd">        surface_dimTag : tuple</span>
</span><span id="MeshingTools-425"><a href="#MeshingTools-425"><span class="linenos"> 425</span></a><span class="sd">            Tuple containing the dimension and tag (i.e. dimTag) of the</span>
</span><span id="MeshingTools-426"><a href="#MeshingTools-426"><span class="linenos"> 426</span></a><span class="sd">            created surface.</span>
</span><span id="MeshingTools-427"><a href="#MeshingTools-427"><span class="linenos"> 427</span></a>
</span><span id="MeshingTools-428"><a href="#MeshingTools-428"><span class="linenos"> 428</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-429"><a href="#MeshingTools-429"><span class="linenos"> 429</span></a>
</span><span id="MeshingTools-430"><a href="#MeshingTools-430"><span class="linenos"> 430</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="MeshingTools-431"><a href="#MeshingTools-431"><span class="linenos"> 431</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;&#39;points_list&#39; requires a minimum of 3 points.&quot;</span><span class="p">)</span>
</span><span id="MeshingTools-432"><a href="#MeshingTools-432"><span class="linenos"> 432</span></a>
</span><span id="MeshingTools-433"><a href="#MeshingTools-433"><span class="linenos"> 433</span></a>        <span class="n">Pl</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-434"><a href="#MeshingTools-434"><span class="linenos"> 434</span></a>        <span class="n">Ll</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-435"><a href="#MeshingTools-435"><span class="linenos"> 435</span></a>
</span><span id="MeshingTools-436"><a href="#MeshingTools-436"><span class="linenos"> 436</span></a>        <span class="c1"># Set points.</span>
</span><span id="MeshingTools-437"><a href="#MeshingTools-437"><span class="linenos"> 437</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points_list</span><span class="p">:</span>
</span><span id="MeshingTools-438"><a href="#MeshingTools-438"><span class="linenos"> 438</span></a>            <span class="n">Pl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span id="MeshingTools-439"><a href="#MeshingTools-439"><span class="linenos"> 439</span></a>
</span><span id="MeshingTools-440"><a href="#MeshingTools-440"><span class="linenos"> 440</span></a>        <span class="c1"># Join points as lines.</span>
</span><span id="MeshingTools-441"><a href="#MeshingTools-441"><span class="linenos"> 441</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points_list</span><span class="p">):</span>
</span><span id="MeshingTools-442"><a href="#MeshingTools-442"><span class="linenos"> 442</span></a>            <span class="n">Ll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">Pl</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Pl</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="MeshingTools-443"><a href="#MeshingTools-443"><span class="linenos"> 443</span></a>
</span><span id="MeshingTools-444"><a href="#MeshingTools-444"><span class="linenos"> 444</span></a>        <span class="c1"># Join lines as a closed loop and surface.</span>
</span><span id="MeshingTools-445"><a href="#MeshingTools-445"><span class="linenos"> 445</span></a>        <span class="n">sf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">Ll</span><span class="p">)</span>
</span><span id="MeshingTools-446"><a href="#MeshingTools-446"><span class="linenos"> 446</span></a>        <span class="n">surface_dimTag</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPlaneSurface</span><span class="p">([</span><span class="n">sf</span><span class="p">]))</span>
</span><span id="MeshingTools-447"><a href="#MeshingTools-447"><span class="linenos"> 447</span></a>
</span><span id="MeshingTools-448"><a href="#MeshingTools-448"><span class="linenos"> 448</span></a>        <span class="k">return</span> <span class="n">surface_dimTag</span>
</span><span id="MeshingTools-449"><a href="#MeshingTools-449"><span class="linenos"> 449</span></a>
</span><span id="MeshingTools-450"><a href="#MeshingTools-450"><span class="linenos"> 450</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="MeshingTools-451"><a href="#MeshingTools-451"><span class="linenos"> 451</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_ellipsoid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rx</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ry</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">rz</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="MeshingTools-452"><a href="#MeshingTools-452"><span class="linenos"> 452</span></a>                         <span class="n">xc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-453"><a href="#MeshingTools-453"><span class="linenos"> 453</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-454"><a href="#MeshingTools-454"><span class="linenos"> 454</span></a><span class="sd">        Create an ellipsoid specified by the length of its semi-axes.</span>
</span><span id="MeshingTools-455"><a href="#MeshingTools-455"><span class="linenos"> 455</span></a>
</span><span id="MeshingTools-456"><a href="#MeshingTools-456"><span class="linenos"> 456</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-457"><a href="#MeshingTools-457"><span class="linenos"> 457</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-458"><a href="#MeshingTools-458"><span class="linenos"> 458</span></a><span class="sd">        rx, ry, rz : float, optional</span>
</span><span id="MeshingTools-459"><a href="#MeshingTools-459"><span class="linenos"> 459</span></a><span class="sd">            Ellipsoid radial size along (x, y, z)-axis. The default is 0.1.</span>
</span><span id="MeshingTools-460"><a href="#MeshingTools-460"><span class="linenos"> 460</span></a><span class="sd">        xc, yc, zc : float, optional</span>
</span><span id="MeshingTools-461"><a href="#MeshingTools-461"><span class="linenos"> 461</span></a><span class="sd">            Ellipsoid center along (x, y, z)-axis. The default is 0.0.</span>
</span><span id="MeshingTools-462"><a href="#MeshingTools-462"><span class="linenos"> 462</span></a>
</span><span id="MeshingTools-463"><a href="#MeshingTools-463"><span class="linenos"> 463</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-464"><a href="#MeshingTools-464"><span class="linenos"> 464</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-465"><a href="#MeshingTools-465"><span class="linenos"> 465</span></a><span class="sd">        ellipsoid : list</span>
</span><span id="MeshingTools-466"><a href="#MeshingTools-466"><span class="linenos"> 466</span></a><span class="sd">            List containing the ellipsoid dimTag.</span>
</span><span id="MeshingTools-467"><a href="#MeshingTools-467"><span class="linenos"> 467</span></a>
</span><span id="MeshingTools-468"><a href="#MeshingTools-468"><span class="linenos"> 468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-469"><a href="#MeshingTools-469"><span class="linenos"> 469</span></a>
</span><span id="MeshingTools-470"><a href="#MeshingTools-470"><span class="linenos"> 470</span></a>        <span class="n">rx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rx</span><span class="p">))</span>
</span><span id="MeshingTools-471"><a href="#MeshingTools-471"><span class="linenos"> 471</span></a>        <span class="n">ry</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ry</span><span class="p">))</span>
</span><span id="MeshingTools-472"><a href="#MeshingTools-472"><span class="linenos"> 472</span></a>        <span class="n">rz</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rz</span><span class="p">))</span>
</span><span id="MeshingTools-473"><a href="#MeshingTools-473"><span class="linenos"> 473</span></a>
</span><span id="MeshingTools-474"><a href="#MeshingTools-474"><span class="linenos"> 474</span></a>        <span class="n">ellipsoid</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="n">zc</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">))]</span>
</span><span id="MeshingTools-475"><a href="#MeshingTools-475"><span class="linenos"> 475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">ellipsoid</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yc</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">zc</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">rx</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">ry</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">rz</span><span class="p">)</span>
</span><span id="MeshingTools-476"><a href="#MeshingTools-476"><span class="linenos"> 476</span></a>
</span><span id="MeshingTools-477"><a href="#MeshingTools-477"><span class="linenos"> 477</span></a>        <span class="k">return</span> <span class="n">ellipsoid</span>
</span><span id="MeshingTools-478"><a href="#MeshingTools-478"><span class="linenos"> 478</span></a>
</span><span id="MeshingTools-479"><a href="#MeshingTools-479"><span class="linenos"> 479</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="MeshingTools-480"><a href="#MeshingTools-480"><span class="linenos"> 480</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-481"><a href="#MeshingTools-481"><span class="linenos"> 481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-482"><a href="#MeshingTools-482"><span class="linenos"> 482</span></a><span class="sd">        Create a box specified by its side lengths and centered at the origin.</span>
</span><span id="MeshingTools-483"><a href="#MeshingTools-483"><span class="linenos"> 483</span></a>
</span><span id="MeshingTools-484"><a href="#MeshingTools-484"><span class="linenos"> 484</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-485"><a href="#MeshingTools-485"><span class="linenos"> 485</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-486"><a href="#MeshingTools-486"><span class="linenos"> 486</span></a><span class="sd">        dx, dy, dz : float, optional</span>
</span><span id="MeshingTools-487"><a href="#MeshingTools-487"><span class="linenos"> 487</span></a><span class="sd">            Length of box along (x, y, z)-axis. The default is 0.2.</span>
</span><span id="MeshingTools-488"><a href="#MeshingTools-488"><span class="linenos"> 488</span></a>
</span><span id="MeshingTools-489"><a href="#MeshingTools-489"><span class="linenos"> 489</span></a>
</span><span id="MeshingTools-490"><a href="#MeshingTools-490"><span class="linenos"> 490</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-491"><a href="#MeshingTools-491"><span class="linenos"> 491</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-492"><a href="#MeshingTools-492"><span class="linenos"> 492</span></a><span class="sd">        box : list tuple</span>
</span><span id="MeshingTools-493"><a href="#MeshingTools-493"><span class="linenos"> 493</span></a><span class="sd">            List containing the box dimTag.</span>
</span><span id="MeshingTools-494"><a href="#MeshingTools-494"><span class="linenos"> 494</span></a>
</span><span id="MeshingTools-495"><a href="#MeshingTools-495"><span class="linenos"> 495</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-496"><a href="#MeshingTools-496"><span class="linenos"> 496</span></a>
</span><span id="MeshingTools-497"><a href="#MeshingTools-497"><span class="linenos"> 497</span></a>        <span class="n">dx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dx</span><span class="p">))</span>
</span><span id="MeshingTools-498"><a href="#MeshingTools-498"><span class="linenos"> 498</span></a>        <span class="n">dy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">))</span>
</span><span id="MeshingTools-499"><a href="#MeshingTools-499"><span class="linenos"> 499</span></a>        <span class="n">dz</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dz</span><span class="p">))</span>
</span><span id="MeshingTools-500"><a href="#MeshingTools-500"><span class="linenos"> 500</span></a>
</span><span id="MeshingTools-501"><a href="#MeshingTools-501"><span class="linenos"> 501</span></a>        <span class="n">box</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addBox</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="n">dy</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="n">dz</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="MeshingTools-502"><a href="#MeshingTools-502"><span class="linenos"> 502</span></a>                                    <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">))]</span>
</span><span id="MeshingTools-503"><a href="#MeshingTools-503"><span class="linenos"> 503</span></a>
</span><span id="MeshingTools-504"><a href="#MeshingTools-504"><span class="linenos"> 504</span></a>        <span class="k">return</span> <span class="n">box</span>
</span><span id="MeshingTools-505"><a href="#MeshingTools-505"><span class="linenos"> 505</span></a>
</span><span id="MeshingTools-506"><a href="#MeshingTools-506"><span class="linenos"> 506</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="MeshingTools-507"><a href="#MeshingTools-507"><span class="linenos"> 507</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_cylinder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="MeshingTools-508"><a href="#MeshingTools-508"><span class="linenos"> 508</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-509"><a href="#MeshingTools-509"><span class="linenos"> 509</span></a><span class="sd">        @author: Chad Briddon</span>
</span><span id="MeshingTools-510"><a href="#MeshingTools-510"><span class="linenos"> 510</span></a><span class="sd">        Create a cylinder</span>
</span><span id="MeshingTools-511"><a href="#MeshingTools-511"><span class="linenos"> 511</span></a>
</span><span id="MeshingTools-512"><a href="#MeshingTools-512"><span class="linenos"> 512</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-513"><a href="#MeshingTools-513"><span class="linenos"> 513</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-514"><a href="#MeshingTools-514"><span class="linenos"> 514</span></a><span class="sd">        height : float, optional</span>
</span><span id="MeshingTools-515"><a href="#MeshingTools-515"><span class="linenos"> 515</span></a><span class="sd">            Length of cylinder. The default is 0.1.</span>
</span><span id="MeshingTools-516"><a href="#MeshingTools-516"><span class="linenos"> 516</span></a><span class="sd">        radius : float, optional</span>
</span><span id="MeshingTools-517"><a href="#MeshingTools-517"><span class="linenos"> 517</span></a><span class="sd">            Radial size of cylinder. The default is 0.1.</span>
</span><span id="MeshingTools-518"><a href="#MeshingTools-518"><span class="linenos"> 518</span></a>
</span><span id="MeshingTools-519"><a href="#MeshingTools-519"><span class="linenos"> 519</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-520"><a href="#MeshingTools-520"><span class="linenos"> 520</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-521"><a href="#MeshingTools-521"><span class="linenos"> 521</span></a><span class="sd">        cylinder : list tuple</span>
</span><span id="MeshingTools-522"><a href="#MeshingTools-522"><span class="linenos"> 522</span></a><span class="sd">            List containing the cylinder dimTag.</span>
</span><span id="MeshingTools-523"><a href="#MeshingTools-523"><span class="linenos"> 523</span></a>
</span><span id="MeshingTools-524"><a href="#MeshingTools-524"><span class="linenos"> 524</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-525"><a href="#MeshingTools-525"><span class="linenos"> 525</span></a>
</span><span id="MeshingTools-526"><a href="#MeshingTools-526"><span class="linenos"> 526</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">height</span><span class="p">))</span>
</span><span id="MeshingTools-527"><a href="#MeshingTools-527"><span class="linenos"> 527</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">radius</span><span class="p">))</span>
</span><span id="MeshingTools-528"><a href="#MeshingTools-528"><span class="linenos"> 528</span></a>
</span><span id="MeshingTools-529"><a href="#MeshingTools-529"><span class="linenos"> 529</span></a>        <span class="n">cylinder</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addCylinder</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="n">h</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="MeshingTools-530"><a href="#MeshingTools-530"><span class="linenos"> 530</span></a>                                              <span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">))]</span>
</span><span id="MeshingTools-531"><a href="#MeshingTools-531"><span class="linenos"> 531</span></a>
</span><span id="MeshingTools-532"><a href="#MeshingTools-532"><span class="linenos"> 532</span></a>        <span class="k">return</span> <span class="n">cylinder</span>
</span><span id="MeshingTools-533"><a href="#MeshingTools-533"><span class="linenos"> 533</span></a>
</span><span id="MeshingTools-534"><a href="#MeshingTools-534"><span class="linenos"> 534</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="MeshingTools-535"><a href="#MeshingTools-535"><span class="linenos"> 535</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_torus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r_hole</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">r_tube</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-536"><a href="#MeshingTools-536"><span class="linenos"> 536</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-537"><a href="#MeshingTools-537"><span class="linenos"> 537</span></a><span class="sd">        @author: Chad Briddon</span>
</span><span id="MeshingTools-538"><a href="#MeshingTools-538"><span class="linenos"> 538</span></a><span class="sd">        Generates a torus in an open gmsh window with its centre of mass at</span>
</span><span id="MeshingTools-539"><a href="#MeshingTools-539"><span class="linenos"> 539</span></a><span class="sd">        the origin.</span>
</span><span id="MeshingTools-540"><a href="#MeshingTools-540"><span class="linenos"> 540</span></a>
</span><span id="MeshingTools-541"><a href="#MeshingTools-541"><span class="linenos"> 541</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-542"><a href="#MeshingTools-542"><span class="linenos"> 542</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-543"><a href="#MeshingTools-543"><span class="linenos"> 543</span></a><span class="sd">        r_hole : float, optional</span>
</span><span id="MeshingTools-544"><a href="#MeshingTools-544"><span class="linenos"> 544</span></a><span class="sd">            Radius of hole through centre of the torus. The default is 0.1.</span>
</span><span id="MeshingTools-545"><a href="#MeshingTools-545"><span class="linenos"> 545</span></a><span class="sd">        r_tube : float, optional</span>
</span><span id="MeshingTools-546"><a href="#MeshingTools-546"><span class="linenos"> 546</span></a><span class="sd">            Radius of the torus tube. The default is 0.1.</span>
</span><span id="MeshingTools-547"><a href="#MeshingTools-547"><span class="linenos"> 547</span></a>
</span><span id="MeshingTools-548"><a href="#MeshingTools-548"><span class="linenos"> 548</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-549"><a href="#MeshingTools-549"><span class="linenos"> 549</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-550"><a href="#MeshingTools-550"><span class="linenos"> 550</span></a><span class="sd">        torus : list tuple</span>
</span><span id="MeshingTools-551"><a href="#MeshingTools-551"><span class="linenos"> 551</span></a><span class="sd">            List containing the torus dimTag.</span>
</span><span id="MeshingTools-552"><a href="#MeshingTools-552"><span class="linenos"> 552</span></a>
</span><span id="MeshingTools-553"><a href="#MeshingTools-553"><span class="linenos"> 553</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-554"><a href="#MeshingTools-554"><span class="linenos"> 554</span></a>
</span><span id="MeshingTools-555"><a href="#MeshingTools-555"><span class="linenos"> 555</span></a>        <span class="n">r_hole</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r_hole</span><span class="p">))</span>
</span><span id="MeshingTools-556"><a href="#MeshingTools-556"><span class="linenos"> 556</span></a>        <span class="n">r_tube</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">r_tube</span><span class="p">))</span>
</span><span id="MeshingTools-557"><a href="#MeshingTools-557"><span class="linenos"> 557</span></a>
</span><span id="MeshingTools-558"><a href="#MeshingTools-558"><span class="linenos"> 558</span></a>        <span class="n">torus</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addTorus</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools-559"><a href="#MeshingTools-559"><span class="linenos"> 559</span></a>                                        <span class="n">r1</span><span class="o">=</span><span class="n">r_hole</span><span class="o">+</span><span class="n">r_tube</span><span class="p">,</span> <span class="n">r2</span><span class="o">=</span><span class="n">r_tube</span><span class="p">))]</span>
</span><span id="MeshingTools-560"><a href="#MeshingTools-560"><span class="linenos"> 560</span></a>        <span class="k">return</span> <span class="n">torus</span>
</span><span id="MeshingTools-561"><a href="#MeshingTools-561"><span class="linenos"> 561</span></a>
</span><span id="MeshingTools-562"><a href="#MeshingTools-562"><span class="linenos"> 562</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="MeshingTools-563"><a href="#MeshingTools-563"><span class="linenos"> 563</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">points_to_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contour_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="MeshingTools-564"><a href="#MeshingTools-564"><span class="linenos"> 564</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-565"><a href="#MeshingTools-565"><span class="linenos"> 565</span></a><span class="sd">        Creates a closed volume whose boundary is defined by list of contours.</span>
</span><span id="MeshingTools-566"><a href="#MeshingTools-566"><span class="linenos"> 566</span></a>
</span><span id="MeshingTools-567"><a href="#MeshingTools-567"><span class="linenos"> 567</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-568"><a href="#MeshingTools-568"><span class="linenos"> 568</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-569"><a href="#MeshingTools-569"><span class="linenos"> 569</span></a><span class="sd">        contour_list : list</span>
</span><span id="MeshingTools-570"><a href="#MeshingTools-570"><span class="linenos"> 570</span></a><span class="sd">            List containing the contours which define the volume boundary. The</span>
</span><span id="MeshingTools-571"><a href="#MeshingTools-571"><span class="linenos"> 571</span></a><span class="sd">            contours are themselves a list whose elements are lists, each</span>
</span><span id="MeshingTools-572"><a href="#MeshingTools-572"><span class="linenos"> 572</span></a><span class="sd">            containing the x, y, and z coordinates of the point it represents.</span>
</span><span id="MeshingTools-573"><a href="#MeshingTools-573"><span class="linenos"> 573</span></a>
</span><span id="MeshingTools-574"><a href="#MeshingTools-574"><span class="linenos"> 574</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-575"><a href="#MeshingTools-575"><span class="linenos"> 575</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-576"><a href="#MeshingTools-576"><span class="linenos"> 576</span></a><span class="sd">        volume_dimTag : tuple</span>
</span><span id="MeshingTools-577"><a href="#MeshingTools-577"><span class="linenos"> 577</span></a><span class="sd">            Tuple containing the dimension and tag of the generated volume.</span>
</span><span id="MeshingTools-578"><a href="#MeshingTools-578"><span class="linenos"> 578</span></a>
</span><span id="MeshingTools-579"><a href="#MeshingTools-579"><span class="linenos"> 579</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-580"><a href="#MeshingTools-580"><span class="linenos"> 580</span></a>
</span><span id="MeshingTools-581"><a href="#MeshingTools-581"><span class="linenos"> 581</span></a>        <span class="k">for</span> <span class="n">points_list</span> <span class="ow">in</span> <span class="n">contour_list</span><span class="p">:</span>
</span><span id="MeshingTools-582"><a href="#MeshingTools-582"><span class="linenos"> 582</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="MeshingTools-583"><a href="#MeshingTools-583"><span class="linenos"> 583</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="MeshingTools-584"><a href="#MeshingTools-584"><span class="linenos"> 584</span></a>                    <span class="s2">&quot;One or more contours does not have enough points. (min 3)&quot;</span>
</span><span id="MeshingTools-585"><a href="#MeshingTools-585"><span class="linenos"> 585</span></a>                <span class="p">)</span>
</span><span id="MeshingTools-586"><a href="#MeshingTools-586"><span class="linenos"> 586</span></a>
</span><span id="MeshingTools-587"><a href="#MeshingTools-587"><span class="linenos"> 587</span></a>        <span class="n">L_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-588"><a href="#MeshingTools-588"><span class="linenos"> 588</span></a>        <span class="k">for</span> <span class="n">points_list</span> <span class="ow">in</span> <span class="n">contour_list</span><span class="p">:</span>
</span><span id="MeshingTools-589"><a href="#MeshingTools-589"><span class="linenos"> 589</span></a>            <span class="c1"># Create data lists.</span>
</span><span id="MeshingTools-590"><a href="#MeshingTools-590"><span class="linenos"> 590</span></a>            <span class="n">Pl</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-591"><a href="#MeshingTools-591"><span class="linenos"> 591</span></a>            <span class="n">Ll</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-592"><a href="#MeshingTools-592"><span class="linenos"> 592</span></a>
</span><span id="MeshingTools-593"><a href="#MeshingTools-593"><span class="linenos"> 593</span></a>            <span class="c1"># Set points.</span>
</span><span id="MeshingTools-594"><a href="#MeshingTools-594"><span class="linenos"> 594</span></a>            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points_list</span><span class="p">:</span>
</span><span id="MeshingTools-595"><a href="#MeshingTools-595"><span class="linenos"> 595</span></a>                <span class="n">Pl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span id="MeshingTools-596"><a href="#MeshingTools-596"><span class="linenos"> 596</span></a>
</span><span id="MeshingTools-597"><a href="#MeshingTools-597"><span class="linenos"> 597</span></a>            <span class="c1"># Join points as lines.</span>
</span><span id="MeshingTools-598"><a href="#MeshingTools-598"><span class="linenos"> 598</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points_list</span><span class="p">):</span>
</span><span id="MeshingTools-599"><a href="#MeshingTools-599"><span class="linenos"> 599</span></a>                <span class="n">Ll</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addLine</span><span class="p">(</span><span class="n">Pl</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Pl</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="MeshingTools-600"><a href="#MeshingTools-600"><span class="linenos"> 600</span></a>
</span><span id="MeshingTools-601"><a href="#MeshingTools-601"><span class="linenos"> 601</span></a>            <span class="c1"># Join lines as a closed loop and surface.</span>
</span><span id="MeshingTools-602"><a href="#MeshingTools-602"><span class="linenos"> 602</span></a>            <span class="n">L_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addCurveLoop</span><span class="p">(</span><span class="n">Ll</span><span class="p">))</span>
</span><span id="MeshingTools-603"><a href="#MeshingTools-603"><span class="linenos"> 603</span></a>
</span><span id="MeshingTools-604"><a href="#MeshingTools-604"><span class="linenos"> 604</span></a>        <span class="n">volume_dimTag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addThruSections</span><span class="p">(</span><span class="n">L_list</span><span class="p">)</span>
</span><span id="MeshingTools-605"><a href="#MeshingTools-605"><span class="linenos"> 605</span></a>
</span><span id="MeshingTools-606"><a href="#MeshingTools-606"><span class="linenos"> 606</span></a>        <span class="c1"># Delete contour lines.</span>
</span><span id="MeshingTools-607"><a href="#MeshingTools-607"><span class="linenos"> 607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-608"><a href="#MeshingTools-608"><span class="linenos"> 608</span></a>
</span><span id="MeshingTools-609"><a href="#MeshingTools-609"><span class="linenos"> 609</span></a>        <span class="k">return</span> <span class="n">volume_dimTag</span>
</span><span id="MeshingTools-610"><a href="#MeshingTools-610"><span class="linenos"> 610</span></a>
</span><span id="MeshingTools-611"><a href="#MeshingTools-611"><span class="linenos"> 611</span></a>    <span class="nd">@Decorators</span><span class="o">.</span><span class="n">check_dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="MeshingTools-612"><a href="#MeshingTools-612"><span class="linenos"> 612</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">rectangle_cutout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_dimTags</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">xll</span><span class="p">,</span> <span class="n">yll</span><span class="p">):</span>
</span><span id="MeshingTools-613"><a href="#MeshingTools-613"><span class="linenos"> 613</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-614"><a href="#MeshingTools-614"><span class="linenos"> 614</span></a><span class="sd">        Intersect the provided shapes with a rectangle (truncation).</span>
</span><span id="MeshingTools-615"><a href="#MeshingTools-615"><span class="linenos"> 615</span></a>
</span><span id="MeshingTools-616"><a href="#MeshingTools-616"><span class="linenos"> 616</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-617"><a href="#MeshingTools-617"><span class="linenos"> 617</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-618"><a href="#MeshingTools-618"><span class="linenos"> 618</span></a><span class="sd">        shapes_dimTags : list</span>
</span><span id="MeshingTools-619"><a href="#MeshingTools-619"><span class="linenos"> 619</span></a><span class="sd">            List of dimTags associated with the shapes to be cutout.</span>
</span><span id="MeshingTools-620"><a href="#MeshingTools-620"><span class="linenos"> 620</span></a><span class="sd">        dx : float</span>
</span><span id="MeshingTools-621"><a href="#MeshingTools-621"><span class="linenos"> 621</span></a><span class="sd">            Length of rectangle along x-axis.</span>
</span><span id="MeshingTools-622"><a href="#MeshingTools-622"><span class="linenos"> 622</span></a><span class="sd">        dy : float</span>
</span><span id="MeshingTools-623"><a href="#MeshingTools-623"><span class="linenos"> 623</span></a><span class="sd">            Length of rectangle along y-axis.</span>
</span><span id="MeshingTools-624"><a href="#MeshingTools-624"><span class="linenos"> 624</span></a><span class="sd">        xll : float</span>
</span><span id="MeshingTools-625"><a href="#MeshingTools-625"><span class="linenos"> 625</span></a><span class="sd">            Low left corner x-coordinate.</span>
</span><span id="MeshingTools-626"><a href="#MeshingTools-626"><span class="linenos"> 626</span></a><span class="sd">        yll : float</span>
</span><span id="MeshingTools-627"><a href="#MeshingTools-627"><span class="linenos"> 627</span></a><span class="sd">            Low left corner y-coordinate.</span>
</span><span id="MeshingTools-628"><a href="#MeshingTools-628"><span class="linenos"> 628</span></a>
</span><span id="MeshingTools-629"><a href="#MeshingTools-629"><span class="linenos"> 629</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-630"><a href="#MeshingTools-630"><span class="linenos"> 630</span></a>
</span><span id="MeshingTools-631"><a href="#MeshingTools-631"><span class="linenos"> 631</span></a>        <span class="n">concatenated_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shapes_dimTags</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
</span><span id="MeshingTools-632"><a href="#MeshingTools-632"><span class="linenos"> 632</span></a>        <span class="n">tool_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addRectangle</span><span class="p">(</span><span class="n">xll</span><span class="p">,</span> <span class="n">yll</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="MeshingTools-633"><a href="#MeshingTools-633"><span class="linenos"> 633</span></a>        <span class="n">tool_dimTags</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">tool_tag</span><span class="p">)]</span>
</span><span id="MeshingTools-634"><a href="#MeshingTools-634"><span class="linenos"> 634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-635"><a href="#MeshingTools-635"><span class="linenos"> 635</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">objectDimTags</span><span class="o">=</span><span class="n">concatenated_shapes</span><span class="p">,</span>
</span><span id="MeshingTools-636"><a href="#MeshingTools-636"><span class="linenos"> 636</span></a>                            <span class="n">toolDimTags</span><span class="o">=</span><span class="n">tool_dimTags</span><span class="p">)</span>
</span><span id="MeshingTools-637"><a href="#MeshingTools-637"><span class="linenos"> 637</span></a>
</span><span id="MeshingTools-638"><a href="#MeshingTools-638"><span class="linenos"> 638</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">radial_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_dimTags</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="MeshingTools-639"><a href="#MeshingTools-639"><span class="linenos"> 639</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-640"><a href="#MeshingTools-640"><span class="linenos"> 640</span></a><span class="sd">        Intersect the provided shapes with a disk (truncation).</span>
</span><span id="MeshingTools-641"><a href="#MeshingTools-641"><span class="linenos"> 641</span></a>
</span><span id="MeshingTools-642"><a href="#MeshingTools-642"><span class="linenos"> 642</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-643"><a href="#MeshingTools-643"><span class="linenos"> 643</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-644"><a href="#MeshingTools-644"><span class="linenos"> 644</span></a><span class="sd">        shapes_dimTags : list</span>
</span><span id="MeshingTools-645"><a href="#MeshingTools-645"><span class="linenos"> 645</span></a><span class="sd">            List of dimTags associated with the shapes to be cutout.</span>
</span><span id="MeshingTools-646"><a href="#MeshingTools-646"><span class="linenos"> 646</span></a><span class="sd">        cutoff_radius : float, optional</span>
</span><span id="MeshingTools-647"><a href="#MeshingTools-647"><span class="linenos"> 647</span></a><span class="sd">            The radial size of the cutoff. Any part of a shape that is further</span>
</span><span id="MeshingTools-648"><a href="#MeshingTools-648"><span class="linenos"> 648</span></a><span class="sd">            away from the origin than this radius will be erased.</span>
</span><span id="MeshingTools-649"><a href="#MeshingTools-649"><span class="linenos"> 649</span></a><span class="sd">            The default is 1.0.</span>
</span><span id="MeshingTools-650"><a href="#MeshingTools-650"><span class="linenos"> 650</span></a>
</span><span id="MeshingTools-651"><a href="#MeshingTools-651"><span class="linenos"> 651</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-652"><a href="#MeshingTools-652"><span class="linenos"> 652</span></a>        <span class="n">dim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shapes_dimTags</span><span class="p">])</span>  <span class="c1"># dimension of shapes</span>
</span><span id="MeshingTools-653"><a href="#MeshingTools-653"><span class="linenos"> 653</span></a>
</span><span id="MeshingTools-654"><a href="#MeshingTools-654"><span class="linenos"> 654</span></a>        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="MeshingTools-655"><a href="#MeshingTools-655"><span class="linenos"> 655</span></a>            <span class="n">cutoff</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools-656"><a href="#MeshingTools-656"><span class="linenos"> 656</span></a>                                              <span class="n">radius</span><span class="o">=</span><span class="n">cutoff_radius</span><span class="p">))]</span>
</span><span id="MeshingTools-657"><a href="#MeshingTools-657"><span class="linenos"> 657</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="MeshingTools-658"><a href="#MeshingTools-658"><span class="linenos"> 658</span></a>            <span class="n">cutoff</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span>
</span><span id="MeshingTools-659"><a href="#MeshingTools-659"><span class="linenos"> 659</span></a>                                            <span class="n">cutoff_radius</span><span class="p">))]</span>
</span><span id="MeshingTools-660"><a href="#MeshingTools-660"><span class="linenos"> 660</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-661"><a href="#MeshingTools-661"><span class="linenos"> 661</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No cutoff for 1D shapes!&quot;</span><span class="p">)</span>
</span><span id="MeshingTools-662"><a href="#MeshingTools-662"><span class="linenos"> 662</span></a>
</span><span id="MeshingTools-663"><a href="#MeshingTools-663"><span class="linenos"> 663</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-664"><a href="#MeshingTools-664"><span class="linenos"> 664</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">objectDimTags</span><span class="o">=</span><span class="n">shapes_dimTags</span><span class="p">,</span> <span class="n">toolDimTags</span><span class="o">=</span><span class="n">cutoff</span><span class="p">)</span>
</span><span id="MeshingTools-665"><a href="#MeshingTools-665"><span class="linenos"> 665</span></a>
</span><span id="MeshingTools-666"><a href="#MeshingTools-666"><span class="linenos"> 666</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-667"><a href="#MeshingTools-667"><span class="linenos"> 667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-668"><a href="#MeshingTools-668"><span class="linenos"> 668</span></a><span class="sd">        Fuse together elements of `shapes_1` and `shapes_2` to form new group</span>
</span><span id="MeshingTools-669"><a href="#MeshingTools-669"><span class="linenos"> 669</span></a><span class="sd">        of shapes.</span>
</span><span id="MeshingTools-670"><a href="#MeshingTools-670"><span class="linenos"> 670</span></a>
</span><span id="MeshingTools-671"><a href="#MeshingTools-671"><span class="linenos"> 671</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-672"><a href="#MeshingTools-672"><span class="linenos"> 672</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-673"><a href="#MeshingTools-673"><span class="linenos"> 673</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="MeshingTools-674"><a href="#MeshingTools-674"><span class="linenos"> 674</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools-675"><a href="#MeshingTools-675"><span class="linenos"> 675</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools-676"><a href="#MeshingTools-676"><span class="linenos"> 676</span></a>
</span><span id="MeshingTools-677"><a href="#MeshingTools-677"><span class="linenos"> 677</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-678"><a href="#MeshingTools-678"><span class="linenos"> 678</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-679"><a href="#MeshingTools-679"><span class="linenos"> 679</span></a><span class="sd">        new_shapes : list</span>
</span><span id="MeshingTools-680"><a href="#MeshingTools-680"><span class="linenos"> 680</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="MeshingTools-681"><a href="#MeshingTools-681"><span class="linenos"> 681</span></a>
</span><span id="MeshingTools-682"><a href="#MeshingTools-682"><span class="linenos"> 682</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-683"><a href="#MeshingTools-683"><span class="linenos"> 683</span></a>
</span><span id="MeshingTools-684"><a href="#MeshingTools-684"><span class="linenos"> 684</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools-685"><a href="#MeshingTools-685"><span class="linenos"> 685</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">fuse</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">,</span>
</span><span id="MeshingTools-686"><a href="#MeshingTools-686"><span class="linenos"> 686</span></a>                                           <span class="n">removeObject</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="MeshingTools-687"><a href="#MeshingTools-687"><span class="linenos"> 687</span></a>                                           <span class="n">removeTool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MeshingTools-688"><a href="#MeshingTools-688"><span class="linenos"> 688</span></a>            <span class="c1"># Get rid of unneeded shapes</span>
</span><span id="MeshingTools-689"><a href="#MeshingTools-689"><span class="linenos"> 689</span></a>            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes_1</span><span class="p">:</span>
</span><span id="MeshingTools-690"><a href="#MeshingTools-690"><span class="linenos"> 690</span></a>                <span class="k">if</span> <span class="n">shape</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_shapes</span><span class="p">:</span>
</span><span id="MeshingTools-691"><a href="#MeshingTools-691"><span class="linenos"> 691</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-692"><a href="#MeshingTools-692"><span class="linenos"> 692</span></a>            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools-693"><a href="#MeshingTools-693"><span class="linenos"> 693</span></a>                <span class="k">if</span> <span class="n">shape</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_shapes</span><span class="p">:</span>
</span><span id="MeshingTools-694"><a href="#MeshingTools-694"><span class="linenos"> 694</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-695"><a href="#MeshingTools-695"><span class="linenos"> 695</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-696"><a href="#MeshingTools-696"><span class="linenos"> 696</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span>
</span><span id="MeshingTools-697"><a href="#MeshingTools-697"><span class="linenos"> 697</span></a>
</span><span id="MeshingTools-698"><a href="#MeshingTools-698"><span class="linenos"> 698</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span><span id="MeshingTools-699"><a href="#MeshingTools-699"><span class="linenos"> 699</span></a>
</span><span id="MeshingTools-700"><a href="#MeshingTools-700"><span class="linenos"> 700</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">subtract_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="MeshingTools-701"><a href="#MeshingTools-701"><span class="linenos"> 701</span></a>                        <span class="n">removeObject</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-702"><a href="#MeshingTools-702"><span class="linenos"> 702</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-703"><a href="#MeshingTools-703"><span class="linenos"> 703</span></a><span class="sd">        Subtract elements of `shapes_2` from `shapes_1` to form new group of</span>
</span><span id="MeshingTools-704"><a href="#MeshingTools-704"><span class="linenos"> 704</span></a><span class="sd">        shapes.</span>
</span><span id="MeshingTools-705"><a href="#MeshingTools-705"><span class="linenos"> 705</span></a>
</span><span id="MeshingTools-706"><a href="#MeshingTools-706"><span class="linenos"> 706</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-707"><a href="#MeshingTools-707"><span class="linenos"> 707</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-708"><a href="#MeshingTools-708"><span class="linenos"> 708</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="MeshingTools-709"><a href="#MeshingTools-709"><span class="linenos"> 709</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools-710"><a href="#MeshingTools-710"><span class="linenos"> 710</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools-711"><a href="#MeshingTools-711"><span class="linenos"> 711</span></a><span class="sd">        removeObject : bool, optional</span>
</span><span id="MeshingTools-712"><a href="#MeshingTools-712"><span class="linenos"> 712</span></a><span class="sd">            Delete the object shape if set to True. The default is False.</span>
</span><span id="MeshingTools-713"><a href="#MeshingTools-713"><span class="linenos"> 713</span></a><span class="sd">        removeTool : bool, optional</span>
</span><span id="MeshingTools-714"><a href="#MeshingTools-714"><span class="linenos"> 714</span></a><span class="sd">            Delete the tool shape if set to True. The default is False.</span>
</span><span id="MeshingTools-715"><a href="#MeshingTools-715"><span class="linenos"> 715</span></a>
</span><span id="MeshingTools-716"><a href="#MeshingTools-716"><span class="linenos"> 716</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-717"><a href="#MeshingTools-717"><span class="linenos"> 717</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-718"><a href="#MeshingTools-718"><span class="linenos"> 718</span></a><span class="sd">        new_shapes : list</span>
</span><span id="MeshingTools-719"><a href="#MeshingTools-719"><span class="linenos"> 719</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="MeshingTools-720"><a href="#MeshingTools-720"><span class="linenos"> 720</span></a>
</span><span id="MeshingTools-721"><a href="#MeshingTools-721"><span class="linenos"> 721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-722"><a href="#MeshingTools-722"><span class="linenos"> 722</span></a>
</span><span id="MeshingTools-723"><a href="#MeshingTools-723"><span class="linenos"> 723</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools-724"><a href="#MeshingTools-724"><span class="linenos"> 724</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span>
</span><span id="MeshingTools-725"><a href="#MeshingTools-725"><span class="linenos"> 725</span></a>                                          <span class="n">shapes_2</span><span class="p">,</span>
</span><span id="MeshingTools-726"><a href="#MeshingTools-726"><span class="linenos"> 726</span></a>                                          <span class="n">removeObject</span><span class="o">=</span><span class="n">removeObject</span><span class="p">,</span>
</span><span id="MeshingTools-727"><a href="#MeshingTools-727"><span class="linenos"> 727</span></a>                                          <span class="n">removeTool</span><span class="o">=</span><span class="n">removeTool</span><span class="p">)</span>
</span><span id="MeshingTools-728"><a href="#MeshingTools-728"><span class="linenos"> 728</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-729"><a href="#MeshingTools-729"><span class="linenos"> 729</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="n">shapes_1</span>
</span><span id="MeshingTools-730"><a href="#MeshingTools-730"><span class="linenos"> 730</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-731"><a href="#MeshingTools-731"><span class="linenos"> 731</span></a>
</span><span id="MeshingTools-732"><a href="#MeshingTools-732"><span class="linenos"> 732</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span><span id="MeshingTools-733"><a href="#MeshingTools-733"><span class="linenos"> 733</span></a>
</span><span id="MeshingTools-734"><a href="#MeshingTools-734"><span class="linenos"> 734</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">intersect_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-735"><a href="#MeshingTools-735"><span class="linenos"> 735</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-736"><a href="#MeshingTools-736"><span class="linenos"> 736</span></a><span class="sd">        Create group of shapes consisting of the intersection of elements</span>
</span><span id="MeshingTools-737"><a href="#MeshingTools-737"><span class="linenos"> 737</span></a><span class="sd">        from `shapes_1` and `shapes_2`.</span>
</span><span id="MeshingTools-738"><a href="#MeshingTools-738"><span class="linenos"> 738</span></a>
</span><span id="MeshingTools-739"><a href="#MeshingTools-739"><span class="linenos"> 739</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-740"><a href="#MeshingTools-740"><span class="linenos"> 740</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-741"><a href="#MeshingTools-741"><span class="linenos"> 741</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="MeshingTools-742"><a href="#MeshingTools-742"><span class="linenos"> 742</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools-743"><a href="#MeshingTools-743"><span class="linenos"> 743</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools-744"><a href="#MeshingTools-744"><span class="linenos"> 744</span></a>
</span><span id="MeshingTools-745"><a href="#MeshingTools-745"><span class="linenos"> 745</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-746"><a href="#MeshingTools-746"><span class="linenos"> 746</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-747"><a href="#MeshingTools-747"><span class="linenos"> 747</span></a><span class="sd">        new_shapes : list</span>
</span><span id="MeshingTools-748"><a href="#MeshingTools-748"><span class="linenos"> 748</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="MeshingTools-749"><a href="#MeshingTools-749"><span class="linenos"> 749</span></a>
</span><span id="MeshingTools-750"><a href="#MeshingTools-750"><span class="linenos"> 750</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-751"><a href="#MeshingTools-751"><span class="linenos"> 751</span></a>
</span><span id="MeshingTools-752"><a href="#MeshingTools-752"><span class="linenos"> 752</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools-753"><a href="#MeshingTools-753"><span class="linenos"> 753</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">)</span>
</span><span id="MeshingTools-754"><a href="#MeshingTools-754"><span class="linenos"> 754</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-755"><a href="#MeshingTools-755"><span class="linenos"> 755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-756"><a href="#MeshingTools-756"><span class="linenos"> 756</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-757"><a href="#MeshingTools-757"><span class="linenos"> 757</span></a>
</span><span id="MeshingTools-758"><a href="#MeshingTools-758"><span class="linenos"> 758</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span><span id="MeshingTools-759"><a href="#MeshingTools-759"><span class="linenos"> 759</span></a>
</span><span id="MeshingTools-760"><a href="#MeshingTools-760"><span class="linenos"> 760</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">non_intersect_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-761"><a href="#MeshingTools-761"><span class="linenos"> 761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-762"><a href="#MeshingTools-762"><span class="linenos"> 762</span></a><span class="sd">        Create group of shapes consisting of the non-intersection of elements</span>
</span><span id="MeshingTools-763"><a href="#MeshingTools-763"><span class="linenos"> 763</span></a><span class="sd">        from `shapes_1` and `shapes_2`.</span>
</span><span id="MeshingTools-764"><a href="#MeshingTools-764"><span class="linenos"> 764</span></a>
</span><span id="MeshingTools-765"><a href="#MeshingTools-765"><span class="linenos"> 765</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-766"><a href="#MeshingTools-766"><span class="linenos"> 766</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-767"><a href="#MeshingTools-767"><span class="linenos"> 767</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="MeshingTools-768"><a href="#MeshingTools-768"><span class="linenos"> 768</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools-769"><a href="#MeshingTools-769"><span class="linenos"> 769</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools-770"><a href="#MeshingTools-770"><span class="linenos"> 770</span></a>
</span><span id="MeshingTools-771"><a href="#MeshingTools-771"><span class="linenos"> 771</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-772"><a href="#MeshingTools-772"><span class="linenos"> 772</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-773"><a href="#MeshingTools-773"><span class="linenos"> 773</span></a><span class="sd">        new_shapes : list of tuple</span>
</span><span id="MeshingTools-774"><a href="#MeshingTools-774"><span class="linenos"> 774</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="MeshingTools-775"><a href="#MeshingTools-775"><span class="linenos"> 775</span></a>
</span><span id="MeshingTools-776"><a href="#MeshingTools-776"><span class="linenos"> 776</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-777"><a href="#MeshingTools-777"><span class="linenos"> 777</span></a>
</span><span id="MeshingTools-778"><a href="#MeshingTools-778"><span class="linenos"> 778</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools-779"><a href="#MeshingTools-779"><span class="linenos"> 779</span></a>            <span class="n">_</span><span class="p">,</span> <span class="n">fragment_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">fragment</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">)</span>
</span><span id="MeshingTools-780"><a href="#MeshingTools-780"><span class="linenos"> 780</span></a>
</span><span id="MeshingTools-781"><a href="#MeshingTools-781"><span class="linenos"> 781</span></a>            <span class="n">shape_fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-782"><a href="#MeshingTools-782"><span class="linenos"> 782</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fragment_map</span><span class="p">:</span>
</span><span id="MeshingTools-783"><a href="#MeshingTools-783"><span class="linenos"> 783</span></a>                <span class="n">shape_fragments</span> <span class="o">+=</span> <span class="n">s</span>
</span><span id="MeshingTools-784"><a href="#MeshingTools-784"><span class="linenos"> 784</span></a>
</span><span id="MeshingTools-785"><a href="#MeshingTools-785"><span class="linenos"> 785</span></a>            <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-786"><a href="#MeshingTools-786"><span class="linenos"> 786</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-787"><a href="#MeshingTools-787"><span class="linenos"> 787</span></a>            <span class="k">while</span> <span class="n">shape_fragments</span><span class="p">:</span>
</span><span id="MeshingTools-788"><a href="#MeshingTools-788"><span class="linenos"> 788</span></a>                <span class="n">in_overlap</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MeshingTools-789"><a href="#MeshingTools-789"><span class="linenos"> 789</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shape_fragments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
</span><span id="MeshingTools-790"><a href="#MeshingTools-790"><span class="linenos"> 790</span></a>                    <span class="k">if</span> <span class="n">shape_fragments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
</span><span id="MeshingTools-791"><a href="#MeshingTools-791"><span class="linenos"> 791</span></a>                        <span class="n">to_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="MeshingTools-792"><a href="#MeshingTools-792"><span class="linenos"> 792</span></a>                        <span class="n">in_overlap</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MeshingTools-793"><a href="#MeshingTools-793"><span class="linenos"> 793</span></a>
</span><span id="MeshingTools-794"><a href="#MeshingTools-794"><span class="linenos"> 794</span></a>                <span class="k">if</span> <span class="n">in_overlap</span><span class="p">:</span>
</span><span id="MeshingTools-795"><a href="#MeshingTools-795"><span class="linenos"> 795</span></a>                    <span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MeshingTools-796"><a href="#MeshingTools-796"><span class="linenos"> 796</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-797"><a href="#MeshingTools-797"><span class="linenos"> 797</span></a>                    <span class="n">new_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</span><span id="MeshingTools-798"><a href="#MeshingTools-798"><span class="linenos"> 798</span></a>
</span><span id="MeshingTools-799"><a href="#MeshingTools-799"><span class="linenos"> 799</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">to_remove</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-800"><a href="#MeshingTools-800"><span class="linenos"> 800</span></a>
</span><span id="MeshingTools-801"><a href="#MeshingTools-801"><span class="linenos"> 801</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-802"><a href="#MeshingTools-802"><span class="linenos"> 802</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools-803"><a href="#MeshingTools-803"><span class="linenos"> 803</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-804"><a href="#MeshingTools-804"><span class="linenos"> 804</span></a>
</span><span id="MeshingTools-805"><a href="#MeshingTools-805"><span class="linenos"> 805</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span><span id="MeshingTools-806"><a href="#MeshingTools-806"><span class="linenos"> 806</span></a>
</span><span id="MeshingTools-807"><a href="#MeshingTools-807"><span class="linenos"> 807</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-808"><a href="#MeshingTools-808"><span class="linenos"> 808</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-809"><a href="#MeshingTools-809"><span class="linenos"> 809</span></a><span class="sd">        Rotates group of shapes around the x-axis.</span>
</span><span id="MeshingTools-810"><a href="#MeshingTools-810"><span class="linenos"> 810</span></a>
</span><span id="MeshingTools-811"><a href="#MeshingTools-811"><span class="linenos"> 811</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-812"><a href="#MeshingTools-812"><span class="linenos"> 812</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-813"><a href="#MeshingTools-813"><span class="linenos"> 813</span></a><span class="sd">        shapes : list of tuple</span>
</span><span id="MeshingTools-814"><a href="#MeshingTools-814"><span class="linenos"> 814</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools-815"><a href="#MeshingTools-815"><span class="linenos"> 815</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools-816"><a href="#MeshingTools-816"><span class="linenos"> 816</span></a><span class="sd">        angle : float</span>
</span><span id="MeshingTools-817"><a href="#MeshingTools-817"><span class="linenos"> 817</span></a><span class="sd">            Angle of rotation in radians.</span>
</span><span id="MeshingTools-818"><a href="#MeshingTools-818"><span class="linenos"> 818</span></a><span class="sd">        axis : str</span>
</span><span id="MeshingTools-819"><a href="#MeshingTools-819"><span class="linenos"> 819</span></a><span class="sd">            Axis of rotation {&#39;x&#39;, &#39;y&#39;, &#39;z&#39;}.</span>
</span><span id="MeshingTools-820"><a href="#MeshingTools-820"><span class="linenos"> 820</span></a>
</span><span id="MeshingTools-821"><a href="#MeshingTools-821"><span class="linenos"> 821</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-822"><a href="#MeshingTools-822"><span class="linenos"> 822</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-823"><a href="#MeshingTools-823"><span class="linenos"> 823</span></a><span class="sd">        shapes : list tuple</span>
</span><span id="MeshingTools-824"><a href="#MeshingTools-824"><span class="linenos"> 824</span></a><span class="sd">            List of tuples representing the group of shapes. Is identical to</span>
</span><span id="MeshingTools-825"><a href="#MeshingTools-825"><span class="linenos"> 825</span></a><span class="sd">            input &#39;shapes&#39;.</span>
</span><span id="MeshingTools-826"><a href="#MeshingTools-826"><span class="linenos"> 826</span></a>
</span><span id="MeshingTools-827"><a href="#MeshingTools-827"><span class="linenos"> 827</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-828"><a href="#MeshingTools-828"><span class="linenos"> 828</span></a>        <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]:</span>
</span><span id="MeshingTools-829"><a href="#MeshingTools-829"><span class="linenos"> 829</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;axis should be either &#39;x&#39; or &#39;y&#39; or &#39;z&#39;&quot;</span><span class="p">)</span>
</span><span id="MeshingTools-830"><a href="#MeshingTools-830"><span class="linenos"> 830</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools-831"><a href="#MeshingTools-831"><span class="linenos"> 831</span></a>                         <span class="n">ax</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span>
</span><span id="MeshingTools-832"><a href="#MeshingTools-832"><span class="linenos"> 832</span></a>                         <span class="n">ay</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span>
</span><span id="MeshingTools-833"><a href="#MeshingTools-833"><span class="linenos"> 833</span></a>                         <span class="n">az</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">),</span>
</span><span id="MeshingTools-834"><a href="#MeshingTools-834"><span class="linenos"> 834</span></a>                         <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">)</span>
</span><span id="MeshingTools-835"><a href="#MeshingTools-835"><span class="linenos"> 835</span></a>        <span class="k">return</span> <span class="n">shapes</span>
</span><span id="MeshingTools-836"><a href="#MeshingTools-836"><span class="linenos"> 836</span></a>
</span><span id="MeshingTools-837"><a href="#MeshingTools-837"><span class="linenos"> 837</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-838"><a href="#MeshingTools-838"><span class="linenos"> 838</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-839"><a href="#MeshingTools-839"><span class="linenos"> 839</span></a><span class="sd">        @author: Chad Briddon</span>
</span><span id="MeshingTools-840"><a href="#MeshingTools-840"><span class="linenos"> 840</span></a><span class="sd">        Translates group of shapes in the x-direction.</span>
</span><span id="MeshingTools-841"><a href="#MeshingTools-841"><span class="linenos"> 841</span></a>
</span><span id="MeshingTools-842"><a href="#MeshingTools-842"><span class="linenos"> 842</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-843"><a href="#MeshingTools-843"><span class="linenos"> 843</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-844"><a href="#MeshingTools-844"><span class="linenos"> 844</span></a><span class="sd">        shapes : list of tuple</span>
</span><span id="MeshingTools-845"><a href="#MeshingTools-845"><span class="linenos"> 845</span></a><span class="sd">            List of tuples representing a groups of shapes. Each tuple contains</span>
</span><span id="MeshingTools-846"><a href="#MeshingTools-846"><span class="linenos"> 846</span></a><span class="sd">            the dimension and tag of its corresponding shape.</span>
</span><span id="MeshingTools-847"><a href="#MeshingTools-847"><span class="linenos"> 847</span></a><span class="sd">        dx, dy, dz : float</span>
</span><span id="MeshingTools-848"><a href="#MeshingTools-848"><span class="linenos"> 848</span></a><span class="sd">            Amount the group of shapes is to be translated by in the positive</span>
</span><span id="MeshingTools-849"><a href="#MeshingTools-849"><span class="linenos"> 849</span></a><span class="sd">            (x, y, z)-direction. If negative then translation will be in the</span>
</span><span id="MeshingTools-850"><a href="#MeshingTools-850"><span class="linenos"> 850</span></a><span class="sd">            negative (x, y, z)-direction.</span>
</span><span id="MeshingTools-851"><a href="#MeshingTools-851"><span class="linenos"> 851</span></a>
</span><span id="MeshingTools-852"><a href="#MeshingTools-852"><span class="linenos"> 852</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-853"><a href="#MeshingTools-853"><span class="linenos"> 853</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-854"><a href="#MeshingTools-854"><span class="linenos"> 854</span></a><span class="sd">        shapes : list tuple</span>
</span><span id="MeshingTools-855"><a href="#MeshingTools-855"><span class="linenos"> 855</span></a><span class="sd">            List of tuples representing the group of shapes. Is identical to</span>
</span><span id="MeshingTools-856"><a href="#MeshingTools-856"><span class="linenos"> 856</span></a><span class="sd">            input &#39;shapes&#39;.</span>
</span><span id="MeshingTools-857"><a href="#MeshingTools-857"><span class="linenos"> 857</span></a>
</span><span id="MeshingTools-858"><a href="#MeshingTools-858"><span class="linenos"> 858</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-859"><a href="#MeshingTools-859"><span class="linenos"> 859</span></a>
</span><span id="MeshingTools-860"><a href="#MeshingTools-860"><span class="linenos"> 860</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">)</span>
</span><span id="MeshingTools-861"><a href="#MeshingTools-861"><span class="linenos"> 861</span></a>        <span class="k">return</span> <span class="n">shapes</span>
</span><span id="MeshingTools-862"><a href="#MeshingTools-862"><span class="linenos"> 862</span></a>
</span><span id="MeshingTools-863"><a href="#MeshingTools-863"><span class="linenos"> 863</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_name</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MeshingTools-864"><a href="#MeshingTools-864"><span class="linenos"> 864</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-865"><a href="#MeshingTools-865"><span class="linenos"> 865</span></a><span class="sd">        Save the mesh generated by Gmsh.</span>
</span><span id="MeshingTools-866"><a href="#MeshingTools-866"><span class="linenos"> 866</span></a>
</span><span id="MeshingTools-867"><a href="#MeshingTools-867"><span class="linenos"> 867</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-868"><a href="#MeshingTools-868"><span class="linenos"> 868</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-869"><a href="#MeshingTools-869"><span class="linenos"> 869</span></a><span class="sd">        mesh_name : str</span>
</span><span id="MeshingTools-870"><a href="#MeshingTools-870"><span class="linenos"> 870</span></a><span class="sd">            Name of the mesh file to be saved. If not specified as an absolute</span>
</span><span id="MeshingTools-871"><a href="#MeshingTools-871"><span class="linenos"> 871</span></a><span class="sd">            path name, will be stored in the `MESH_DIR` directory.</span>
</span><span id="MeshingTools-872"><a href="#MeshingTools-872"><span class="linenos"> 872</span></a><span class="sd">        convert : bool</span>
</span><span id="MeshingTools-873"><a href="#MeshingTools-873"><span class="linenos"> 873</span></a><span class="sd">            Convert the .vtk mesh file created by Gmsh into a .vtk file readable</span>
</span><span id="MeshingTools-874"><a href="#MeshingTools-874"><span class="linenos"> 874</span></a><span class="sd">            by Sfepy.</span>
</span><span id="MeshingTools-875"><a href="#MeshingTools-875"><span class="linenos"> 875</span></a><span class="sd">        ignored_tags : list</span>
</span><span id="MeshingTools-876"><a href="#MeshingTools-876"><span class="linenos"> 876</span></a><span class="sd">            List of physical groups not to be included in the final .vtk file.</span>
</span><span id="MeshingTools-877"><a href="#MeshingTools-877"><span class="linenos"> 877</span></a><span class="sd">        verbose : bool</span>
</span><span id="MeshingTools-878"><a href="#MeshingTools-878"><span class="linenos"> 878</span></a>
</span><span id="MeshingTools-879"><a href="#MeshingTools-879"><span class="linenos"> 879</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools-880"><a href="#MeshingTools-880"><span class="linenos"> 880</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools-881"><a href="#MeshingTools-881"><span class="linenos"> 881</span></a><span class="sd">        mesh_path_name : str</span>
</span><span id="MeshingTools-882"><a href="#MeshingTools-882"><span class="linenos"> 882</span></a><span class="sd">            Absolute path name of the saved mesh file.</span>
</span><span id="MeshingTools-883"><a href="#MeshingTools-883"><span class="linenos"> 883</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-884"><a href="#MeshingTools-884"><span class="linenos"> 884</span></a>        <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="MeshingTools-885"><a href="#MeshingTools-885"><span class="linenos"> 885</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="MeshingTools-886"><a href="#MeshingTools-886"><span class="linenos"> 886</span></a>        <span class="k">if</span> <span class="n">convert</span><span class="p">:</span>
</span><span id="MeshingTools-887"><a href="#MeshingTools-887"><span class="linenos"> 887</span></a>            <span class="n">convert_mesh_for_sfepy</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="o">=</span><span class="n">ignored_tags</span><span class="p">,</span>
</span><span id="MeshingTools-888"><a href="#MeshingTools-888"><span class="linenos"> 888</span></a>                                   <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="MeshingTools-889"><a href="#MeshingTools-889"><span class="linenos"> 889</span></a>        <span class="k">return</span> <span class="n">mesh_path_name</span>
</span><span id="MeshingTools-890"><a href="#MeshingTools-890"><span class="linenos"> 890</span></a>
</span><span id="MeshingTools-891"><a href="#MeshingTools-891"><span class="linenos"> 891</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_cylindrical_symmetry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MeshingTools-892"><a href="#MeshingTools-892"><span class="linenos"> 892</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-893"><a href="#MeshingTools-893"><span class="linenos"> 893</span></a><span class="sd">        If the problem to be solved has cylindrical symmetry, it is possible</span>
</span><span id="MeshingTools-894"><a href="#MeshingTools-894"><span class="linenos"> 894</span></a><span class="sd">        to reduce the dimension of the problem from 3 (r, theta, z) to 2 (r, z).</span>
</span><span id="MeshingTools-895"><a href="#MeshingTools-895"><span class="linenos"> 895</span></a><span class="sd">        In that case, only keep the half-plane r&gt;0 of the 2D mesh.</span>
</span><span id="MeshingTools-896"><a href="#MeshingTools-896"><span class="linenos"> 896</span></a>
</span><span id="MeshingTools-897"><a href="#MeshingTools-897"><span class="linenos"> 897</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-898"><a href="#MeshingTools-898"><span class="linenos"> 898</span></a>
</span><span id="MeshingTools-899"><a href="#MeshingTools-899"><span class="linenos"> 899</span></a>        <span class="c1"># Determination of a suitable cutout distance</span>
</span><span id="MeshingTools-900"><a href="#MeshingTools-900"><span class="linenos"> 900</span></a>        <span class="n">distance_cutout</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="MeshingTools-901"><a href="#MeshingTools-901"><span class="linenos"> 901</span></a>        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
</span><span id="MeshingTools-902"><a href="#MeshingTools-902"><span class="linenos"> 902</span></a>            <span class="k">for</span> <span class="n">dimTag</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
</span><span id="MeshingTools-903"><a href="#MeshingTools-903"><span class="linenos"> 903</span></a>                <span class="n">bbox</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">(</span><span class="o">*</span><span class="n">dimTag</span><span class="p">)</span>
</span><span id="MeshingTools-904"><a href="#MeshingTools-904"><span class="linenos"> 904</span></a>                <span class="n">xur</span><span class="p">,</span> <span class="n">yur</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>  <span class="c1"># upper-right corner</span>
</span><span id="MeshingTools-905"><a href="#MeshingTools-905"><span class="linenos"> 905</span></a>                <span class="n">dist</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">xur</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">yur</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="MeshingTools-906"><a href="#MeshingTools-906"><span class="linenos"> 906</span></a>                <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;</span> <span class="n">distance_cutout</span><span class="p">:</span>
</span><span id="MeshingTools-907"><a href="#MeshingTools-907"><span class="linenos"> 907</span></a>                    <span class="n">distance_cutout</span> <span class="o">=</span> <span class="n">dist</span>
</span><span id="MeshingTools-908"><a href="#MeshingTools-908"><span class="linenos"> 908</span></a>        <span class="n">distance_cutout</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># safety margin</span>
</span><span id="MeshingTools-909"><a href="#MeshingTools-909"><span class="linenos"> 909</span></a>
</span><span id="MeshingTools-910"><a href="#MeshingTools-910"><span class="linenos"> 910</span></a>        <span class="c1"># Apply cutout</span>
</span><span id="MeshingTools-911"><a href="#MeshingTools-911"><span class="linenos"> 911</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="n">distance_cutout</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">distance_cutout</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">distance_cutout</span><span class="p">]</span>
</span><span id="MeshingTools-912"><a href="#MeshingTools-912"><span class="linenos"> 912</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rectangle_cutout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span>
</span><span id="MeshingTools-913"><a href="#MeshingTools-913"><span class="linenos"> 913</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-914"><a href="#MeshingTools-914"><span class="linenos"> 914</span></a>
</span><span id="MeshingTools-915"><a href="#MeshingTools-915"><span class="linenos"> 915</span></a>        <span class="c1"># Repair boundaries</span>
</span><span id="MeshingTools-916"><a href="#MeshingTools-916"><span class="linenos"> 916</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-917"><a href="#MeshingTools-917"><span class="linenos"> 917</span></a>        <span class="k">for</span> <span class="n">dimTags</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
</span><span id="MeshingTools-918"><a href="#MeshingTools-918"><span class="linenos"> 918</span></a>            <span class="n">blist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-919"><a href="#MeshingTools-919"><span class="linenos"> 919</span></a>            <span class="k">for</span> <span class="n">dimTag</span> <span class="ow">in</span> <span class="n">dimTags</span><span class="p">:</span>
</span><span id="MeshingTools-920"><a href="#MeshingTools-920"><span class="linenos"> 920</span></a>                <span class="n">boundary</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getBoundary</span><span class="p">([</span><span class="n">dimTag</span><span class="p">])</span>
</span><span id="MeshingTools-921"><a href="#MeshingTools-921"><span class="linenos"> 921</span></a>                <span class="k">for</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">boundary</span><span class="p">:</span>
</span><span id="MeshingTools-922"><a href="#MeshingTools-922"><span class="linenos"> 922</span></a>                    <span class="k">if</span> <span class="n">curve</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MeshingTools-923"><a href="#MeshingTools-923"><span class="linenos"> 923</span></a>                        <span class="k">continue</span>
</span><span id="MeshingTools-924"><a href="#MeshingTools-924"><span class="linenos"> 924</span></a>                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getBoundingBox</span><span class="p">(</span><span class="n">curve</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">curve</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MeshingTools-925"><a href="#MeshingTools-925"><span class="linenos"> 925</span></a>                    <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="MeshingTools-926"><a href="#MeshingTools-926"><span class="linenos"> 926</span></a>                    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-5</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-5</span><span class="p">:</span>
</span><span id="MeshingTools-927"><a href="#MeshingTools-927"><span class="linenos"> 927</span></a>                        <span class="n">blist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span>
</span><span id="MeshingTools-928"><a href="#MeshingTools-928"><span class="linenos"> 928</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blist</span><span class="p">)</span>
</span><span id="MeshingTools-929"><a href="#MeshingTools-929"><span class="linenos"> 929</span></a>
</span><span id="MeshingTools-930"><a href="#MeshingTools-930"><span class="linenos"> 930</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_embed_origin_to_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span> <span class="n">is_on_curve</span><span class="p">):</span>
</span><span id="MeshingTools-931"><a href="#MeshingTools-931"><span class="linenos"> 931</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools-932"><a href="#MeshingTools-932"><span class="linenos"> 932</span></a><span class="sd">        Force the point of coordinates x=0, y=0, [z=0] to be part of the mesh</span>
</span><span id="MeshingTools-933"><a href="#MeshingTools-933"><span class="linenos"> 933</span></a><span class="sd">        vertices.</span>
</span><span id="MeshingTools-934"><a href="#MeshingTools-934"><span class="linenos"> 934</span></a>
</span><span id="MeshingTools-935"><a href="#MeshingTools-935"><span class="linenos"> 935</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools-936"><a href="#MeshingTools-936"><span class="linenos"> 936</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools-937"><a href="#MeshingTools-937"><span class="linenos"> 937</span></a><span class="sd">        origin_tag : int</span>
</span><span id="MeshingTools-938"><a href="#MeshingTools-938"><span class="linenos"> 938</span></a><span class="sd">            Tag of the origin point.</span>
</span><span id="MeshingTools-939"><a href="#MeshingTools-939"><span class="linenos"> 939</span></a><span class="sd">        is_on_curve : bool</span>
</span><span id="MeshingTools-940"><a href="#MeshingTools-940"><span class="linenos"> 940</span></a><span class="sd">            Whether the origin lies on a curve. This happens e.g. when</span>
</span><span id="MeshingTools-941"><a href="#MeshingTools-941"><span class="linenos"> 941</span></a><span class="sd">            `cylindrical_symmetry` is set to True.</span>
</span><span id="MeshingTools-942"><a href="#MeshingTools-942"><span class="linenos"> 942</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools-943"><a href="#MeshingTools-943"><span class="linenos"> 943</span></a>
</span><span id="MeshingTools-944"><a href="#MeshingTools-944"><span class="linenos"> 944</span></a>        <span class="c1"># Gmsh hack to embed a point on a curve</span>
</span><span id="MeshingTools-945"><a href="#MeshingTools-945"><span class="linenos"> 945</span></a>        <span class="c1"># see https://gitlab.onelab.info/gmsh/gmsh/-/issues/1591</span>
</span><span id="MeshingTools-946"><a href="#MeshingTools-946"><span class="linenos"> 946</span></a>        <span class="k">if</span> <span class="n">is_on_curve</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="MeshingTools-947"><a href="#MeshingTools-947"><span class="linenos"> 947</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">fragment</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">)],</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">())</span>
</span><span id="MeshingTools-948"><a href="#MeshingTools-948"><span class="linenos"> 948</span></a>
</span><span id="MeshingTools-949"><a href="#MeshingTools-949"><span class="linenos"> 949</span></a>        <span class="c1"># Gmsh traditional way to embed a point in surface / volume</span>
</span><span id="MeshingTools-950"><a href="#MeshingTools-950"><span class="linenos"> 950</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-951"><a href="#MeshingTools-951"><span class="linenos"> 951</span></a>            <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">:</span>
</span><span id="MeshingTools-952"><a href="#MeshingTools-952"><span class="linenos"> 952</span></a>                <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">source</span><span class="p">]:</span>
</span><span id="MeshingTools-953"><a href="#MeshingTools-953"><span class="linenos"> 953</span></a>                    <span class="k">if</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">isInside</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
</span><span id="MeshingTools-954"><a href="#MeshingTools-954"><span class="linenos"> 954</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-955"><a href="#MeshingTools-955"><span class="linenos"> 955</span></a>                        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">origin_tag</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</span><span id="MeshingTools-956"><a href="#MeshingTools-956"><span class="linenos"> 956</span></a>                        <span class="k">break</span>
</span><span id="MeshingTools-957"><a href="#MeshingTools-957"><span class="linenos"> 957</span></a>
</span><span id="MeshingTools-958"><a href="#MeshingTools-958"><span class="linenos"> 958</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools-959"><a href="#MeshingTools-959"><span class="linenos"> 959</span></a>
</span><span id="MeshingTools-960"><a href="#MeshingTools-960"><span class="linenos"> 960</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_refinement_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">):</span>
</span><span id="MeshingTools-961"><a href="#MeshingTools-961"><span class="linenos"> 961</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply the refinement settings to the mesh being created.&quot;&quot;&quot;</span>
</span><span id="MeshingTools-962"><a href="#MeshingTools-962"><span class="linenos"> 962</span></a>
</span><span id="MeshingTools-963"><a href="#MeshingTools-963"><span class="linenos"> 963</span></a>        <span class="c1"># Get boundary type</span>
</span><span id="MeshingTools-964"><a href="#MeshingTools-964"><span class="linenos"> 964</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="MeshingTools-965"><a href="#MeshingTools-965"><span class="linenos"> 965</span></a>            <span class="n">boundary_type</span> <span class="o">=</span> <span class="s2">&quot;CurvesList&quot;</span>
</span><span id="MeshingTools-966"><a href="#MeshingTools-966"><span class="linenos"> 966</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="MeshingTools-967"><a href="#MeshingTools-967"><span class="linenos"> 967</span></a>            <span class="n">boundary_type</span> <span class="o">=</span> <span class="s2">&quot;SurfacesList&quot;</span>
</span><span id="MeshingTools-968"><a href="#MeshingTools-968"><span class="linenos"> 968</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools-969"><a href="#MeshingTools-969"><span class="linenos"> 969</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Gmsh can only deal with 2d or 3d meshes!&quot;</span><span class="p">)</span>
</span><span id="MeshingTools-970"><a href="#MeshingTools-970"><span class="linenos"> 970</span></a>
</span><span id="MeshingTools-971"><a href="#MeshingTools-971"><span class="linenos"> 971</span></a>        <span class="c1"># Group boundaries together and define distance fields</span>
</span><span id="MeshingTools-972"><a href="#MeshingTools-972"><span class="linenos"> 972</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MeshingTools-973"><a href="#MeshingTools-973"><span class="linenos"> 973</span></a>        <span class="k">for</span> <span class="n">boundary</span><span class="p">,</span> <span class="n">rf</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span><span class="p">):</span>
</span><span id="MeshingTools-974"><a href="#MeshingTools-974"><span class="linenos"> 974</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="MeshingTools-975"><a href="#MeshingTools-975"><span class="linenos"> 975</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="MeshingTools-976"><a href="#MeshingTools-976"><span class="linenos"> 976</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">boundary_type</span><span class="p">,</span>
</span><span id="MeshingTools-977"><a href="#MeshingTools-977"><span class="linenos"> 977</span></a>                                             <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boundary</span><span class="p">])</span>
</span><span id="MeshingTools-978"><a href="#MeshingTools-978"><span class="linenos"> 978</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;NumPointsPerCurve&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span><span id="MeshingTools-979"><a href="#MeshingTools-979"><span class="linenos"> 979</span></a>
</span><span id="MeshingTools-980"><a href="#MeshingTools-980"><span class="linenos"> 980</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="MeshingTools-981"><a href="#MeshingTools-981"><span class="linenos"> 981</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="MeshingTools-982"><a href="#MeshingTools-982"><span class="linenos"> 982</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Distance&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
</span><span id="MeshingTools-983"><a href="#MeshingTools-983"><span class="linenos"> 983</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;PointsList&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">origin_tag</span><span class="p">])</span>
</span><span id="MeshingTools-984"><a href="#MeshingTools-984"><span class="linenos"> 984</span></a>
</span><span id="MeshingTools-985"><a href="#MeshingTools-985"><span class="linenos"> 985</span></a>        <span class="c1"># Define threshold fields.</span>
</span><span id="MeshingTools-986"><a href="#MeshingTools-986"><span class="linenos"> 986</span></a>        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MeshingTools-987"><a href="#MeshingTools-987"><span class="linenos"> 987</span></a>        <span class="k">for</span> <span class="n">rf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span><span class="p">:</span>
</span><span id="MeshingTools-988"><a href="#MeshingTools-988"><span class="linenos"> 988</span></a>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="MeshingTools-989"><a href="#MeshingTools-989"><span class="linenos"> 989</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
</span><span id="MeshingTools-990"><a href="#MeshingTools-990"><span class="linenos"> 990</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;InField&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="MeshingTools-991"><a href="#MeshingTools-991"><span class="linenos"> 991</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;SizeMin&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="MeshingTools-992"><a href="#MeshingTools-992"><span class="linenos"> 992</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;SizeMax&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MeshingTools-993"><a href="#MeshingTools-993"><span class="linenos"> 993</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;DistMin&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="MeshingTools-994"><a href="#MeshingTools-994"><span class="linenos"> 994</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;DistMax&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="MeshingTools-995"><a href="#MeshingTools-995"><span class="linenos"> 995</span></a>
</span><span id="MeshingTools-996"><a href="#MeshingTools-996"><span class="linenos"> 996</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="MeshingTools-997"><a href="#MeshingTools-997"><span class="linenos"> 997</span></a>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="MeshingTools-998"><a href="#MeshingTools-998"><span class="linenos"> 998</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Threshold&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
</span><span id="MeshingTools-999"><a href="#MeshingTools-999"><span class="linenos"> 999</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;InField&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
</span><span id="MeshingTools-1000"><a href="#MeshingTools-1000"><span class="linenos">1000</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;SizeMin&quot;</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="MeshingTools-1001"><a href="#MeshingTools-1001"><span class="linenos">1001</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;SizeMax&quot;</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MeshingTools-1002"><a href="#MeshingTools-1002"><span class="linenos">1002</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;DistMin&quot;</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="MeshingTools-1003"><a href="#MeshingTools-1003"><span class="linenos">1003</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="s2">&quot;DistMax&quot;</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="MeshingTools-1004"><a href="#MeshingTools-1004"><span class="linenos">1004</span></a>
</span><span id="MeshingTools-1005"><a href="#MeshingTools-1005"><span class="linenos">1005</span></a>        <span class="c1"># Set mesh resolution.</span>
</span><span id="MeshingTools-1006"><a href="#MeshingTools-1006"><span class="linenos">1006</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;Min&quot;</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="MeshingTools-1007"><a href="#MeshingTools-1007"><span class="linenos">1007</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setNumbers</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;FieldsList&quot;</span><span class="p">,</span>
</span><span id="MeshingTools-1008"><a href="#MeshingTools-1008"><span class="linenos">1008</span></a>                                         <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
</span><span id="MeshingTools-1009"><a href="#MeshingTools-1009"><span class="linenos">1009</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">setAsBackgroundMesh</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="MeshingTools-1010"><a href="#MeshingTools-1010"><span class="linenos">1010</span></a>
</span><span id="MeshingTools-1011"><a href="#MeshingTools-1011"><span class="linenos">1011</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MeshSizeExtendFromBoundary&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="MeshingTools-1012"><a href="#MeshingTools-1012"><span class="linenos">1012</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MeshSizeFromPoints&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="MeshingTools-1013"><a href="#MeshingTools-1013"><span class="linenos">1013</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">&quot;Mesh.MeshSizeFromCurvature&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="MeshingTools-1014"><a href="#MeshingTools-1014"><span class="linenos">1014</span></a>
</span><span id="MeshingTools-1015"><a href="#MeshingTools-1015"><span class="linenos">1015</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_assign_physical_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span>
</span><span id="MeshingTools-1016"><a href="#MeshingTools-1016"><span class="linenos">1016</span></a>                                <span class="n">unique_boundary_tags</span><span class="p">):</span>
</span><span id="MeshingTools-1017"><a href="#MeshingTools-1017"><span class="linenos">1017</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Assign physical groups to geometrical entities of the mesh.&quot;&quot;&quot;</span>
</span><span id="MeshingTools-1018"><a href="#MeshingTools-1018"><span class="linenos">1018</span></a>
</span><span id="MeshingTools-1019"><a href="#MeshingTools-1019"><span class="linenos">1019</span></a>        <span class="c1"># 0-dimensional entities</span>
</span><span id="MeshingTools-1020"><a href="#MeshingTools-1020"><span class="linenos">1020</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="MeshingTools-1021"><a href="#MeshingTools-1021"><span class="linenos">1021</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">origin_tag</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MeshingTools-1022"><a href="#MeshingTools-1022"><span class="linenos">1022</span></a>
</span><span id="MeshingTools-1023"><a href="#MeshingTools-1023"><span class="linenos">1023</span></a>        <span class="c1"># (D-1)-dimensional entities</span>
</span><span id="MeshingTools-1024"><a href="#MeshingTools-1024"><span class="linenos">1024</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">boundary</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">):</span>
</span><span id="MeshingTools-1025"><a href="#MeshingTools-1025"><span class="linenos">1025</span></a>            <span class="k">if</span> <span class="n">unique_boundary_tags</span><span class="p">:</span>  <span class="c1"># same tag for all parts of a boundary</span>
</span><span id="MeshingTools-1026"><a href="#MeshingTools-1026"><span class="linenos">1026</span></a>                <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="MeshingTools-1027"><a href="#MeshingTools-1027"><span class="linenos">1027</span></a>                                            <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boundary</span><span class="p">],</span>
</span><span id="MeshingTools-1028"><a href="#MeshingTools-1028"><span class="linenos">1028</span></a>                                            <span class="n">tag</span><span class="o">=</span><span class="mi">200</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
</span><span id="MeshingTools-1029"><a href="#MeshingTools-1029"><span class="linenos">1029</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># separate tag for each part of a boundary</span>
</span><span id="MeshingTools-1030"><a href="#MeshingTools-1030"><span class="linenos">1030</span></a>                <span class="n">inc</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">])</span>
</span><span id="MeshingTools-1031"><a href="#MeshingTools-1031"><span class="linenos">1031</span></a>                <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">dimTag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boundary</span><span class="p">):</span>
</span><span id="MeshingTools-1032"><a href="#MeshingTools-1032"><span class="linenos">1032</span></a>                    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="MeshingTools-1033"><a href="#MeshingTools-1033"><span class="linenos">1033</span></a>                                                <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">dimTag</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
</span><span id="MeshingTools-1034"><a href="#MeshingTools-1034"><span class="linenos">1034</span></a>                                                <span class="n">tag</span><span class="o">=</span><span class="mi">200</span> <span class="o">+</span> <span class="p">(</span><span class="n">inc</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>
</span><span id="MeshingTools-1035"><a href="#MeshingTools-1035"><span class="linenos">1035</span></a>
</span><span id="MeshingTools-1036"><a href="#MeshingTools-1036"><span class="linenos">1036</span></a>        <span class="c1"># D-dimensional entities</span>
</span><span id="MeshingTools-1037"><a href="#MeshingTools-1037"><span class="linenos">1037</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">source</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">):</span>
</span><span id="MeshingTools-1038"><a href="#MeshingTools-1038"><span class="linenos">1038</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span>
</span><span id="MeshingTools-1039"><a href="#MeshingTools-1039"><span class="linenos">1039</span></a>                                        <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">source</span><span class="p">],</span>
</span><span id="MeshingTools-1040"><a href="#MeshingTools-1040"><span class="linenos">1040</span></a>                                        <span class="n">tag</span><span class="o">=</span><span class="mi">300</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
</span><span id="MeshingTools-1041"><a href="#MeshingTools-1041"><span class="linenos">1041</span></a>
</span><span id="MeshingTools-1042"><a href="#MeshingTools-1042"><span class="linenos">1042</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MeshingTools-1043"><a href="#MeshingTools-1043"><span class="linenos">1043</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_tags</span><span class="p">(</span><span class="n">dimTags</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools-1044"><a href="#MeshingTools-1044"><span class="linenos">1044</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return list of tags from a list of dimTag.&quot;&quot;&quot;</span>
</span><span id="MeshingTools-1045"><a href="#MeshingTools-1045"><span class="linenos">1045</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools-1046"><a href="#MeshingTools-1046"><span class="linenos">1046</span></a>        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">dimTags</span><span class="p">:</span>
</span><span id="MeshingTools-1047"><a href="#MeshingTools-1047"><span class="linenos">1047</span></a>            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MeshingTools-1048"><a href="#MeshingTools-1048"><span class="linenos">1048</span></a>        <span class="k">return</span> <span class="n">out</span>
</span></pre></div>


            <div class="docstring"><p>Construct and manipulate user-defined meshes through the Gmsh Python API.
Gmsh Python API is initialized when the class is instantiated.
Following Gmsh's terminology, a dimTag is a pair of integers (dim, tag) and
a dimTags is a list of several dimTag.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>dim</strong> (int):
Dimension of the mesh, 2 or 3.</li>
<li><strong>Rcut</strong> (float):
Truncation radius of the mesh.</li>
<li><strong>boundaries</strong> (list):
List of dimTags representing boundary shapes of dimension <code><a href="#MeshingTools.dim">dim</a></code>-1.</li>
<li><strong>sources</strong> (list):
List of dimTags representing source shapes of dimension <code><a href="#MeshingTools.dim">dim</a></code>.</li>
<li><strong>refinement_settings</strong> (list):
List of mesh refinement settings (see <code><a href="#MeshingTools.create_subdomain">create_subdomain</a></code> method), one
per source shape.</li>
<li><strong>number_sources</strong> (int):
Number of source shapes currently defined in the Gmsh model.</li>
<li><strong>number_boundaries</strong> (int):
Number of boundary shapes currently defined in the Gmsh model.</li>
<li><strong>min_length</strong> (float):
Minimum distance between neighbouring points.</li>
<li><strong>geom</strong> (class gmsh.model.occ):
Shortcut.</li>
</ul>
</div>


                            <div id="MeshingTools.__init__" class="classattr">
                                        <input id="MeshingTools.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MeshingTools</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">Rcut</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="MeshingTools.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.__init__-73"><a href="#MeshingTools.__init__-73"><span class="linenos">73</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Rcut</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="MeshingTools.__init__-74"><a href="#MeshingTools.__init__-74"><span class="linenos">74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.__init__-75"><a href="#MeshingTools.__init__-75"><span class="linenos">75</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.__init__-76"><a href="#MeshingTools.__init__-76"><span class="linenos">76</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.__init__-77"><a href="#MeshingTools.__init__-77"><span class="linenos">77</span></a><span class="sd">        dimension : int</span>
</span><span id="MeshingTools.__init__-78"><a href="#MeshingTools.__init__-78"><span class="linenos">78</span></a><span class="sd">            Dimension of the mesh, 2 or 3.</span>
</span><span id="MeshingTools.__init__-79"><a href="#MeshingTools.__init__-79"><span class="linenos">79</span></a><span class="sd">        Rcut : float, optional</span>
</span><span id="MeshingTools.__init__-80"><a href="#MeshingTools.__init__-80"><span class="linenos">80</span></a><span class="sd">            Truncation radius of the mesh. The default is None.</span>
</span><span id="MeshingTools.__init__-81"><a href="#MeshingTools.__init__-81"><span class="linenos">81</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.__init__-82"><a href="#MeshingTools.__init__-82"><span class="linenos">82</span></a>
</span><span id="MeshingTools.__init__-83"><a href="#MeshingTools.__init__-83"><span class="linenos">83</span></a>        <span class="c1"># Check dimension</span>
</span><span id="MeshingTools.__init__-84"><a href="#MeshingTools.__init__-84"><span class="linenos">84</span></a>        <span class="k">assert</span> <span class="n">dimension</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;Dimension should be 2 or 3.&quot;</span>
</span><span id="MeshingTools.__init__-85"><a href="#MeshingTools.__init__-85"><span class="linenos">85</span></a>
</span><span id="MeshingTools.__init__-86"><a href="#MeshingTools.__init__-86"><span class="linenos">86</span></a>        <span class="c1"># Set attributes</span>
</span><span id="MeshingTools.__init__-87"><a href="#MeshingTools.__init__-87"><span class="linenos">87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dimension</span>
</span><span id="MeshingTools.__init__-88"><a href="#MeshingTools.__init__-88"><span class="linenos">88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Rcut</span> <span class="o">=</span> <span class="n">Rcut</span>
</span><span id="MeshingTools.__init__-89"><a href="#MeshingTools.__init__-89"><span class="linenos">89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools.__init__-90"><a href="#MeshingTools.__init__-90"><span class="linenos">90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools.__init__-91"><a href="#MeshingTools.__init__-91"><span class="linenos">91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools.__init__-92"><a href="#MeshingTools.__init__-92"><span class="linenos">92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MeshingTools.__init__-93"><a href="#MeshingTools.__init__-93"><span class="linenos">93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MeshingTools.__init__-94"><a href="#MeshingTools.__init__-94"><span class="linenos">94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span> <span class="o">=</span> <span class="mf">1.3e-6</span>
</span><span id="MeshingTools.__init__-95"><a href="#MeshingTools.__init__-95"><span class="linenos">95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">occ</span>
</span><span id="MeshingTools.__init__-96"><a href="#MeshingTools.__init__-96"><span class="linenos">96</span></a>
</span><span id="MeshingTools.__init__-97"><a href="#MeshingTools.__init__-97"><span class="linenos">97</span></a>        <span class="c1"># open gmsh</span>
</span><span id="MeshingTools.__init__-98"><a href="#MeshingTools.__init__-98"><span class="linenos">98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">open_gmsh</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dimension</strong> (int):
Dimension of the mesh, 2 or 3.</li>
<li><strong>Rcut</strong> (float, optional):
Truncation radius of the mesh. The default is None.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.dim" class="classattr">
                                <div class="attr variable">
            <span class="name">dim</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.dim"></a>
    
    

                            </div>
                            <div id="MeshingTools.Rcut" class="classattr">
                                <div class="attr variable">
            <span class="name">Rcut</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.Rcut"></a>
    
    

                            </div>
                            <div id="MeshingTools.boundaries" class="classattr">
                                <div class="attr variable">
            <span class="name">boundaries</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.boundaries"></a>
    
    

                            </div>
                            <div id="MeshingTools.sources" class="classattr">
                                <div class="attr variable">
            <span class="name">sources</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.sources"></a>
    
    

                            </div>
                            <div id="MeshingTools.refinement_settings" class="classattr">
                                <div class="attr variable">
            <span class="name">refinement_settings</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.refinement_settings"></a>
    
    

                            </div>
                            <div id="MeshingTools.number_sources" class="classattr">
                                <div class="attr variable">
            <span class="name">number_sources</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.number_sources"></a>
    
    

                            </div>
                            <div id="MeshingTools.number_boundaries" class="classattr">
                                <div class="attr variable">
            <span class="name">number_boundaries</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.number_boundaries"></a>
    
    

                            </div>
                            <div id="MeshingTools.min_length" class="classattr">
                                <div class="attr variable">
            <span class="name">min_length</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.min_length"></a>
    
    

                            </div>
                            <div id="MeshingTools.geom" class="classattr">
                                <div class="attr variable">
            <span class="name">geom</span>

        
    </div>
    <a class="headerlink" href="#MeshingTools.geom"></a>
    
    

                            </div>
                            <div id="MeshingTools.open_gmsh" class="classattr">
                                        <input id="MeshingTools.open_gmsh-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">open_gmsh</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.open_gmsh-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.open_gmsh"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.open_gmsh-100"><a href="#MeshingTools.open_gmsh-100"><span class="linenos">100</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MeshingTools.open_gmsh-101"><a href="#MeshingTools.open_gmsh-101"><span class="linenos">101</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_gmsh</span><span class="p">():</span>
</span><span id="MeshingTools.open_gmsh-102"><a href="#MeshingTools.open_gmsh-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Gmsh Python API.&quot;&quot;&quot;</span>
</span><span id="MeshingTools.open_gmsh-103"><a href="#MeshingTools.open_gmsh-103"><span class="linenos">103</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</span><span id="MeshingTools.open_gmsh-104"><a href="#MeshingTools.open_gmsh-104"><span class="linenos">104</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;General.Verbosity&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the Gmsh Python API.</p>
</div>


                            </div>
                            <div id="MeshingTools.close_gmsh" class="classattr">
                                        <input id="MeshingTools.close_gmsh-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">close_gmsh</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.close_gmsh-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.close_gmsh"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.close_gmsh-106"><a href="#MeshingTools.close_gmsh-106"><span class="linenos">106</span></a>    <span class="nd">@staticmethod</span>
</span><span id="MeshingTools.close_gmsh-107"><a href="#MeshingTools.close_gmsh-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">close_gmsh</span><span class="p">():</span>
</span><span id="MeshingTools.close_gmsh-108"><a href="#MeshingTools.close_gmsh-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;To be called when one is done using the Gmsh Python API.&quot;&quot;&quot;</span>
</span><span id="MeshingTools.close_gmsh-109"><a href="#MeshingTools.close_gmsh-109"><span class="linenos">109</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="MeshingTools.close_gmsh-110"><a href="#MeshingTools.close_gmsh-110"><span class="linenos">110</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>To be called when one is done using the Gmsh Python API.</p>
</div>


                            </div>
                            <div id="MeshingTools.generate_mesh" class="classattr">
                                        <input id="MeshingTools.generate_mesh-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_mesh</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">show_mesh</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="MeshingTools.generate_mesh-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.generate_mesh"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.generate_mesh-112"><a href="#MeshingTools.generate_mesh-112"><span class="linenos">112</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">show_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="MeshingTools.generate_mesh-113"><a href="#MeshingTools.generate_mesh-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.generate_mesh-114"><a href="#MeshingTools.generate_mesh-114"><span class="linenos">114</span></a><span class="sd">        Generate the mesh and save it.</span>
</span><span id="MeshingTools.generate_mesh-115"><a href="#MeshingTools.generate_mesh-115"><span class="linenos">115</span></a>
</span><span id="MeshingTools.generate_mesh-116"><a href="#MeshingTools.generate_mesh-116"><span class="linenos">116</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.generate_mesh-117"><a href="#MeshingTools.generate_mesh-117"><span class="linenos">117</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.generate_mesh-118"><a href="#MeshingTools.generate_mesh-118"><span class="linenos">118</span></a><span class="sd">        mesh_name : str</span>
</span><span id="MeshingTools.generate_mesh-119"><a href="#MeshingTools.generate_mesh-119"><span class="linenos">119</span></a><span class="sd">            Name of the mesh file to be created. If not specified as an absolute</span>
</span><span id="MeshingTools.generate_mesh-120"><a href="#MeshingTools.generate_mesh-120"><span class="linenos">120</span></a><span class="sd">            path name, will be stored in the `MESH_DIR` directory.</span>
</span><span id="MeshingTools.generate_mesh-121"><a href="#MeshingTools.generate_mesh-121"><span class="linenos">121</span></a><span class="sd">        show_mesh : bool, optional</span>
</span><span id="MeshingTools.generate_mesh-122"><a href="#MeshingTools.generate_mesh-122"><span class="linenos">122</span></a><span class="sd">            Open the Gmsh graphical user interface to inspect the mesh.</span>
</span><span id="MeshingTools.generate_mesh-123"><a href="#MeshingTools.generate_mesh-123"><span class="linenos">123</span></a><span class="sd">            The default is False.</span>
</span><span id="MeshingTools.generate_mesh-124"><a href="#MeshingTools.generate_mesh-124"><span class="linenos">124</span></a>
</span><span id="MeshingTools.generate_mesh-125"><a href="#MeshingTools.generate_mesh-125"><span class="linenos">125</span></a><span class="sd">        Other Parameters</span>
</span><span id="MeshingTools.generate_mesh-126"><a href="#MeshingTools.generate_mesh-126"><span class="linenos">126</span></a><span class="sd">        ----------------</span>
</span><span id="MeshingTools.generate_mesh-127"><a href="#MeshingTools.generate_mesh-127"><span class="linenos">127</span></a><span class="sd">        ignored_tags : list, optional</span>
</span><span id="MeshingTools.generate_mesh-128"><a href="#MeshingTools.generate_mesh-128"><span class="linenos">128</span></a><span class="sd">            List of physical groups not to be included in the final .vtk file.</span>
</span><span id="MeshingTools.generate_mesh-129"><a href="#MeshingTools.generate_mesh-129"><span class="linenos">129</span></a><span class="sd">            The default is [].</span>
</span><span id="MeshingTools.generate_mesh-130"><a href="#MeshingTools.generate_mesh-130"><span class="linenos">130</span></a><span class="sd">        convert : bool, optional</span>
</span><span id="MeshingTools.generate_mesh-131"><a href="#MeshingTools.generate_mesh-131"><span class="linenos">131</span></a><span class="sd">            Convert the .vtk mesh file created by Gmsh into a .vtk file readable</span>
</span><span id="MeshingTools.generate_mesh-132"><a href="#MeshingTools.generate_mesh-132"><span class="linenos">132</span></a><span class="sd">            by Sfepy. The default is True.</span>
</span><span id="MeshingTools.generate_mesh-133"><a href="#MeshingTools.generate_mesh-133"><span class="linenos">133</span></a><span class="sd">        embed_origin : bool, optional</span>
</span><span id="MeshingTools.generate_mesh-134"><a href="#MeshingTools.generate_mesh-134"><span class="linenos">134</span></a><span class="sd">            Force the embedding of the origin (i.e. point of coordinates x=0,</span>
</span><span id="MeshingTools.generate_mesh-135"><a href="#MeshingTools.generate_mesh-135"><span class="linenos">135</span></a><span class="sd">            y=0, [z=0]) into the mesh. The default is False.</span>
</span><span id="MeshingTools.generate_mesh-136"><a href="#MeshingTools.generate_mesh-136"><span class="linenos">136</span></a><span class="sd">        origin_rf : list, optional</span>
</span><span id="MeshingTools.generate_mesh-137"><a href="#MeshingTools.generate_mesh-137"><span class="linenos">137</span></a><span class="sd">            Settings for refinement around the origin, namely</span>
</span><span id="MeshingTools.generate_mesh-138"><a href="#MeshingTools.generate_mesh-138"><span class="linenos">138</span></a><span class="sd">            [size_min, size_max, dist_min, dist_max].</span>
</span><span id="MeshingTools.generate_mesh-139"><a href="#MeshingTools.generate_mesh-139"><span class="linenos">139</span></a><span class="sd">            The default is [1e-2, 1e-1, 0.1, 1.0].</span>
</span><span id="MeshingTools.generate_mesh-140"><a href="#MeshingTools.generate_mesh-140"><span class="linenos">140</span></a><span class="sd">        unique_boundary_tags : bool, optional</span>
</span><span id="MeshingTools.generate_mesh-141"><a href="#MeshingTools.generate_mesh-141"><span class="linenos">141</span></a><span class="sd">            Assign a single physical group will be created for all elementary</span>
</span><span id="MeshingTools.generate_mesh-142"><a href="#MeshingTools.generate_mesh-142"><span class="linenos">142</span></a><span class="sd">            entities that are parts of a shape&#39;s boundary. The default is True.</span>
</span><span id="MeshingTools.generate_mesh-143"><a href="#MeshingTools.generate_mesh-143"><span class="linenos">143</span></a><span class="sd">        cylindrical_symmetry : bool, optional</span>
</span><span id="MeshingTools.generate_mesh-144"><a href="#MeshingTools.generate_mesh-144"><span class="linenos">144</span></a><span class="sd">            Whether the 2D mesh corresponds to a cylindrically symmetric</span>
</span><span id="MeshingTools.generate_mesh-145"><a href="#MeshingTools.generate_mesh-145"><span class="linenos">145</span></a><span class="sd">            problem. The default is False.</span>
</span><span id="MeshingTools.generate_mesh-146"><a href="#MeshingTools.generate_mesh-146"><span class="linenos">146</span></a><span class="sd">        verbose : bool, optional</span>
</span><span id="MeshingTools.generate_mesh-147"><a href="#MeshingTools.generate_mesh-147"><span class="linenos">147</span></a><span class="sd">            The default is False.</span>
</span><span id="MeshingTools.generate_mesh-148"><a href="#MeshingTools.generate_mesh-148"><span class="linenos">148</span></a>
</span><span id="MeshingTools.generate_mesh-149"><a href="#MeshingTools.generate_mesh-149"><span class="linenos">149</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools.generate_mesh-150"><a href="#MeshingTools.generate_mesh-150"><span class="linenos">150</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools.generate_mesh-151"><a href="#MeshingTools.generate_mesh-151"><span class="linenos">151</span></a><span class="sd">        mesh_path_name : str</span>
</span><span id="MeshingTools.generate_mesh-152"><a href="#MeshingTools.generate_mesh-152"><span class="linenos">152</span></a><span class="sd">            Absolute path name of the created mesh file.</span>
</span><span id="MeshingTools.generate_mesh-153"><a href="#MeshingTools.generate_mesh-153"><span class="linenos">153</span></a>
</span><span id="MeshingTools.generate_mesh-154"><a href="#MeshingTools.generate_mesh-154"><span class="linenos">154</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.generate_mesh-155"><a href="#MeshingTools.generate_mesh-155"><span class="linenos">155</span></a>
</span><span id="MeshingTools.generate_mesh-156"><a href="#MeshingTools.generate_mesh-156"><span class="linenos">156</span></a>        <span class="c1"># Get keyword arguments</span>
</span><span id="MeshingTools.generate_mesh-157"><a href="#MeshingTools.generate_mesh-157"><span class="linenos">157</span></a>        <span class="n">ignored_tags</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ignored_tags&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="MeshingTools.generate_mesh-158"><a href="#MeshingTools.generate_mesh-158"><span class="linenos">158</span></a>        <span class="n">convert</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;convert&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-159"><a href="#MeshingTools.generate_mesh-159"><span class="linenos">159</span></a>        <span class="n">embed_origin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;embed_origin&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-160"><a href="#MeshingTools.generate_mesh-160"><span class="linenos">160</span></a>        <span class="n">origin_rf</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;origin_rf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="MeshingTools.generate_mesh-161"><a href="#MeshingTools.generate_mesh-161"><span class="linenos">161</span></a>        <span class="n">unique_boundary_tags</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unique_boundary_tags&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-162"><a href="#MeshingTools.generate_mesh-162"><span class="linenos">162</span></a>        <span class="n">cylindrical_symmetry</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cylindrical_symmetry&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-163"><a href="#MeshingTools.generate_mesh-163"><span class="linenos">163</span></a>        <span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-164"><a href="#MeshingTools.generate_mesh-164"><span class="linenos">164</span></a>        <span class="n">origin_tag</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MeshingTools.generate_mesh-165"><a href="#MeshingTools.generate_mesh-165"><span class="linenos">165</span></a>
</span><span id="MeshingTools.generate_mesh-166"><a href="#MeshingTools.generate_mesh-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_subdomain</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-167"><a href="#MeshingTools.generate_mesh-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-168"><a href="#MeshingTools.generate_mesh-168"><span class="linenos">168</span></a>
</span><span id="MeshingTools.generate_mesh-169"><a href="#MeshingTools.generate_mesh-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="n">cylindrical_symmetry</span><span class="p">:</span>
</span><span id="MeshingTools.generate_mesh-170"><a href="#MeshingTools.generate_mesh-170"><span class="linenos">170</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_cylindrical_symmetry</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-171"><a href="#MeshingTools.generate_mesh-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>
</span><span id="MeshingTools.generate_mesh-172"><a href="#MeshingTools.generate_mesh-172"><span class="linenos">172</span></a>            <span class="n">origin_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-173"><a href="#MeshingTools.generate_mesh-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-174"><a href="#MeshingTools.generate_mesh-174"><span class="linenos">174</span></a>
</span><span id="MeshingTools.generate_mesh-175"><a href="#MeshingTools.generate_mesh-175"><span class="linenos">175</span></a>        <span class="c1"># Refinement settings</span>
</span><span id="MeshingTools.generate_mesh-176"><a href="#MeshingTools.generate_mesh-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_refinement_settings</span><span class="p">(</span><span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span> <span class="n">origin_rf</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-177"><a href="#MeshingTools.generate_mesh-177"><span class="linenos">177</span></a>
</span><span id="MeshingTools.generate_mesh-178"><a href="#MeshingTools.generate_mesh-178"><span class="linenos">178</span></a>        <span class="k">if</span> <span class="n">embed_origin</span><span class="p">:</span>  <span class="c1"># Force the embedding of the origin to the mesh</span>
</span><span id="MeshingTools.generate_mesh-179"><a href="#MeshingTools.generate_mesh-179"><span class="linenos">179</span></a>            <span class="n">is_on_curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">cylindrical_symmetry</span>
</span><span id="MeshingTools.generate_mesh-180"><a href="#MeshingTools.generate_mesh-180"><span class="linenos">180</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_embed_origin_to_mesh</span><span class="p">(</span><span class="n">origin_tag</span><span class="p">,</span> <span class="n">is_on_curve</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-181"><a href="#MeshingTools.generate_mesh-181"><span class="linenos">181</span></a>
</span><span id="MeshingTools.generate_mesh-182"><a href="#MeshingTools.generate_mesh-182"><span class="linenos">182</span></a>        <span class="c1"># Assign physical groups</span>
</span><span id="MeshingTools.generate_mesh-183"><a href="#MeshingTools.generate_mesh-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assign_physical_groups</span><span class="p">(</span><span class="n">embed_origin</span><span class="p">,</span> <span class="n">origin_tag</span><span class="p">,</span>
</span><span id="MeshingTools.generate_mesh-184"><a href="#MeshingTools.generate_mesh-184"><span class="linenos">184</span></a>                                     <span class="n">unique_boundary_tags</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-185"><a href="#MeshingTools.generate_mesh-185"><span class="linenos">185</span></a>
</span><span id="MeshingTools.generate_mesh-186"><a href="#MeshingTools.generate_mesh-186"><span class="linenos">186</span></a>        <span class="c1"># Actual mesh generation</span>
</span><span id="MeshingTools.generate_mesh-187"><a href="#MeshingTools.generate_mesh-187"><span class="linenos">187</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-188"><a href="#MeshingTools.generate_mesh-188"><span class="linenos">188</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">removeDuplicateNodes</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-189"><a href="#MeshingTools.generate_mesh-189"><span class="linenos">189</span></a>
</span><span id="MeshingTools.generate_mesh-190"><a href="#MeshingTools.generate_mesh-190"><span class="linenos">190</span></a>        <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Inspect the log:</span>
</span><span id="MeshingTools.generate_mesh-191"><a href="#MeshingTools.generate_mesh-191"><span class="linenos">191</span></a>            <span class="n">log</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-192"><a href="#MeshingTools.generate_mesh-192"><span class="linenos">192</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logger has recorded </span><span class="si">{}</span><span class="s2"> lines&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">log</span><span class="p">)))</span>
</span><span id="MeshingTools.generate_mesh-193"><a href="#MeshingTools.generate_mesh-193"><span class="linenos">193</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-194"><a href="#MeshingTools.generate_mesh-194"><span class="linenos">194</span></a>
</span><span id="MeshingTools.generate_mesh-195"><a href="#MeshingTools.generate_mesh-195"><span class="linenos">195</span></a>        <span class="k">if</span> <span class="n">show_mesh</span><span class="p">:</span>  <span class="c1"># open Gmsh graphical interface</span>
</span><span id="MeshingTools.generate_mesh-196"><a href="#MeshingTools.generate_mesh-196"><span class="linenos">196</span></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-197"><a href="#MeshingTools.generate_mesh-197"><span class="linenos">197</span></a>        <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">convert</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="MeshingTools.generate_mesh-198"><a href="#MeshingTools.generate_mesh-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.generate_mesh-199"><a href="#MeshingTools.generate_mesh-199"><span class="linenos">199</span></a>
</span><span id="MeshingTools.generate_mesh-200"><a href="#MeshingTools.generate_mesh-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="n">mesh_path_name</span>
</span></pre></div>


            <div class="docstring"><p>Generate the mesh and save it.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mesh_name</strong> (str):
Name of the mesh file to be created. If not specified as an absolute
path name, will be stored in the <code>MESH_DIR</code> directory.</li>
<li><strong>show_mesh</strong> (bool, optional):
Open the Gmsh graphical user interface to inspect the mesh.
The default is False.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>ignored_tags</strong> (list, optional):
List of physical groups not to be included in the final .vtk file.
The default is [].</li>
<li><strong>convert</strong> (bool, optional):
Convert the .vtk mesh file created by Gmsh into a .vtk file readable
by Sfepy. The default is True.</li>
<li><strong>embed_origin</strong> (bool, optional):
Force the embedding of the origin (i.e. point of coordinates x=0,
y=0, [z=0]) into the mesh. The default is False.</li>
<li><strong>origin_rf</strong> (list, optional):
Settings for refinement around the origin, namely
[size_min, size_max, dist_min, dist_max].
The default is [1e-2, 1e-1, 0.1, 1.0].</li>
<li><strong>unique_boundary_tags</strong> (bool, optional):
Assign a single physical group will be created for all elementary
entities that are parts of a shape's boundary. The default is True.</li>
<li><strong>cylindrical_symmetry</strong> (bool, optional):
Whether the 2D mesh corresponds to a cylindrically symmetric
problem. The default is False.</li>
<li><strong>verbose</strong> (bool, optional):
The default is False.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>mesh_path_name</strong> (str):
Absolute path name of the created mesh file.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_subdomain" class="classattr">
                                        <input id="MeshingTools.create_subdomain-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_subdomain</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">cell_size_min</span><span class="o">=</span><span class="mf">0.1</span>,</span><span class="param">	<span class="n">cell_size_max</span><span class="o">=</span><span class="mf">0.1</span>,</span><span class="param">	<span class="n">dist_min</span><span class="o">=</span><span class="mf">0.0</span>,</span><span class="param">	<span class="n">dist_max</span><span class="o">=</span><span class="mf">1.0</span>,</span><span class="param">	<span class="n">number_pts_per_curve</span><span class="o">=</span><span class="mi">1000</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_subdomain-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_subdomain"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_subdomain-202"><a href="#MeshingTools.create_subdomain-202"><span class="linenos">202</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_subdomain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="MeshingTools.create_subdomain-203"><a href="#MeshingTools.create_subdomain-203"><span class="linenos">203</span></a>                         <span class="n">cell_size_min</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">cell_size_max</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="MeshingTools.create_subdomain-204"><a href="#MeshingTools.create_subdomain-204"><span class="linenos">204</span></a>                         <span class="n">dist_min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dist_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="MeshingTools.create_subdomain-205"><a href="#MeshingTools.create_subdomain-205"><span class="linenos">205</span></a>                         <span class="n">number_pts_per_curve</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="MeshingTools.create_subdomain-206"><a href="#MeshingTools.create_subdomain-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.create_subdomain-207"><a href="#MeshingTools.create_subdomain-207"><span class="linenos">207</span></a><span class="sd">        Creates a subdomain from the shapes currently in an open gmsh window.</span>
</span><span id="MeshingTools.create_subdomain-208"><a href="#MeshingTools.create_subdomain-208"><span class="linenos">208</span></a><span class="sd">        Shapes already present in previous subdomains will not be added to the</span>
</span><span id="MeshingTools.create_subdomain-209"><a href="#MeshingTools.create_subdomain-209"><span class="linenos">209</span></a><span class="sd">        new one. This subdomain will be labeled by an index value corresponding</span>
</span><span id="MeshingTools.create_subdomain-210"><a href="#MeshingTools.create_subdomain-210"><span class="linenos">210</span></a><span class="sd">        to the next available integer value.</span>
</span><span id="MeshingTools.create_subdomain-211"><a href="#MeshingTools.create_subdomain-211"><span class="linenos">211</span></a><span class="sd">        The size of mesh cells at distances less than &#39;DistMin&#39; from the</span>
</span><span id="MeshingTools.create_subdomain-212"><a href="#MeshingTools.create_subdomain-212"><span class="linenos">212</span></a><span class="sd">        boundary of this subdomain will be &#39;SizeMin&#39;, while at distances</span>
</span><span id="MeshingTools.create_subdomain-213"><a href="#MeshingTools.create_subdomain-213"><span class="linenos">213</span></a><span class="sd">        greater than &#39;DistMax&#39; cell size is &#39;SizeMax&#39;. Between &#39;DistMin&#39;</span>
</span><span id="MeshingTools.create_subdomain-214"><a href="#MeshingTools.create_subdomain-214"><span class="linenos">214</span></a><span class="sd">        and &#39;DistMax&#39; cell size will increase linearly.</span>
</span><span id="MeshingTools.create_subdomain-215"><a href="#MeshingTools.create_subdomain-215"><span class="linenos">215</span></a>
</span><span id="MeshingTools.create_subdomain-216"><a href="#MeshingTools.create_subdomain-216"><span class="linenos">216</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.create_subdomain-217"><a href="#MeshingTools.create_subdomain-217"><span class="linenos">217</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.create_subdomain-218"><a href="#MeshingTools.create_subdomain-218"><span class="linenos">218</span></a><span class="sd">        cell_size_min : float, optional</span>
</span><span id="MeshingTools.create_subdomain-219"><a href="#MeshingTools.create_subdomain-219"><span class="linenos">219</span></a><span class="sd">            Minimum size of the mesh cells. The default is 0.1.</span>
</span><span id="MeshingTools.create_subdomain-220"><a href="#MeshingTools.create_subdomain-220"><span class="linenos">220</span></a><span class="sd">        cell_size_max : float, optional</span>
</span><span id="MeshingTools.create_subdomain-221"><a href="#MeshingTools.create_subdomain-221"><span class="linenos">221</span></a><span class="sd">            Maximum size of the mesh cells. The default is 0.1.</span>
</span><span id="MeshingTools.create_subdomain-222"><a href="#MeshingTools.create_subdomain-222"><span class="linenos">222</span></a><span class="sd">        dist_min : float, optional</span>
</span><span id="MeshingTools.create_subdomain-223"><a href="#MeshingTools.create_subdomain-223"><span class="linenos">223</span></a><span class="sd">            At distances less than this value, the cell size is set to its</span>
</span><span id="MeshingTools.create_subdomain-224"><a href="#MeshingTools.create_subdomain-224"><span class="linenos">224</span></a><span class="sd">            minimum. The default is 0.0.</span>
</span><span id="MeshingTools.create_subdomain-225"><a href="#MeshingTools.create_subdomain-225"><span class="linenos">225</span></a><span class="sd">        dist_max : float, optional</span>
</span><span id="MeshingTools.create_subdomain-226"><a href="#MeshingTools.create_subdomain-226"><span class="linenos">226</span></a><span class="sd">            At distances greater than this value, the cell size is set to its</span>
</span><span id="MeshingTools.create_subdomain-227"><a href="#MeshingTools.create_subdomain-227"><span class="linenos">227</span></a><span class="sd">            maximum. The default is 1.0.</span>
</span><span id="MeshingTools.create_subdomain-228"><a href="#MeshingTools.create_subdomain-228"><span class="linenos">228</span></a><span class="sd">        number_pts_per_curve : int, optional</span>
</span><span id="MeshingTools.create_subdomain-229"><a href="#MeshingTools.create_subdomain-229"><span class="linenos">229</span></a><span class="sd">            Number of points used to define each curve. The default is 1000.</span>
</span><span id="MeshingTools.create_subdomain-230"><a href="#MeshingTools.create_subdomain-230"><span class="linenos">230</span></a>
</span><span id="MeshingTools.create_subdomain-231"><a href="#MeshingTools.create_subdomain-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.create_subdomain-232"><a href="#MeshingTools.create_subdomain-232"><span class="linenos">232</span></a>
</span><span id="MeshingTools.create_subdomain-233"><a href="#MeshingTools.create_subdomain-233"><span class="linenos">233</span></a>        <span class="c1"># Save sources, remove duplicates, and update the number of sources.</span>
</span><span id="MeshingTools.create_subdomain-234"><a href="#MeshingTools.create_subdomain-234"><span class="linenos">234</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">))</span>
</span><span id="MeshingTools.create_subdomain-235"><a href="#MeshingTools.create_subdomain-235"><span class="linenos">235</span></a>        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span><span class="p">]</span>
</span><span id="MeshingTools.create_subdomain-236"><a href="#MeshingTools.create_subdomain-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_sources</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MeshingTools.create_subdomain-237"><a href="#MeshingTools.create_subdomain-237"><span class="linenos">237</span></a>
</span><span id="MeshingTools.create_subdomain-238"><a href="#MeshingTools.create_subdomain-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="MeshingTools.create_subdomain-239"><a href="#MeshingTools.create_subdomain-239"><span class="linenos">239</span></a>
</span><span id="MeshingTools.create_subdomain-240"><a href="#MeshingTools.create_subdomain-240"><span class="linenos">240</span></a>            <span class="c1"># Save boundary information</span>
</span><span id="MeshingTools.create_subdomain-241"><a href="#MeshingTools.create_subdomain-241"><span class="linenos">241</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="MeshingTools.create_subdomain-242"><a href="#MeshingTools.create_subdomain-242"><span class="linenos">242</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span><span class="p">]</span>
</span><span id="MeshingTools.create_subdomain-243"><a href="#MeshingTools.create_subdomain-243"><span class="linenos">243</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">number_boundaries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MeshingTools.create_subdomain-244"><a href="#MeshingTools.create_subdomain-244"><span class="linenos">244</span></a>
</span><span id="MeshingTools.create_subdomain-245"><a href="#MeshingTools.create_subdomain-245"><span class="linenos">245</span></a>            <span class="c1"># Record refinement settings for this subdomain.</span>
</span><span id="MeshingTools.create_subdomain-246"><a href="#MeshingTools.create_subdomain-246"><span class="linenos">246</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refinement_settings</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">cell_size_min</span><span class="p">,</span> <span class="n">cell_size_max</span><span class="p">,</span>
</span><span id="MeshingTools.create_subdomain-247"><a href="#MeshingTools.create_subdomain-247"><span class="linenos">247</span></a>                                             <span class="n">dist_min</span><span class="p">,</span> <span class="n">dist_max</span><span class="p">,</span>
</span><span id="MeshingTools.create_subdomain-248"><a href="#MeshingTools.create_subdomain-248"><span class="linenos">248</span></a>                                             <span class="n">number_pts_per_curve</span><span class="p">])</span>
</span><span id="MeshingTools.create_subdomain-249"><a href="#MeshingTools.create_subdomain-249"><span class="linenos">249</span></a>
</span><span id="MeshingTools.create_subdomain-250"><a href="#MeshingTools.create_subdomain-250"><span class="linenos">250</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># new entry is empty</span>
</span><span id="MeshingTools.create_subdomain-251"><a href="#MeshingTools.create_subdomain-251"><span class="linenos">251</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Creates a subdomain from the shapes currently in an open gmsh window.
Shapes already present in previous subdomains will not be added to the
new one. This subdomain will be labeled by an index value corresponding
to the next available integer value.
The size of mesh cells at distances less than 'DistMin' from the
boundary of this subdomain will be 'SizeMin', while at distances
greater than 'DistMax' cell size is 'SizeMax'. Between 'DistMin'
and 'DistMax' cell size will increase linearly.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>cell_size_min</strong> (float, optional):
Minimum size of the mesh cells. The default is 0.1.</li>
<li><strong>cell_size_max</strong> (float, optional):
Maximum size of the mesh cells. The default is 0.1.</li>
<li><strong>dist_min</strong> (float, optional):
At distances less than this value, the cell size is set to its
minimum. The default is 0.0.</li>
<li><strong>dist_max</strong> (float, optional):
At distances greater than this value, the cell size is set to its
maximum. The default is 1.0.</li>
<li><strong>number_pts_per_curve</strong> (int, optional):
Number of points used to define each curve. The default is 1000.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_inversed_exterior_domain_3d" class="classattr">
                                        <input id="MeshingTools.create_inversed_exterior_domain_3d-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_inversed_exterior_domain_3d</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_inversed_exterior_domain_3d-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_inversed_exterior_domain_3d"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_inversed_exterior_domain_3d-63"><a href="#MeshingTools.create_inversed_exterior_domain_3d-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.create_inversed_exterior_domain_3d-64"><a href="#MeshingTools.create_inversed_exterior_domain_3d-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.create_inversed_exterior_domain_3d-65"><a href="#MeshingTools.create_inversed_exterior_domain_3d-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.create_inversed_exterior_domain_3d-66"><a href="#MeshingTools.create_inversed_exterior_domain_3d-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.create_inversed_exterior_domain_3d-67"><a href="#MeshingTools.create_inversed_exterior_domain_3d-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.create_inversed_exterior_domain_3d-68"><a href="#MeshingTools.create_inversed_exterior_domain_3d-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.create_inversed_exterior_domain_3d-69"><a href="#MeshingTools.create_inversed_exterior_domain_3d-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a solid sphere whose surface DOFs match the last created shape
boundary. Because the exterior mesh has to be spatially separated from
all other geometries, its center of mass is set three radii away from
the interior domain along the x-axis.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>inversed_exterior_domain_3d</strong> (list):
List containing tuple representing the inversed exterior domain
(which is a sphere).</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_ellipse" class="classattr">
                                        <input id="MeshingTools.create_ellipse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_ellipse</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_ellipse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_ellipse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_ellipse-63"><a href="#MeshingTools.create_ellipse-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.create_ellipse-64"><a href="#MeshingTools.create_ellipse-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.create_ellipse-65"><a href="#MeshingTools.create_ellipse-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.create_ellipse-66"><a href="#MeshingTools.create_ellipse-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.create_ellipse-67"><a href="#MeshingTools.create_ellipse-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.create_ellipse-68"><a href="#MeshingTools.create_ellipse-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.create_ellipse-69"><a href="#MeshingTools.create_ellipse-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create an ellipse with given semi-major axis / semi-minor axis and
center position.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>rx</strong> (float, optional):
Ellipse radial size along x-axis. The default is 0.1.</li>
<li><strong>ry</strong> (float, optional):
Ellipse radial size along y-axis. The default is 0.1.</li>
<li><strong>xc</strong> (float, optional):
Ellipse center along x-axis. The default is 0.0.</li>
<li><strong>yc</strong> (float, optional):
Ellipse center along y-axis. The defautl is 0.0.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ellipse</strong> (list):
List containing the ellipse dimTag.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_rectangle" class="classattr">
                                        <input id="MeshingTools.create_rectangle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_rectangle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_rectangle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_rectangle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_rectangle-63"><a href="#MeshingTools.create_rectangle-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.create_rectangle-64"><a href="#MeshingTools.create_rectangle-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.create_rectangle-65"><a href="#MeshingTools.create_rectangle-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.create_rectangle-66"><a href="#MeshingTools.create_rectangle-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.create_rectangle-67"><a href="#MeshingTools.create_rectangle-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.create_rectangle-68"><a href="#MeshingTools.create_rectangle-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.create_rectangle-69"><a href="#MeshingTools.create_rectangle-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a rectangle specified by its side lengths and position.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dx</strong> (float, optional):
Length of rectangle along x-axis. The default is 1.0.</li>
<li><strong>dy</strong> (float, optional):
Length of rectangle along y-axis. The default is 1.0.</li>
<li><strong>xll</strong> (float, optional):
Low left corner x-coordinate. The default is 0.0.</li>
<li><strong>yll</strong> (float, optional):
Low left corner y-coordinate. The default is 0.0.</li>
<li><strong>centered</strong> (bool, optional):
Whether the rectangle is origin-centered. If True, ignores keyword
parameters <code>xll</code> and <code>yll</code>. The default is False.</li>
<li><strong>vperiodic</strong> (bool, optional):
Whether the mesh is periodic in the vertical direction.
The default is False.</li>
<li><strong>hperiodic</strong> (bool, optional):
Whether the mesh is periodic in the horizontal direction.
The default is False.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>rectangle</strong> (list):
List containing the rectangle dimTag.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_disk_from_pts" class="classattr">
                                        <input id="MeshingTools.create_disk_from_pts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_disk_from_pts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_disk_from_pts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_disk_from_pts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_disk_from_pts-63"><a href="#MeshingTools.create_disk_from_pts-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.create_disk_from_pts-64"><a href="#MeshingTools.create_disk_from_pts-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.create_disk_from_pts-65"><a href="#MeshingTools.create_disk_from_pts-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.create_disk_from_pts-66"><a href="#MeshingTools.create_disk_from_pts-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.create_disk_from_pts-67"><a href="#MeshingTools.create_disk_from_pts-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.create_disk_from_pts-68"><a href="#MeshingTools.create_disk_from_pts-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.create_disk_from_pts-69"><a href="#MeshingTools.create_disk_from_pts-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>@author: Hugo LÃ©vy
Generates a disk with a given number of evenly spaced points across
the circular boundary.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>radius</strong> (float):
Radius of the disk.</li>
<li><strong>N</strong> (int, optional):
Number of points defining the boundary. The default is 100.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>disk</strong> (list):
List containing the disk dimTag.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.points_to_surface" class="classattr">
                                        <input id="MeshingTools.points_to_surface-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">points_to_surface</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.points_to_surface-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.points_to_surface"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.points_to_surface-63"><a href="#MeshingTools.points_to_surface-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.points_to_surface-64"><a href="#MeshingTools.points_to_surface-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.points_to_surface-65"><a href="#MeshingTools.points_to_surface-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.points_to_surface-66"><a href="#MeshingTools.points_to_surface-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.points_to_surface-67"><a href="#MeshingTools.points_to_surface-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.points_to_surface-68"><a href="#MeshingTools.points_to_surface-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.points_to_surface-69"><a href="#MeshingTools.points_to_surface-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a closed surface whose boundary is defined by a list of points.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>points_list</strong> (list or ndarray):
List containing the points which define the surface boundary.
Each element of the list is a triplet (x, y, z) corresponding to
the coordinates of the point it represents.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>surface_dimTag</strong> (tuple):
Tuple containing the dimension and tag (i.e. dimTag) of the
created surface.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_ellipsoid" class="classattr">
                                        <input id="MeshingTools.create_ellipsoid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_ellipsoid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_ellipsoid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_ellipsoid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_ellipsoid-63"><a href="#MeshingTools.create_ellipsoid-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.create_ellipsoid-64"><a href="#MeshingTools.create_ellipsoid-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.create_ellipsoid-65"><a href="#MeshingTools.create_ellipsoid-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.create_ellipsoid-66"><a href="#MeshingTools.create_ellipsoid-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.create_ellipsoid-67"><a href="#MeshingTools.create_ellipsoid-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.create_ellipsoid-68"><a href="#MeshingTools.create_ellipsoid-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.create_ellipsoid-69"><a href="#MeshingTools.create_ellipsoid-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create an ellipsoid specified by the length of its semi-axes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>rx, ry, rz</strong> (float, optional):
Ellipsoid radial size along (x, y, z)-axis. The default is 0.1.</li>
<li><strong>xc, yc, zc</strong> (float, optional):
Ellipsoid center along (x, y, z)-axis. The default is 0.0.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ellipsoid</strong> (list):
List containing the ellipsoid dimTag.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_box" class="classattr">
                                        <input id="MeshingTools.create_box-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_box</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_box-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_box"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_box-63"><a href="#MeshingTools.create_box-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.create_box-64"><a href="#MeshingTools.create_box-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.create_box-65"><a href="#MeshingTools.create_box-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.create_box-66"><a href="#MeshingTools.create_box-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.create_box-67"><a href="#MeshingTools.create_box-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.create_box-68"><a href="#MeshingTools.create_box-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.create_box-69"><a href="#MeshingTools.create_box-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a box specified by its side lengths and centered at the origin.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dx, dy, dz</strong> (float, optional):
Length of box along (x, y, z)-axis. The default is 0.2.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>box</strong> (list tuple):
List containing the box dimTag.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_cylinder" class="classattr">
                                        <input id="MeshingTools.create_cylinder-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_cylinder</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_cylinder-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_cylinder"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_cylinder-63"><a href="#MeshingTools.create_cylinder-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.create_cylinder-64"><a href="#MeshingTools.create_cylinder-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.create_cylinder-65"><a href="#MeshingTools.create_cylinder-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.create_cylinder-66"><a href="#MeshingTools.create_cylinder-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.create_cylinder-67"><a href="#MeshingTools.create_cylinder-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.create_cylinder-68"><a href="#MeshingTools.create_cylinder-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.create_cylinder-69"><a href="#MeshingTools.create_cylinder-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>@author: Chad Briddon
Create a cylinder</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>height</strong> (float, optional):
Length of cylinder. The default is 0.1.</li>
<li><strong>radius</strong> (float, optional):
Radial size of cylinder. The default is 0.1.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>cylinder</strong> (list tuple):
List containing the cylinder dimTag.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.create_torus" class="classattr">
                                        <input id="MeshingTools.create_torus-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_torus</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.create_torus-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.create_torus"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.create_torus-63"><a href="#MeshingTools.create_torus-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.create_torus-64"><a href="#MeshingTools.create_torus-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.create_torus-65"><a href="#MeshingTools.create_torus-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.create_torus-66"><a href="#MeshingTools.create_torus-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.create_torus-67"><a href="#MeshingTools.create_torus-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.create_torus-68"><a href="#MeshingTools.create_torus-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.create_torus-69"><a href="#MeshingTools.create_torus-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>@author: Chad Briddon
Generates a torus in an open gmsh window with its centre of mass at
the origin.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>r_hole</strong> (float, optional):
Radius of hole through centre of the torus. The default is 0.1.</li>
<li><strong>r_tube</strong> (float, optional):
Radius of the torus tube. The default is 0.1.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>torus</strong> (list tuple):
List containing the torus dimTag.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.points_to_volume" class="classattr">
                                        <input id="MeshingTools.points_to_volume-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">points_to_volume</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.points_to_volume-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.points_to_volume"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.points_to_volume-63"><a href="#MeshingTools.points_to_volume-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.points_to_volume-64"><a href="#MeshingTools.points_to_volume-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.points_to_volume-65"><a href="#MeshingTools.points_to_volume-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.points_to_volume-66"><a href="#MeshingTools.points_to_volume-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.points_to_volume-67"><a href="#MeshingTools.points_to_volume-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.points_to_volume-68"><a href="#MeshingTools.points_to_volume-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.points_to_volume-69"><a href="#MeshingTools.points_to_volume-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a closed volume whose boundary is defined by list of contours.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>contour_list</strong> (list):
List containing the contours which define the volume boundary. The
contours are themselves a list whose elements are lists, each
containing the x, y, and z coordinates of the point it represents.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>volume_dimTag</strong> (tuple):
Tuple containing the dimension and tag of the generated volume.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.rectangle_cutout" class="classattr">
                                        <input id="MeshingTools.rectangle_cutout-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rectangle_cutout</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.rectangle_cutout-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.rectangle_cutout"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.rectangle_cutout-63"><a href="#MeshingTools.rectangle_cutout-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.rectangle_cutout-64"><a href="#MeshingTools.rectangle_cutout-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.rectangle_cutout-65"><a href="#MeshingTools.rectangle_cutout-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.rectangle_cutout-66"><a href="#MeshingTools.rectangle_cutout-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.rectangle_cutout-67"><a href="#MeshingTools.rectangle_cutout-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.rectangle_cutout-68"><a href="#MeshingTools.rectangle_cutout-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.rectangle_cutout-69"><a href="#MeshingTools.rectangle_cutout-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Intersect the provided shapes with a rectangle (truncation).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>shapes_dimTags</strong> (list):
List of dimTags associated with the shapes to be cutout.</li>
<li><strong>dx</strong> (float):
Length of rectangle along x-axis.</li>
<li><strong>dy</strong> (float):
Length of rectangle along y-axis.</li>
<li><strong>xll</strong> (float):
Low left corner x-coordinate.</li>
<li><strong>yll</strong> (float):
Low left corner y-coordinate.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.radial_cutoff" class="classattr">
                                        <input id="MeshingTools.radial_cutoff-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">radial_cutoff</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shapes_dimTags</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">cutoff_radius</span><span class="o">=</span><span class="mf">1.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.radial_cutoff-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.radial_cutoff"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.radial_cutoff-638"><a href="#MeshingTools.radial_cutoff-638"><span class="linenos">638</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">radial_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_dimTags</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
</span><span id="MeshingTools.radial_cutoff-639"><a href="#MeshingTools.radial_cutoff-639"><span class="linenos">639</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.radial_cutoff-640"><a href="#MeshingTools.radial_cutoff-640"><span class="linenos">640</span></a><span class="sd">        Intersect the provided shapes with a disk (truncation).</span>
</span><span id="MeshingTools.radial_cutoff-641"><a href="#MeshingTools.radial_cutoff-641"><span class="linenos">641</span></a>
</span><span id="MeshingTools.radial_cutoff-642"><a href="#MeshingTools.radial_cutoff-642"><span class="linenos">642</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.radial_cutoff-643"><a href="#MeshingTools.radial_cutoff-643"><span class="linenos">643</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.radial_cutoff-644"><a href="#MeshingTools.radial_cutoff-644"><span class="linenos">644</span></a><span class="sd">        shapes_dimTags : list</span>
</span><span id="MeshingTools.radial_cutoff-645"><a href="#MeshingTools.radial_cutoff-645"><span class="linenos">645</span></a><span class="sd">            List of dimTags associated with the shapes to be cutout.</span>
</span><span id="MeshingTools.radial_cutoff-646"><a href="#MeshingTools.radial_cutoff-646"><span class="linenos">646</span></a><span class="sd">        cutoff_radius : float, optional</span>
</span><span id="MeshingTools.radial_cutoff-647"><a href="#MeshingTools.radial_cutoff-647"><span class="linenos">647</span></a><span class="sd">            The radial size of the cutoff. Any part of a shape that is further</span>
</span><span id="MeshingTools.radial_cutoff-648"><a href="#MeshingTools.radial_cutoff-648"><span class="linenos">648</span></a><span class="sd">            away from the origin than this radius will be erased.</span>
</span><span id="MeshingTools.radial_cutoff-649"><a href="#MeshingTools.radial_cutoff-649"><span class="linenos">649</span></a><span class="sd">            The default is 1.0.</span>
</span><span id="MeshingTools.radial_cutoff-650"><a href="#MeshingTools.radial_cutoff-650"><span class="linenos">650</span></a>
</span><span id="MeshingTools.radial_cutoff-651"><a href="#MeshingTools.radial_cutoff-651"><span class="linenos">651</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.radial_cutoff-652"><a href="#MeshingTools.radial_cutoff-652"><span class="linenos">652</span></a>        <span class="n">dim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">shapes_dimTags</span><span class="p">])</span>  <span class="c1"># dimension of shapes</span>
</span><span id="MeshingTools.radial_cutoff-653"><a href="#MeshingTools.radial_cutoff-653"><span class="linenos">653</span></a>
</span><span id="MeshingTools.radial_cutoff-654"><a href="#MeshingTools.radial_cutoff-654"><span class="linenos">654</span></a>        <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="MeshingTools.radial_cutoff-655"><a href="#MeshingTools.radial_cutoff-655"><span class="linenos">655</span></a>            <span class="n">cutoff</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span><span class="n">xc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools.radial_cutoff-656"><a href="#MeshingTools.radial_cutoff-656"><span class="linenos">656</span></a>                                              <span class="n">radius</span><span class="o">=</span><span class="n">cutoff_radius</span><span class="p">))]</span>
</span><span id="MeshingTools.radial_cutoff-657"><a href="#MeshingTools.radial_cutoff-657"><span class="linenos">657</span></a>        <span class="k">elif</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="MeshingTools.radial_cutoff-658"><a href="#MeshingTools.radial_cutoff-658"><span class="linenos">658</span></a>            <span class="n">cutoff</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cutoff_radius</span><span class="p">,</span>
</span><span id="MeshingTools.radial_cutoff-659"><a href="#MeshingTools.radial_cutoff-659"><span class="linenos">659</span></a>                                            <span class="n">cutoff_radius</span><span class="p">))]</span>
</span><span id="MeshingTools.radial_cutoff-660"><a href="#MeshingTools.radial_cutoff-660"><span class="linenos">660</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools.radial_cutoff-661"><a href="#MeshingTools.radial_cutoff-661"><span class="linenos">661</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No cutoff for 1D shapes!&quot;</span><span class="p">)</span>
</span><span id="MeshingTools.radial_cutoff-662"><a href="#MeshingTools.radial_cutoff-662"><span class="linenos">662</span></a>
</span><span id="MeshingTools.radial_cutoff-663"><a href="#MeshingTools.radial_cutoff-663"><span class="linenos">663</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="MeshingTools.radial_cutoff-664"><a href="#MeshingTools.radial_cutoff-664"><span class="linenos">664</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">objectDimTags</span><span class="o">=</span><span class="n">shapes_dimTags</span><span class="p">,</span> <span class="n">toolDimTags</span><span class="o">=</span><span class="n">cutoff</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Intersect the provided shapes with a disk (truncation).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>shapes_dimTags</strong> (list):
List of dimTags associated with the shapes to be cutout.</li>
<li><strong>cutoff_radius</strong> (float, optional):
The radial size of the cutoff. Any part of a shape that is further
away from the origin than this radius will be erased.
The default is 1.0.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.add_shapes" class="classattr">
                                        <input id="MeshingTools.add_shapes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_shapes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="MeshingTools.add_shapes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.add_shapes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.add_shapes-666"><a href="#MeshingTools.add_shapes-666"><span class="linenos">666</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">add_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools.add_shapes-667"><a href="#MeshingTools.add_shapes-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.add_shapes-668"><a href="#MeshingTools.add_shapes-668"><span class="linenos">668</span></a><span class="sd">        Fuse together elements of `shapes_1` and `shapes_2` to form new group</span>
</span><span id="MeshingTools.add_shapes-669"><a href="#MeshingTools.add_shapes-669"><span class="linenos">669</span></a><span class="sd">        of shapes.</span>
</span><span id="MeshingTools.add_shapes-670"><a href="#MeshingTools.add_shapes-670"><span class="linenos">670</span></a>
</span><span id="MeshingTools.add_shapes-671"><a href="#MeshingTools.add_shapes-671"><span class="linenos">671</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.add_shapes-672"><a href="#MeshingTools.add_shapes-672"><span class="linenos">672</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.add_shapes-673"><a href="#MeshingTools.add_shapes-673"><span class="linenos">673</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="MeshingTools.add_shapes-674"><a href="#MeshingTools.add_shapes-674"><span class="linenos">674</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools.add_shapes-675"><a href="#MeshingTools.add_shapes-675"><span class="linenos">675</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools.add_shapes-676"><a href="#MeshingTools.add_shapes-676"><span class="linenos">676</span></a>
</span><span id="MeshingTools.add_shapes-677"><a href="#MeshingTools.add_shapes-677"><span class="linenos">677</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools.add_shapes-678"><a href="#MeshingTools.add_shapes-678"><span class="linenos">678</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools.add_shapes-679"><a href="#MeshingTools.add_shapes-679"><span class="linenos">679</span></a><span class="sd">        new_shapes : list</span>
</span><span id="MeshingTools.add_shapes-680"><a href="#MeshingTools.add_shapes-680"><span class="linenos">680</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="MeshingTools.add_shapes-681"><a href="#MeshingTools.add_shapes-681"><span class="linenos">681</span></a>
</span><span id="MeshingTools.add_shapes-682"><a href="#MeshingTools.add_shapes-682"><span class="linenos">682</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.add_shapes-683"><a href="#MeshingTools.add_shapes-683"><span class="linenos">683</span></a>
</span><span id="MeshingTools.add_shapes-684"><a href="#MeshingTools.add_shapes-684"><span class="linenos">684</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools.add_shapes-685"><a href="#MeshingTools.add_shapes-685"><span class="linenos">685</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">fuse</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">,</span>
</span><span id="MeshingTools.add_shapes-686"><a href="#MeshingTools.add_shapes-686"><span class="linenos">686</span></a>                                           <span class="n">removeObject</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="MeshingTools.add_shapes-687"><a href="#MeshingTools.add_shapes-687"><span class="linenos">687</span></a>                                           <span class="n">removeTool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MeshingTools.add_shapes-688"><a href="#MeshingTools.add_shapes-688"><span class="linenos">688</span></a>            <span class="c1"># Get rid of unneeded shapes</span>
</span><span id="MeshingTools.add_shapes-689"><a href="#MeshingTools.add_shapes-689"><span class="linenos">689</span></a>            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes_1</span><span class="p">:</span>
</span><span id="MeshingTools.add_shapes-690"><a href="#MeshingTools.add_shapes-690"><span class="linenos">690</span></a>                <span class="k">if</span> <span class="n">shape</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_shapes</span><span class="p">:</span>
</span><span id="MeshingTools.add_shapes-691"><a href="#MeshingTools.add_shapes-691"><span class="linenos">691</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools.add_shapes-692"><a href="#MeshingTools.add_shapes-692"><span class="linenos">692</span></a>            <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools.add_shapes-693"><a href="#MeshingTools.add_shapes-693"><span class="linenos">693</span></a>                <span class="k">if</span> <span class="n">shape</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_shapes</span><span class="p">:</span>
</span><span id="MeshingTools.add_shapes-694"><a href="#MeshingTools.add_shapes-694"><span class="linenos">694</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">([</span><span class="n">shape</span><span class="p">],</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools.add_shapes-695"><a href="#MeshingTools.add_shapes-695"><span class="linenos">695</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools.add_shapes-696"><a href="#MeshingTools.add_shapes-696"><span class="linenos">696</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span>
</span><span id="MeshingTools.add_shapes-697"><a href="#MeshingTools.add_shapes-697"><span class="linenos">697</span></a>
</span><span id="MeshingTools.add_shapes-698"><a href="#MeshingTools.add_shapes-698"><span class="linenos">698</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span></pre></div>


            <div class="docstring"><p>Fuse together elements of <code>shapes_1</code> and <code>shapes_2</code> to form new group
of shapes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>shapes_1, shapes_2</strong> (list):
List of tuples representing a group of shapes. Each tuple contains
the dimension and tag (i.e. dimTag) of its corresponding shape.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>new_shapes</strong> (list):
List of tuples representing the new group of shapes.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.subtract_shapes" class="classattr">
                                        <input id="MeshingTools.subtract_shapes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">subtract_shapes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">removeObject</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">removeTool</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="MeshingTools.subtract_shapes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.subtract_shapes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.subtract_shapes-700"><a href="#MeshingTools.subtract_shapes-700"><span class="linenos">700</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">subtract_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="MeshingTools.subtract_shapes-701"><a href="#MeshingTools.subtract_shapes-701"><span class="linenos">701</span></a>                        <span class="n">removeObject</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">removeTool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools.subtract_shapes-702"><a href="#MeshingTools.subtract_shapes-702"><span class="linenos">702</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.subtract_shapes-703"><a href="#MeshingTools.subtract_shapes-703"><span class="linenos">703</span></a><span class="sd">        Subtract elements of `shapes_2` from `shapes_1` to form new group of</span>
</span><span id="MeshingTools.subtract_shapes-704"><a href="#MeshingTools.subtract_shapes-704"><span class="linenos">704</span></a><span class="sd">        shapes.</span>
</span><span id="MeshingTools.subtract_shapes-705"><a href="#MeshingTools.subtract_shapes-705"><span class="linenos">705</span></a>
</span><span id="MeshingTools.subtract_shapes-706"><a href="#MeshingTools.subtract_shapes-706"><span class="linenos">706</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.subtract_shapes-707"><a href="#MeshingTools.subtract_shapes-707"><span class="linenos">707</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.subtract_shapes-708"><a href="#MeshingTools.subtract_shapes-708"><span class="linenos">708</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="MeshingTools.subtract_shapes-709"><a href="#MeshingTools.subtract_shapes-709"><span class="linenos">709</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools.subtract_shapes-710"><a href="#MeshingTools.subtract_shapes-710"><span class="linenos">710</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools.subtract_shapes-711"><a href="#MeshingTools.subtract_shapes-711"><span class="linenos">711</span></a><span class="sd">        removeObject : bool, optional</span>
</span><span id="MeshingTools.subtract_shapes-712"><a href="#MeshingTools.subtract_shapes-712"><span class="linenos">712</span></a><span class="sd">            Delete the object shape if set to True. The default is False.</span>
</span><span id="MeshingTools.subtract_shapes-713"><a href="#MeshingTools.subtract_shapes-713"><span class="linenos">713</span></a><span class="sd">        removeTool : bool, optional</span>
</span><span id="MeshingTools.subtract_shapes-714"><a href="#MeshingTools.subtract_shapes-714"><span class="linenos">714</span></a><span class="sd">            Delete the tool shape if set to True. The default is False.</span>
</span><span id="MeshingTools.subtract_shapes-715"><a href="#MeshingTools.subtract_shapes-715"><span class="linenos">715</span></a>
</span><span id="MeshingTools.subtract_shapes-716"><a href="#MeshingTools.subtract_shapes-716"><span class="linenos">716</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools.subtract_shapes-717"><a href="#MeshingTools.subtract_shapes-717"><span class="linenos">717</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools.subtract_shapes-718"><a href="#MeshingTools.subtract_shapes-718"><span class="linenos">718</span></a><span class="sd">        new_shapes : list</span>
</span><span id="MeshingTools.subtract_shapes-719"><a href="#MeshingTools.subtract_shapes-719"><span class="linenos">719</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="MeshingTools.subtract_shapes-720"><a href="#MeshingTools.subtract_shapes-720"><span class="linenos">720</span></a>
</span><span id="MeshingTools.subtract_shapes-721"><a href="#MeshingTools.subtract_shapes-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.subtract_shapes-722"><a href="#MeshingTools.subtract_shapes-722"><span class="linenos">722</span></a>
</span><span id="MeshingTools.subtract_shapes-723"><a href="#MeshingTools.subtract_shapes-723"><span class="linenos">723</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools.subtract_shapes-724"><a href="#MeshingTools.subtract_shapes-724"><span class="linenos">724</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span>
</span><span id="MeshingTools.subtract_shapes-725"><a href="#MeshingTools.subtract_shapes-725"><span class="linenos">725</span></a>                                          <span class="n">shapes_2</span><span class="p">,</span>
</span><span id="MeshingTools.subtract_shapes-726"><a href="#MeshingTools.subtract_shapes-726"><span class="linenos">726</span></a>                                          <span class="n">removeObject</span><span class="o">=</span><span class="n">removeObject</span><span class="p">,</span>
</span><span id="MeshingTools.subtract_shapes-727"><a href="#MeshingTools.subtract_shapes-727"><span class="linenos">727</span></a>                                          <span class="n">removeTool</span><span class="o">=</span><span class="n">removeTool</span><span class="p">)</span>
</span><span id="MeshingTools.subtract_shapes-728"><a href="#MeshingTools.subtract_shapes-728"><span class="linenos">728</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools.subtract_shapes-729"><a href="#MeshingTools.subtract_shapes-729"><span class="linenos">729</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="n">shapes_1</span>
</span><span id="MeshingTools.subtract_shapes-730"><a href="#MeshingTools.subtract_shapes-730"><span class="linenos">730</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools.subtract_shapes-731"><a href="#MeshingTools.subtract_shapes-731"><span class="linenos">731</span></a>
</span><span id="MeshingTools.subtract_shapes-732"><a href="#MeshingTools.subtract_shapes-732"><span class="linenos">732</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span></pre></div>


            <div class="docstring"><p>Subtract elements of <code>shapes_2</code> from <code>shapes_1</code> to form new group of
shapes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>shapes_1, shapes_2</strong> (list):
List of tuples representing a group of shapes. Each tuple contains
the dimension and tag (i.e. dimTag) of its corresponding shape.</li>
<li><strong>removeObject</strong> (bool, optional):
Delete the object shape if set to True. The default is False.</li>
<li><strong>removeTool</strong> (bool, optional):
Delete the tool shape if set to True. The default is False.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>new_shapes</strong> (list):
List of tuples representing the new group of shapes.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.intersect_shapes" class="classattr">
                                        <input id="MeshingTools.intersect_shapes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersect_shapes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="MeshingTools.intersect_shapes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.intersect_shapes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.intersect_shapes-734"><a href="#MeshingTools.intersect_shapes-734"><span class="linenos">734</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">intersect_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools.intersect_shapes-735"><a href="#MeshingTools.intersect_shapes-735"><span class="linenos">735</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.intersect_shapes-736"><a href="#MeshingTools.intersect_shapes-736"><span class="linenos">736</span></a><span class="sd">        Create group of shapes consisting of the intersection of elements</span>
</span><span id="MeshingTools.intersect_shapes-737"><a href="#MeshingTools.intersect_shapes-737"><span class="linenos">737</span></a><span class="sd">        from `shapes_1` and `shapes_2`.</span>
</span><span id="MeshingTools.intersect_shapes-738"><a href="#MeshingTools.intersect_shapes-738"><span class="linenos">738</span></a>
</span><span id="MeshingTools.intersect_shapes-739"><a href="#MeshingTools.intersect_shapes-739"><span class="linenos">739</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.intersect_shapes-740"><a href="#MeshingTools.intersect_shapes-740"><span class="linenos">740</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.intersect_shapes-741"><a href="#MeshingTools.intersect_shapes-741"><span class="linenos">741</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="MeshingTools.intersect_shapes-742"><a href="#MeshingTools.intersect_shapes-742"><span class="linenos">742</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools.intersect_shapes-743"><a href="#MeshingTools.intersect_shapes-743"><span class="linenos">743</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools.intersect_shapes-744"><a href="#MeshingTools.intersect_shapes-744"><span class="linenos">744</span></a>
</span><span id="MeshingTools.intersect_shapes-745"><a href="#MeshingTools.intersect_shapes-745"><span class="linenos">745</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools.intersect_shapes-746"><a href="#MeshingTools.intersect_shapes-746"><span class="linenos">746</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools.intersect_shapes-747"><a href="#MeshingTools.intersect_shapes-747"><span class="linenos">747</span></a><span class="sd">        new_shapes : list</span>
</span><span id="MeshingTools.intersect_shapes-748"><a href="#MeshingTools.intersect_shapes-748"><span class="linenos">748</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="MeshingTools.intersect_shapes-749"><a href="#MeshingTools.intersect_shapes-749"><span class="linenos">749</span></a>
</span><span id="MeshingTools.intersect_shapes-750"><a href="#MeshingTools.intersect_shapes-750"><span class="linenos">750</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.intersect_shapes-751"><a href="#MeshingTools.intersect_shapes-751"><span class="linenos">751</span></a>
</span><span id="MeshingTools.intersect_shapes-752"><a href="#MeshingTools.intersect_shapes-752"><span class="linenos">752</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools.intersect_shapes-753"><a href="#MeshingTools.intersect_shapes-753"><span class="linenos">753</span></a>            <span class="n">new_shapes</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">)</span>
</span><span id="MeshingTools.intersect_shapes-754"><a href="#MeshingTools.intersect_shapes-754"><span class="linenos">754</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools.intersect_shapes-755"><a href="#MeshingTools.intersect_shapes-755"><span class="linenos">755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools.intersect_shapes-756"><a href="#MeshingTools.intersect_shapes-756"><span class="linenos">756</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools.intersect_shapes-757"><a href="#MeshingTools.intersect_shapes-757"><span class="linenos">757</span></a>
</span><span id="MeshingTools.intersect_shapes-758"><a href="#MeshingTools.intersect_shapes-758"><span class="linenos">758</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span></pre></div>


            <div class="docstring"><p>Create group of shapes consisting of the intersection of elements
from <code>shapes_1</code> and <code>shapes_2</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>shapes_1, shapes_2</strong> (list):
List of tuples representing a group of shapes. Each tuple contains
the dimension and tag (i.e. dimTag) of its corresponding shape.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>new_shapes</strong> (list):
List of tuples representing the new group of shapes.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.non_intersect_shapes" class="classattr">
                                        <input id="MeshingTools.non_intersect_shapes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">non_intersect_shapes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="MeshingTools.non_intersect_shapes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.non_intersect_shapes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.non_intersect_shapes-760"><a href="#MeshingTools.non_intersect_shapes-760"><span class="linenos">760</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">non_intersect_shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes_1</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools.non_intersect_shapes-761"><a href="#MeshingTools.non_intersect_shapes-761"><span class="linenos">761</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.non_intersect_shapes-762"><a href="#MeshingTools.non_intersect_shapes-762"><span class="linenos">762</span></a><span class="sd">        Create group of shapes consisting of the non-intersection of elements</span>
</span><span id="MeshingTools.non_intersect_shapes-763"><a href="#MeshingTools.non_intersect_shapes-763"><span class="linenos">763</span></a><span class="sd">        from `shapes_1` and `shapes_2`.</span>
</span><span id="MeshingTools.non_intersect_shapes-764"><a href="#MeshingTools.non_intersect_shapes-764"><span class="linenos">764</span></a>
</span><span id="MeshingTools.non_intersect_shapes-765"><a href="#MeshingTools.non_intersect_shapes-765"><span class="linenos">765</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.non_intersect_shapes-766"><a href="#MeshingTools.non_intersect_shapes-766"><span class="linenos">766</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.non_intersect_shapes-767"><a href="#MeshingTools.non_intersect_shapes-767"><span class="linenos">767</span></a><span class="sd">        shapes_1, shapes_2 : list</span>
</span><span id="MeshingTools.non_intersect_shapes-768"><a href="#MeshingTools.non_intersect_shapes-768"><span class="linenos">768</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools.non_intersect_shapes-769"><a href="#MeshingTools.non_intersect_shapes-769"><span class="linenos">769</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools.non_intersect_shapes-770"><a href="#MeshingTools.non_intersect_shapes-770"><span class="linenos">770</span></a>
</span><span id="MeshingTools.non_intersect_shapes-771"><a href="#MeshingTools.non_intersect_shapes-771"><span class="linenos">771</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools.non_intersect_shapes-772"><a href="#MeshingTools.non_intersect_shapes-772"><span class="linenos">772</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools.non_intersect_shapes-773"><a href="#MeshingTools.non_intersect_shapes-773"><span class="linenos">773</span></a><span class="sd">        new_shapes : list of tuple</span>
</span><span id="MeshingTools.non_intersect_shapes-774"><a href="#MeshingTools.non_intersect_shapes-774"><span class="linenos">774</span></a><span class="sd">            List of tuples representing the new group of shapes.</span>
</span><span id="MeshingTools.non_intersect_shapes-775"><a href="#MeshingTools.non_intersect_shapes-775"><span class="linenos">775</span></a>
</span><span id="MeshingTools.non_intersect_shapes-776"><a href="#MeshingTools.non_intersect_shapes-776"><span class="linenos">776</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.non_intersect_shapes-777"><a href="#MeshingTools.non_intersect_shapes-777"><span class="linenos">777</span></a>
</span><span id="MeshingTools.non_intersect_shapes-778"><a href="#MeshingTools.non_intersect_shapes-778"><span class="linenos">778</span></a>        <span class="k">if</span> <span class="n">shapes_1</span> <span class="ow">and</span> <span class="n">shapes_2</span><span class="p">:</span>
</span><span id="MeshingTools.non_intersect_shapes-779"><a href="#MeshingTools.non_intersect_shapes-779"><span class="linenos">779</span></a>            <span class="n">_</span><span class="p">,</span> <span class="n">fragment_map</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">fragment</span><span class="p">(</span><span class="n">shapes_1</span><span class="p">,</span> <span class="n">shapes_2</span><span class="p">)</span>
</span><span id="MeshingTools.non_intersect_shapes-780"><a href="#MeshingTools.non_intersect_shapes-780"><span class="linenos">780</span></a>
</span><span id="MeshingTools.non_intersect_shapes-781"><a href="#MeshingTools.non_intersect_shapes-781"><span class="linenos">781</span></a>            <span class="n">shape_fragments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools.non_intersect_shapes-782"><a href="#MeshingTools.non_intersect_shapes-782"><span class="linenos">782</span></a>            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fragment_map</span><span class="p">:</span>
</span><span id="MeshingTools.non_intersect_shapes-783"><a href="#MeshingTools.non_intersect_shapes-783"><span class="linenos">783</span></a>                <span class="n">shape_fragments</span> <span class="o">+=</span> <span class="n">s</span>
</span><span id="MeshingTools.non_intersect_shapes-784"><a href="#MeshingTools.non_intersect_shapes-784"><span class="linenos">784</span></a>
</span><span id="MeshingTools.non_intersect_shapes-785"><a href="#MeshingTools.non_intersect_shapes-785"><span class="linenos">785</span></a>            <span class="n">to_remove</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools.non_intersect_shapes-786"><a href="#MeshingTools.non_intersect_shapes-786"><span class="linenos">786</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools.non_intersect_shapes-787"><a href="#MeshingTools.non_intersect_shapes-787"><span class="linenos">787</span></a>            <span class="k">while</span> <span class="n">shape_fragments</span><span class="p">:</span>
</span><span id="MeshingTools.non_intersect_shapes-788"><a href="#MeshingTools.non_intersect_shapes-788"><span class="linenos">788</span></a>                <span class="n">in_overlap</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MeshingTools.non_intersect_shapes-789"><a href="#MeshingTools.non_intersect_shapes-789"><span class="linenos">789</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">shape_fragments</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
</span><span id="MeshingTools.non_intersect_shapes-790"><a href="#MeshingTools.non_intersect_shapes-790"><span class="linenos">790</span></a>                    <span class="k">if</span> <span class="n">shape_fragments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
</span><span id="MeshingTools.non_intersect_shapes-791"><a href="#MeshingTools.non_intersect_shapes-791"><span class="linenos">791</span></a>                        <span class="n">to_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="MeshingTools.non_intersect_shapes-792"><a href="#MeshingTools.non_intersect_shapes-792"><span class="linenos">792</span></a>                        <span class="n">in_overlap</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MeshingTools.non_intersect_shapes-793"><a href="#MeshingTools.non_intersect_shapes-793"><span class="linenos">793</span></a>
</span><span id="MeshingTools.non_intersect_shapes-794"><a href="#MeshingTools.non_intersect_shapes-794"><span class="linenos">794</span></a>                <span class="k">if</span> <span class="n">in_overlap</span><span class="p">:</span>
</span><span id="MeshingTools.non_intersect_shapes-795"><a href="#MeshingTools.non_intersect_shapes-795"><span class="linenos">795</span></a>                    <span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MeshingTools.non_intersect_shapes-796"><a href="#MeshingTools.non_intersect_shapes-796"><span class="linenos">796</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools.non_intersect_shapes-797"><a href="#MeshingTools.non_intersect_shapes-797"><span class="linenos">797</span></a>                    <span class="n">new_shapes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_fragments</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</span><span id="MeshingTools.non_intersect_shapes-798"><a href="#MeshingTools.non_intersect_shapes-798"><span class="linenos">798</span></a>
</span><span id="MeshingTools.non_intersect_shapes-799"><a href="#MeshingTools.non_intersect_shapes-799"><span class="linenos">799</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">to_remove</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools.non_intersect_shapes-800"><a href="#MeshingTools.non_intersect_shapes-800"><span class="linenos">800</span></a>
</span><span id="MeshingTools.non_intersect_shapes-801"><a href="#MeshingTools.non_intersect_shapes-801"><span class="linenos">801</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MeshingTools.non_intersect_shapes-802"><a href="#MeshingTools.non_intersect_shapes-802"><span class="linenos">802</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">shapes_1</span> <span class="o">+</span> <span class="n">shapes_2</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshingTools.non_intersect_shapes-803"><a href="#MeshingTools.non_intersect_shapes-803"><span class="linenos">803</span></a>            <span class="n">new_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MeshingTools.non_intersect_shapes-804"><a href="#MeshingTools.non_intersect_shapes-804"><span class="linenos">804</span></a>
</span><span id="MeshingTools.non_intersect_shapes-805"><a href="#MeshingTools.non_intersect_shapes-805"><span class="linenos">805</span></a>        <span class="k">return</span> <span class="n">new_shapes</span>
</span></pre></div>


            <div class="docstring"><p>Create group of shapes consisting of the non-intersection of elements
from <code>shapes_1</code> and <code>shapes_2</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>shapes_1, shapes_2</strong> (list):
List of tuples representing a group of shapes. Each tuple contains
the dimension and tag (i.e. dimTag) of its corresponding shape.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>new_shapes</strong> (list of tuple):
List of tuples representing the new group of shapes.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.rotate" class="classattr">
                                        <input id="MeshingTools.rotate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rotate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shapes</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">angle</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">axis</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="MeshingTools.rotate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.rotate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.rotate-807"><a href="#MeshingTools.rotate-807"><span class="linenos">807</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">angle</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools.rotate-808"><a href="#MeshingTools.rotate-808"><span class="linenos">808</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.rotate-809"><a href="#MeshingTools.rotate-809"><span class="linenos">809</span></a><span class="sd">        Rotates group of shapes around the x-axis.</span>
</span><span id="MeshingTools.rotate-810"><a href="#MeshingTools.rotate-810"><span class="linenos">810</span></a>
</span><span id="MeshingTools.rotate-811"><a href="#MeshingTools.rotate-811"><span class="linenos">811</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.rotate-812"><a href="#MeshingTools.rotate-812"><span class="linenos">812</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.rotate-813"><a href="#MeshingTools.rotate-813"><span class="linenos">813</span></a><span class="sd">        shapes : list of tuple</span>
</span><span id="MeshingTools.rotate-814"><a href="#MeshingTools.rotate-814"><span class="linenos">814</span></a><span class="sd">            List of tuples representing a group of shapes. Each tuple contains</span>
</span><span id="MeshingTools.rotate-815"><a href="#MeshingTools.rotate-815"><span class="linenos">815</span></a><span class="sd">            the dimension and tag (i.e. dimTag) of its corresponding shape.</span>
</span><span id="MeshingTools.rotate-816"><a href="#MeshingTools.rotate-816"><span class="linenos">816</span></a><span class="sd">        angle : float</span>
</span><span id="MeshingTools.rotate-817"><a href="#MeshingTools.rotate-817"><span class="linenos">817</span></a><span class="sd">            Angle of rotation in radians.</span>
</span><span id="MeshingTools.rotate-818"><a href="#MeshingTools.rotate-818"><span class="linenos">818</span></a><span class="sd">        axis : str</span>
</span><span id="MeshingTools.rotate-819"><a href="#MeshingTools.rotate-819"><span class="linenos">819</span></a><span class="sd">            Axis of rotation {&#39;x&#39;, &#39;y&#39;, &#39;z&#39;}.</span>
</span><span id="MeshingTools.rotate-820"><a href="#MeshingTools.rotate-820"><span class="linenos">820</span></a>
</span><span id="MeshingTools.rotate-821"><a href="#MeshingTools.rotate-821"><span class="linenos">821</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools.rotate-822"><a href="#MeshingTools.rotate-822"><span class="linenos">822</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools.rotate-823"><a href="#MeshingTools.rotate-823"><span class="linenos">823</span></a><span class="sd">        shapes : list tuple</span>
</span><span id="MeshingTools.rotate-824"><a href="#MeshingTools.rotate-824"><span class="linenos">824</span></a><span class="sd">            List of tuples representing the group of shapes. Is identical to</span>
</span><span id="MeshingTools.rotate-825"><a href="#MeshingTools.rotate-825"><span class="linenos">825</span></a><span class="sd">            input &#39;shapes&#39;.</span>
</span><span id="MeshingTools.rotate-826"><a href="#MeshingTools.rotate-826"><span class="linenos">826</span></a>
</span><span id="MeshingTools.rotate-827"><a href="#MeshingTools.rotate-827"><span class="linenos">827</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.rotate-828"><a href="#MeshingTools.rotate-828"><span class="linenos">828</span></a>        <span class="k">if</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]:</span>
</span><span id="MeshingTools.rotate-829"><a href="#MeshingTools.rotate-829"><span class="linenos">829</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;axis should be either &#39;x&#39; or &#39;y&#39; or &#39;z&#39;&quot;</span><span class="p">)</span>
</span><span id="MeshingTools.rotate-830"><a href="#MeshingTools.rotate-830"><span class="linenos">830</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MeshingTools.rotate-831"><a href="#MeshingTools.rotate-831"><span class="linenos">831</span></a>                         <span class="n">ax</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">),</span>
</span><span id="MeshingTools.rotate-832"><a href="#MeshingTools.rotate-832"><span class="linenos">832</span></a>                         <span class="n">ay</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span>
</span><span id="MeshingTools.rotate-833"><a href="#MeshingTools.rotate-833"><span class="linenos">833</span></a>                         <span class="n">az</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">),</span>
</span><span id="MeshingTools.rotate-834"><a href="#MeshingTools.rotate-834"><span class="linenos">834</span></a>                         <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">)</span>
</span><span id="MeshingTools.rotate-835"><a href="#MeshingTools.rotate-835"><span class="linenos">835</span></a>        <span class="k">return</span> <span class="n">shapes</span>
</span></pre></div>


            <div class="docstring"><p>Rotates group of shapes around the x-axis.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>shapes</strong> (list of tuple):
List of tuples representing a group of shapes. Each tuple contains
the dimension and tag (i.e. dimTag) of its corresponding shape.</li>
<li><strong>angle</strong> (float):
Angle of rotation in radians.</li>
<li><strong>axis</strong> (str):
Axis of rotation {'x', 'y', 'z'}.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>shapes</strong> (list tuple):
List of tuples representing the group of shapes. Is identical to
input 'shapes'.</li>
</ul>
</div>


                            </div>
                            <div id="MeshingTools.translate" class="classattr">
                                        <input id="MeshingTools.translate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">translate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shapes</span><span class="p">:</span> <span class="nb">list</span>, </span><span class="param"><span class="n">dx</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">dy</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">dz</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="MeshingTools.translate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.translate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.translate-837"><a href="#MeshingTools.translate-837"><span class="linenos">837</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shapes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="MeshingTools.translate-838"><a href="#MeshingTools.translate-838"><span class="linenos">838</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshingTools.translate-839"><a href="#MeshingTools.translate-839"><span class="linenos">839</span></a><span class="sd">        @author: Chad Briddon</span>
</span><span id="MeshingTools.translate-840"><a href="#MeshingTools.translate-840"><span class="linenos">840</span></a><span class="sd">        Translates group of shapes in the x-direction.</span>
</span><span id="MeshingTools.translate-841"><a href="#MeshingTools.translate-841"><span class="linenos">841</span></a>
</span><span id="MeshingTools.translate-842"><a href="#MeshingTools.translate-842"><span class="linenos">842</span></a><span class="sd">        Parameters</span>
</span><span id="MeshingTools.translate-843"><a href="#MeshingTools.translate-843"><span class="linenos">843</span></a><span class="sd">        ----------</span>
</span><span id="MeshingTools.translate-844"><a href="#MeshingTools.translate-844"><span class="linenos">844</span></a><span class="sd">        shapes : list of tuple</span>
</span><span id="MeshingTools.translate-845"><a href="#MeshingTools.translate-845"><span class="linenos">845</span></a><span class="sd">            List of tuples representing a groups of shapes. Each tuple contains</span>
</span><span id="MeshingTools.translate-846"><a href="#MeshingTools.translate-846"><span class="linenos">846</span></a><span class="sd">            the dimension and tag of its corresponding shape.</span>
</span><span id="MeshingTools.translate-847"><a href="#MeshingTools.translate-847"><span class="linenos">847</span></a><span class="sd">        dx, dy, dz : float</span>
</span><span id="MeshingTools.translate-848"><a href="#MeshingTools.translate-848"><span class="linenos">848</span></a><span class="sd">            Amount the group of shapes is to be translated by in the positive</span>
</span><span id="MeshingTools.translate-849"><a href="#MeshingTools.translate-849"><span class="linenos">849</span></a><span class="sd">            (x, y, z)-direction. If negative then translation will be in the</span>
</span><span id="MeshingTools.translate-850"><a href="#MeshingTools.translate-850"><span class="linenos">850</span></a><span class="sd">            negative (x, y, z)-direction.</span>
</span><span id="MeshingTools.translate-851"><a href="#MeshingTools.translate-851"><span class="linenos">851</span></a>
</span><span id="MeshingTools.translate-852"><a href="#MeshingTools.translate-852"><span class="linenos">852</span></a><span class="sd">        Returns</span>
</span><span id="MeshingTools.translate-853"><a href="#MeshingTools.translate-853"><span class="linenos">853</span></a><span class="sd">        -------</span>
</span><span id="MeshingTools.translate-854"><a href="#MeshingTools.translate-854"><span class="linenos">854</span></a><span class="sd">        shapes : list tuple</span>
</span><span id="MeshingTools.translate-855"><a href="#MeshingTools.translate-855"><span class="linenos">855</span></a><span class="sd">            List of tuples representing the group of shapes. Is identical to</span>
</span><span id="MeshingTools.translate-856"><a href="#MeshingTools.translate-856"><span class="linenos">856</span></a><span class="sd">            input &#39;shapes&#39;.</span>
</span><span id="MeshingTools.translate-857"><a href="#MeshingTools.translate-857"><span class="linenos">857</span></a>
</span><span id="MeshingTools.translate-858"><a href="#MeshingTools.translate-858"><span class="linenos">858</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MeshingTools.translate-859"><a href="#MeshingTools.translate-859"><span class="linenos">859</span></a>
</span><span id="MeshingTools.translate-860"><a href="#MeshingTools.translate-860"><span class="linenos">860</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">)</span>
</span><span id="MeshingTools.translate-861"><a href="#MeshingTools.translate-861"><span class="linenos">861</span></a>        <span class="k">return</span> <span class="n">shapes</span>
</span></pre></div>


            <div class="docstring"><p>@author: Chad Briddon
Translates group of shapes in the x-direction.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>shapes</strong> (list of tuple):
List of tuples representing a groups of shapes. Each tuple contains
the dimension and tag of its corresponding shape.</li>
<li><strong>dx, dy, dz</strong> (float):
Amount the group of shapes is to be translated by in the positive
(x, y, z)-direction. If negative then translation will be in the
negative (x, y, z)-direction.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>shapes</strong> (list tuple):
List of tuples representing the group of shapes. Is identical to
input 'shapes'.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="MeshingTools.Decorators">
                            <input id="MeshingTools.Decorators-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MeshingTools.Decorators</span>:

                <label class="view-source-button" for="MeshingTools.Decorators-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.Decorators"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.Decorators-55"><a href="#MeshingTools.Decorators-55"><span class="linenos">55</span></a>    <span class="k">class</span><span class="w"> </span><span class="nc">Decorators</span><span class="p">:</span>
</span><span id="MeshingTools.Decorators-56"><a href="#MeshingTools.Decorators-56"><span class="linenos">56</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Inner class for defining decorators.&quot;&quot;&quot;</span>
</span><span id="MeshingTools.Decorators-57"><a href="#MeshingTools.Decorators-57"><span class="linenos">57</span></a>
</span><span id="MeshingTools.Decorators-58"><a href="#MeshingTools.Decorators-58"><span class="linenos">58</span></a>        <span class="nd">@staticmethod</span>
</span><span id="MeshingTools.Decorators-59"><a href="#MeshingTools.Decorators-59"><span class="linenos">59</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">check_dimension</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
</span><span id="MeshingTools.Decorators-60"><a href="#MeshingTools.Decorators-60"><span class="linenos">60</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Decorator for checking that the current `MeshingTools` instance</span>
</span><span id="MeshingTools.Decorators-61"><a href="#MeshingTools.Decorators-61"><span class="linenos">61</span></a><span class="sd">            has its dimension set to `dim`.&quot;&quot;&quot;</span>
</span><span id="MeshingTools.Decorators-62"><a href="#MeshingTools.Decorators-62"><span class="linenos">62</span></a>            <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="MeshingTools.Decorators-63"><a href="#MeshingTools.Decorators-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.Decorators-64"><a href="#MeshingTools.Decorators-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.Decorators-65"><a href="#MeshingTools.Decorators-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.Decorators-66"><a href="#MeshingTools.Decorators-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.Decorators-67"><a href="#MeshingTools.Decorators-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.Decorators-68"><a href="#MeshingTools.Decorators-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.Decorators-69"><a href="#MeshingTools.Decorators-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MeshingTools.Decorators-70"><a href="#MeshingTools.Decorators-70"><span class="linenos">70</span></a>                <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="MeshingTools.Decorators-71"><a href="#MeshingTools.Decorators-71"><span class="linenos">71</span></a>            <span class="k">return</span> <span class="n">decorator</span>
</span></pre></div>


            <div class="docstring"><p>Inner class for defining decorators.</p>
</div>


                            <div id="MeshingTools.Decorators.check_dimension" class="classattr">
                                        <input id="MeshingTools.Decorators.check_dimension-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">check_dimension</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dim</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshingTools.Decorators.check_dimension-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshingTools.Decorators.check_dimension"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshingTools.Decorators.check_dimension-58"><a href="#MeshingTools.Decorators.check_dimension-58"><span class="linenos">58</span></a>        <span class="nd">@staticmethod</span>
</span><span id="MeshingTools.Decorators.check_dimension-59"><a href="#MeshingTools.Decorators.check_dimension-59"><span class="linenos">59</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">check_dimension</span><span class="p">(</span><span class="n">dim</span><span class="p">):</span>
</span><span id="MeshingTools.Decorators.check_dimension-60"><a href="#MeshingTools.Decorators.check_dimension-60"><span class="linenos">60</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Decorator for checking that the current `MeshingTools` instance</span>
</span><span id="MeshingTools.Decorators.check_dimension-61"><a href="#MeshingTools.Decorators.check_dimension-61"><span class="linenos">61</span></a><span class="sd">            has its dimension set to `dim`.&quot;&quot;&quot;</span>
</span><span id="MeshingTools.Decorators.check_dimension-62"><a href="#MeshingTools.Decorators.check_dimension-62"><span class="linenos">62</span></a>            <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="MeshingTools.Decorators.check_dimension-63"><a href="#MeshingTools.Decorators.check_dimension-63"><span class="linenos">63</span></a>                <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MeshingTools.Decorators.check_dimension-64"><a href="#MeshingTools.Decorators.check_dimension-64"><span class="linenos">64</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
</span><span id="MeshingTools.Decorators.check_dimension-65"><a href="#MeshingTools.Decorators.check_dimension-65"><span class="linenos">65</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">close_gmsh</span><span class="p">()</span>
</span><span id="MeshingTools.Decorators.check_dimension-66"><a href="#MeshingTools.Decorators.check_dimension-66"><span class="linenos">66</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">cleandoc</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Current instance of &#39;</span><span class="si">{}</span><span class="s2">&#39;</span>
</span><span id="MeshingTools.Decorators.check_dimension-67"><a href="#MeshingTools.Decorators.check_dimension-67"><span class="linenos">67</span></a><span class="s2">                        has dim=</span><span class="si">{}</span><span class="s2"> while method &#39;</span><span class="si">{}</span><span class="s2">&#39; requires dim=</span><span class="si">{}</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="MeshingTools.Decorators.check_dimension-68"><a href="#MeshingTools.Decorators.check_dimension-68"><span class="linenos">68</span></a>                            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">dim</span><span class="p">)))</span>
</span><span id="MeshingTools.Decorators.check_dimension-69"><a href="#MeshingTools.Decorators.check_dimension-69"><span class="linenos">69</span></a>                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MeshingTools.Decorators.check_dimension-70"><a href="#MeshingTools.Decorators.check_dimension-70"><span class="linenos">70</span></a>                <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="MeshingTools.Decorators.check_dimension-71"><a href="#MeshingTools.Decorators.check_dimension-71"><span class="linenos">71</span></a>            <span class="k">return</span> <span class="n">decorator</span>
</span></pre></div>


            <div class="docstring"><p>Decorator for checking that the current <code><a href="#MeshingTools">MeshingTools</a></code> instance
has its dimension set to <code><a href="#MeshingTools.dim">dim</a></code>.</p>
</div>


                            </div>
                </section>
                <section id="generate_mesh_from_geo">
                            <input id="generate_mesh_from_geo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_mesh_from_geo</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">geo_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">param_dict</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">show_mesh</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">ignored_tags</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">convert</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="generate_mesh_from_geo-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_mesh_from_geo"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_mesh_from_geo-1051"><a href="#generate_mesh_from_geo-1051"><span class="linenos">1051</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_mesh_from_geo</span><span class="p">(</span><span class="n">geo_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_mesh</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="generate_mesh_from_geo-1052"><a href="#generate_mesh_from_geo-1052"><span class="linenos">1052</span></a>                           <span class="n">ignored_tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="generate_mesh_from_geo-1053"><a href="#generate_mesh_from_geo-1053"><span class="linenos">1053</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="generate_mesh_from_geo-1054"><a href="#generate_mesh_from_geo-1054"><span class="linenos">1054</span></a><span class="sd">    Generate a mesh from an existing .geo file with Gmsh.</span>
</span><span id="generate_mesh_from_geo-1055"><a href="#generate_mesh_from_geo-1055"><span class="linenos">1055</span></a>
</span><span id="generate_mesh_from_geo-1056"><a href="#generate_mesh_from_geo-1056"><span class="linenos">1056</span></a><span class="sd">    Parameters</span>
</span><span id="generate_mesh_from_geo-1057"><a href="#generate_mesh_from_geo-1057"><span class="linenos">1057</span></a><span class="sd">    ----------</span>
</span><span id="generate_mesh_from_geo-1058"><a href="#generate_mesh_from_geo-1058"><span class="linenos">1058</span></a><span class="sd">    geo_name : str</span>
</span><span id="generate_mesh_from_geo-1059"><a href="#generate_mesh_from_geo-1059"><span class="linenos">1059</span></a><span class="sd">        Name of the .geo file.</span>
</span><span id="generate_mesh_from_geo-1060"><a href="#generate_mesh_from_geo-1060"><span class="linenos">1060</span></a><span class="sd">    param_dict : dict</span>
</span><span id="generate_mesh_from_geo-1061"><a href="#generate_mesh_from_geo-1061"><span class="linenos">1061</span></a><span class="sd">        Dictionary containing key/value pairs to be modified.</span>
</span><span id="generate_mesh_from_geo-1062"><a href="#generate_mesh_from_geo-1062"><span class="linenos">1062</span></a><span class="sd">        The default is None.</span>
</span><span id="generate_mesh_from_geo-1063"><a href="#generate_mesh_from_geo-1063"><span class="linenos">1063</span></a><span class="sd">    show_mesh : bool, optional</span>
</span><span id="generate_mesh_from_geo-1064"><a href="#generate_mesh_from_geo-1064"><span class="linenos">1064</span></a><span class="sd">        If True, will open a window to allow viewing of the generated mesh.</span>
</span><span id="generate_mesh_from_geo-1065"><a href="#generate_mesh_from_geo-1065"><span class="linenos">1065</span></a><span class="sd">        The default is False.</span>
</span><span id="generate_mesh_from_geo-1066"><a href="#generate_mesh_from_geo-1066"><span class="linenos">1066</span></a><span class="sd">    ignored_tags : list, optional</span>
</span><span id="generate_mesh_from_geo-1067"><a href="#generate_mesh_from_geo-1067"><span class="linenos">1067</span></a><span class="sd">            List of physical groups not to be included in the final .vtk file.</span>
</span><span id="generate_mesh_from_geo-1068"><a href="#generate_mesh_from_geo-1068"><span class="linenos">1068</span></a><span class="sd">            The default is None.</span>
</span><span id="generate_mesh_from_geo-1069"><a href="#generate_mesh_from_geo-1069"><span class="linenos">1069</span></a><span class="sd">    convert : bool, optional</span>
</span><span id="generate_mesh_from_geo-1070"><a href="#generate_mesh_from_geo-1070"><span class="linenos">1070</span></a><span class="sd">        Convert the .vtk mesh file created by Gmsh into a .vtk file readable</span>
</span><span id="generate_mesh_from_geo-1071"><a href="#generate_mesh_from_geo-1071"><span class="linenos">1071</span></a><span class="sd">        by Sfepy. The default is True.</span>
</span><span id="generate_mesh_from_geo-1072"><a href="#generate_mesh_from_geo-1072"><span class="linenos">1072</span></a>
</span><span id="generate_mesh_from_geo-1073"><a href="#generate_mesh_from_geo-1073"><span class="linenos">1073</span></a><span class="sd">    Other Parameters</span>
</span><span id="generate_mesh_from_geo-1074"><a href="#generate_mesh_from_geo-1074"><span class="linenos">1074</span></a><span class="sd">    ----------------</span>
</span><span id="generate_mesh_from_geo-1075"><a href="#generate_mesh_from_geo-1075"><span class="linenos">1075</span></a><span class="sd">    mesh_name : str, optional</span>
</span><span id="generate_mesh_from_geo-1076"><a href="#generate_mesh_from_geo-1076"><span class="linenos">1076</span></a><span class="sd">        Output file name. Will be the same as the .geo file if not specified.</span>
</span><span id="generate_mesh_from_geo-1077"><a href="#generate_mesh_from_geo-1077"><span class="linenos">1077</span></a><span class="sd">        The default is None.</span>
</span><span id="generate_mesh_from_geo-1078"><a href="#generate_mesh_from_geo-1078"><span class="linenos">1078</span></a><span class="sd">    verbose : bool, optional</span>
</span><span id="generate_mesh_from_geo-1079"><a href="#generate_mesh_from_geo-1079"><span class="linenos">1079</span></a><span class="sd">        Display user information. The default is False.</span>
</span><span id="generate_mesh_from_geo-1080"><a href="#generate_mesh_from_geo-1080"><span class="linenos">1080</span></a>
</span><span id="generate_mesh_from_geo-1081"><a href="#generate_mesh_from_geo-1081"><span class="linenos">1081</span></a><span class="sd">    Returns</span>
</span><span id="generate_mesh_from_geo-1082"><a href="#generate_mesh_from_geo-1082"><span class="linenos">1082</span></a><span class="sd">    -------</span>
</span><span id="generate_mesh_from_geo-1083"><a href="#generate_mesh_from_geo-1083"><span class="linenos">1083</span></a><span class="sd">    mesh_path_name : str</span>
</span><span id="generate_mesh_from_geo-1084"><a href="#generate_mesh_from_geo-1084"><span class="linenos">1084</span></a><span class="sd">        Absolute path name of the created mesh file.</span>
</span><span id="generate_mesh_from_geo-1085"><a href="#generate_mesh_from_geo-1085"><span class="linenos">1085</span></a>
</span><span id="generate_mesh_from_geo-1086"><a href="#generate_mesh_from_geo-1086"><span class="linenos">1086</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_mesh_from_geo-1087"><a href="#generate_mesh_from_geo-1087"><span class="linenos">1087</span></a>
</span><span id="generate_mesh_from_geo-1088"><a href="#generate_mesh_from_geo-1088"><span class="linenos">1088</span></a>    <span class="c1"># Get keyword arguments</span>
</span><span id="generate_mesh_from_geo-1089"><a href="#generate_mesh_from_geo-1089"><span class="linenos">1089</span></a>    <span class="k">if</span> <span class="n">param_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="generate_mesh_from_geo-1090"><a href="#generate_mesh_from_geo-1090"><span class="linenos">1090</span></a>        <span class="n">param_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="generate_mesh_from_geo-1091"><a href="#generate_mesh_from_geo-1091"><span class="linenos">1091</span></a>    <span class="n">mesh_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mesh_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1092"><a href="#generate_mesh_from_geo-1092"><span class="linenos">1092</span></a>    <span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1093"><a href="#generate_mesh_from_geo-1093"><span class="linenos">1093</span></a>
</span><span id="generate_mesh_from_geo-1094"><a href="#generate_mesh_from_geo-1094"><span class="linenos">1094</span></a>    <span class="c1"># Write parameters to the existing .geo file</span>
</span><span id="generate_mesh_from_geo-1095"><a href="#generate_mesh_from_geo-1095"><span class="linenos">1095</span></a>    <span class="n">geo_path_name</span> <span class="o">=</span> <span class="n">make_absolute_geo_name</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1096"><a href="#generate_mesh_from_geo-1096"><span class="linenos">1096</span></a>    <span class="n">_write_geo_params</span><span class="p">(</span><span class="n">geo_path_name</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1097"><a href="#generate_mesh_from_geo-1097"><span class="linenos">1097</span></a>
</span><span id="generate_mesh_from_geo-1098"><a href="#generate_mesh_from_geo-1098"><span class="linenos">1098</span></a>    <span class="k">if</span> <span class="n">mesh_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="generate_mesh_from_geo-1099"><a href="#generate_mesh_from_geo-1099"><span class="linenos">1099</span></a>        <span class="n">mesh_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1100"><a href="#generate_mesh_from_geo-1100"><span class="linenos">1100</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1101"><a href="#generate_mesh_from_geo-1101"><span class="linenos">1101</span></a>
</span><span id="generate_mesh_from_geo-1102"><a href="#generate_mesh_from_geo-1102"><span class="linenos">1102</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</span><span id="generate_mesh_from_geo-1103"><a href="#generate_mesh_from_geo-1103"><span class="linenos">1103</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s1">&#39;General.Verbosity&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1104"><a href="#generate_mesh_from_geo-1104"><span class="linenos">1104</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">geo_path_name</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1105"><a href="#generate_mesh_from_geo-1105"><span class="linenos">1105</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
</span><span id="generate_mesh_from_geo-1106"><a href="#generate_mesh_from_geo-1106"><span class="linenos">1106</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getDimension</span><span class="p">()</span>
</span><span id="generate_mesh_from_geo-1107"><a href="#generate_mesh_from_geo-1107"><span class="linenos">1107</span></a>
</span><span id="generate_mesh_from_geo-1108"><a href="#generate_mesh_from_geo-1108"><span class="linenos">1108</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="generate_mesh_from_geo-1109"><a href="#generate_mesh_from_geo-1109"><span class="linenos">1109</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model&#39;</span> <span class="o">+</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">getCurrent</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;D)&#39;</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1110"><a href="#generate_mesh_from_geo-1110"><span class="linenos">1110</span></a>
</span><span id="generate_mesh_from_geo-1111"><a href="#generate_mesh_from_geo-1111"><span class="linenos">1111</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1112"><a href="#generate_mesh_from_geo-1112"><span class="linenos">1112</span></a>
</span><span id="generate_mesh_from_geo-1113"><a href="#generate_mesh_from_geo-1113"><span class="linenos">1113</span></a>    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Inspect the log</span>
</span><span id="generate_mesh_from_geo-1114"><a href="#generate_mesh_from_geo-1114"><span class="linenos">1114</span></a>        <span class="n">log</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span><span id="generate_mesh_from_geo-1115"><a href="#generate_mesh_from_geo-1115"><span class="linenos">1115</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logger has recorded </span><span class="si">{}</span><span class="s2"> lines&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">log</span><span class="p">)))</span>
</span><span id="generate_mesh_from_geo-1116"><a href="#generate_mesh_from_geo-1116"><span class="linenos">1116</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="generate_mesh_from_geo-1117"><a href="#generate_mesh_from_geo-1117"><span class="linenos">1117</span></a>
</span><span id="generate_mesh_from_geo-1118"><a href="#generate_mesh_from_geo-1118"><span class="linenos">1118</span></a>    <span class="k">if</span> <span class="n">show_mesh</span><span class="p">:</span>
</span><span id="generate_mesh_from_geo-1119"><a href="#generate_mesh_from_geo-1119"><span class="linenos">1119</span></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">fltk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="generate_mesh_from_geo-1120"><a href="#generate_mesh_from_geo-1120"><span class="linenos">1120</span></a>
</span><span id="generate_mesh_from_geo-1121"><a href="#generate_mesh_from_geo-1121"><span class="linenos">1121</span></a>    <span class="c1"># save the generated mesh</span>
</span><span id="generate_mesh_from_geo-1122"><a href="#generate_mesh_from_geo-1122"><span class="linenos">1122</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fileName</span><span class="o">=</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1123"><a href="#generate_mesh_from_geo-1123"><span class="linenos">1123</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="generate_mesh_from_geo-1124"><a href="#generate_mesh_from_geo-1124"><span class="linenos">1124</span></a>    <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</span><span id="generate_mesh_from_geo-1125"><a href="#generate_mesh_from_geo-1125"><span class="linenos">1125</span></a>
</span><span id="generate_mesh_from_geo-1126"><a href="#generate_mesh_from_geo-1126"><span class="linenos">1126</span></a>    <span class="c1"># convert the mesh to a .vtk file readable by Sfepy</span>
</span><span id="generate_mesh_from_geo-1127"><a href="#generate_mesh_from_geo-1127"><span class="linenos">1127</span></a>    <span class="k">if</span> <span class="n">convert</span><span class="p">:</span>
</span><span id="generate_mesh_from_geo-1128"><a href="#generate_mesh_from_geo-1128"><span class="linenos">1128</span></a>        <span class="n">convert_mesh_for_sfepy</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span>
</span><span id="generate_mesh_from_geo-1129"><a href="#generate_mesh_from_geo-1129"><span class="linenos">1129</span></a>                               <span class="n">ignored_tags</span><span class="o">=</span><span class="n">ignored_tags</span><span class="p">,</span>
</span><span id="generate_mesh_from_geo-1130"><a href="#generate_mesh_from_geo-1130"><span class="linenos">1130</span></a>                               <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="generate_mesh_from_geo-1131"><a href="#generate_mesh_from_geo-1131"><span class="linenos">1131</span></a>    <span class="k">return</span> <span class="n">mesh_path_name</span>
</span></pre></div>


            <div class="docstring"><p>Generate a mesh from an existing .geo file with Gmsh.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>geo_name</strong> (str):
Name of the .geo file.</li>
<li><strong>param_dict</strong> (dict):
Dictionary containing key/value pairs to be modified.
The default is None.</li>
<li><strong>show_mesh</strong> (bool, optional):
If True, will open a window to allow viewing of the generated mesh.
The default is False.</li>
<li><strong>ignored_tags</strong> (list, optional):
List of physical groups not to be included in the final .vtk file.
The default is None.</li>
<li><strong>convert</strong> (bool, optional):
Convert the .vtk mesh file created by Gmsh into a .vtk file readable
by Sfepy. The default is True.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>mesh_name</strong> (str, optional):
Output file name. Will be the same as the .geo file if not specified.
The default is None.</li>
<li><strong>verbose</strong> (bool, optional):
Display user information. The default is False.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>mesh_path_name</strong> (str):
Absolute path name of the created mesh file.</li>
</ul>
</div>


                </section>
                <section id="convert_mesh_for_sfepy">
                            <input id="convert_mesh_for_sfepy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">convert_mesh_for_sfepy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">ignored_tags</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="convert_mesh_for_sfepy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#convert_mesh_for_sfepy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="convert_mesh_for_sfepy-1134"><a href="#convert_mesh_for_sfepy-1134"><span class="linenos">1134</span></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_mesh_for_sfepy</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ignored_tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="convert_mesh_for_sfepy-1135"><a href="#convert_mesh_for_sfepy-1135"><span class="linenos">1135</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="convert_mesh_for_sfepy-1136"><a href="#convert_mesh_for_sfepy-1136"><span class="linenos">1136</span></a><span class="sd">    Convert a .vtk mesh file written by Gmsh into a new .vtk file which</span>
</span><span id="convert_mesh_for_sfepy-1137"><a href="#convert_mesh_for_sfepy-1137"><span class="linenos">1137</span></a><span class="sd">    facilitates topological entity selection with Sfepy. Vertices are given a</span>
</span><span id="convert_mesh_for_sfepy-1138"><a href="#convert_mesh_for_sfepy-1138"><span class="linenos">1138</span></a><span class="sd">    unique group id following the convention:</span>
</span><span id="convert_mesh_for_sfepy-1139"><a href="#convert_mesh_for_sfepy-1139"><span class="linenos">1139</span></a><span class="sd">    [0 - 99]    --&gt; vertex tag (i.e. entity of dimension 0)</span>
</span><span id="convert_mesh_for_sfepy-1140"><a href="#convert_mesh_for_sfepy-1140"><span class="linenos">1140</span></a><span class="sd">    [100 - 199] --&gt; edge tag (i.e. entity of dimension 1)</span>
</span><span id="convert_mesh_for_sfepy-1141"><a href="#convert_mesh_for_sfepy-1141"><span class="linenos">1141</span></a><span class="sd">    [200 - 299] --&gt; facet tag (i.e. entity of dimension D-1)</span>
</span><span id="convert_mesh_for_sfepy-1142"><a href="#convert_mesh_for_sfepy-1142"><span class="linenos">1142</span></a><span class="sd">    [300 - xxx] --&gt; cell tag (i.e. entity of dimension D)</span>
</span><span id="convert_mesh_for_sfepy-1143"><a href="#convert_mesh_for_sfepy-1143"><span class="linenos">1143</span></a><span class="sd">    If one node belongs to several topological entities, it will be tagged with</span>
</span><span id="convert_mesh_for_sfepy-1144"><a href="#convert_mesh_for_sfepy-1144"><span class="linenos">1144</span></a><span class="sd">    the lowest dimension group id. For instance, a vertex belonging to a facet</span>
</span><span id="convert_mesh_for_sfepy-1145"><a href="#convert_mesh_for_sfepy-1145"><span class="linenos">1145</span></a><span class="sd">    of tag 200 and a subvolume of tag 300 will be tagged 200. This is</span>
</span><span id="convert_mesh_for_sfepy-1146"><a href="#convert_mesh_for_sfepy-1146"><span class="linenos">1146</span></a><span class="sd">    problematic for subvolume selection. This difficulty is overcome by taking</span>
</span><span id="convert_mesh_for_sfepy-1147"><a href="#convert_mesh_for_sfepy-1147"><span class="linenos">1147</span></a><span class="sd">    advantage of the &#39;mat_ids&#39; field that is readable by Sfepy.</span>
</span><span id="convert_mesh_for_sfepy-1148"><a href="#convert_mesh_for_sfepy-1148"><span class="linenos">1148</span></a>
</span><span id="convert_mesh_for_sfepy-1149"><a href="#convert_mesh_for_sfepy-1149"><span class="linenos">1149</span></a><span class="sd">    Parameters</span>
</span><span id="convert_mesh_for_sfepy-1150"><a href="#convert_mesh_for_sfepy-1150"><span class="linenos">1150</span></a><span class="sd">    ----------</span>
</span><span id="convert_mesh_for_sfepy-1151"><a href="#convert_mesh_for_sfepy-1151"><span class="linenos">1151</span></a><span class="sd">    mesh_name : str</span>
</span><span id="convert_mesh_for_sfepy-1152"><a href="#convert_mesh_for_sfepy-1152"><span class="linenos">1152</span></a><span class="sd">        Name of the mesh file to be created. If not specified as an absolute</span>
</span><span id="convert_mesh_for_sfepy-1153"><a href="#convert_mesh_for_sfepy-1153"><span class="linenos">1153</span></a><span class="sd">        path name, will be stored in the `MESH_DIR` directory.</span>
</span><span id="convert_mesh_for_sfepy-1154"><a href="#convert_mesh_for_sfepy-1154"><span class="linenos">1154</span></a><span class="sd">    ignored_tags : list, optional</span>
</span><span id="convert_mesh_for_sfepy-1155"><a href="#convert_mesh_for_sfepy-1155"><span class="linenos">1155</span></a><span class="sd">        List of tags to be ignored in the new .vtk mesh. The default is None.</span>
</span><span id="convert_mesh_for_sfepy-1156"><a href="#convert_mesh_for_sfepy-1156"><span class="linenos">1156</span></a><span class="sd">    verbose : bool, optional</span>
</span><span id="convert_mesh_for_sfepy-1157"><a href="#convert_mesh_for_sfepy-1157"><span class="linenos">1157</span></a><span class="sd">        Toggle for Sfepy automatic console messages. The default is False.</span>
</span><span id="convert_mesh_for_sfepy-1158"><a href="#convert_mesh_for_sfepy-1158"><span class="linenos">1158</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="convert_mesh_for_sfepy-1159"><a href="#convert_mesh_for_sfepy-1159"><span class="linenos">1159</span></a>
</span><span id="convert_mesh_for_sfepy-1160"><a href="#convert_mesh_for_sfepy-1160"><span class="linenos">1160</span></a>    <span class="n">output</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="convert_mesh_for_sfepy-1161"><a href="#convert_mesh_for_sfepy-1161"><span class="linenos">1161</span></a>
</span><span id="convert_mesh_for_sfepy-1162"><a href="#convert_mesh_for_sfepy-1162"><span class="linenos">1162</span></a>    <span class="k">if</span> <span class="n">ignored_tags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="convert_mesh_for_sfepy-1163"><a href="#convert_mesh_for_sfepy-1163"><span class="linenos">1163</span></a>        <span class="n">ignored_tags</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="convert_mesh_for_sfepy-1164"><a href="#convert_mesh_for_sfepy-1164"><span class="linenos">1164</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="convert_mesh_for_sfepy-1165"><a href="#convert_mesh_for_sfepy-1165"><span class="linenos">1165</span></a>
</span><span id="convert_mesh_for_sfepy-1166"><a href="#convert_mesh_for_sfepy-1166"><span class="linenos">1166</span></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="convert_mesh_for_sfepy-1167"><a href="#convert_mesh_for_sfepy-1167"><span class="linenos">1167</span></a>    <span class="n">cell_dim</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">dim</span>
</span><span id="convert_mesh_for_sfepy-1168"><a href="#convert_mesh_for_sfepy-1168"><span class="linenos">1168</span></a>
</span><span id="convert_mesh_for_sfepy-1169"><a href="#convert_mesh_for_sfepy-1169"><span class="linenos">1169</span></a>    <span class="c1"># All the necessary &amp; sufficient information for defining a mesh</span>
</span><span id="convert_mesh_for_sfepy-1170"><a href="#convert_mesh_for_sfepy-1170"><span class="linenos">1170</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">_get_io_data</span><span class="p">(</span><span class="n">cell_dim_only</span><span class="o">=</span><span class="n">cell_dim</span><span class="p">))</span>
</span><span id="convert_mesh_for_sfepy-1171"><a href="#convert_mesh_for_sfepy-1171"><span class="linenos">1171</span></a>
</span><span id="convert_mesh_for_sfepy-1172"><a href="#convert_mesh_for_sfepy-1172"><span class="linenos">1172</span></a>    <span class="c1"># Managing vertex groups</span>
</span><span id="convert_mesh_for_sfepy-1173"><a href="#convert_mesh_for_sfepy-1173"><span class="linenos">1173</span></a>    <span class="n">ngroups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">n_nod</span><span class="p">)])</span>
</span><span id="convert_mesh_for_sfepy-1174"><a href="#convert_mesh_for_sfepy-1174"><span class="linenos">1174</span></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="convert_mesh_for_sfepy-1175"><a href="#convert_mesh_for_sfepy-1175"><span class="linenos">1175</span></a>    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">cells_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="convert_mesh_for_sfepy-1176"><a href="#convert_mesh_for_sfepy-1176"><span class="linenos">1176</span></a>        <span class="n">conn</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">cells_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="convert_mesh_for_sfepy-1177"><a href="#convert_mesh_for_sfepy-1177"><span class="linenos">1177</span></a>        <span class="n">former_tags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">cell_data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
</span><span id="convert_mesh_for_sfepy-1178"><a href="#convert_mesh_for_sfepy-1178"><span class="linenos">1178</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">former_tags</span><span class="p">):</span>
</span><span id="convert_mesh_for_sfepy-1179"><a href="#convert_mesh_for_sfepy-1179"><span class="linenos">1179</span></a>            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignored_tags</span><span class="p">:</span>
</span><span id="convert_mesh_for_sfepy-1180"><a href="#convert_mesh_for_sfepy-1180"><span class="linenos">1180</span></a>                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">conn</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span>
</span><span id="convert_mesh_for_sfepy-1181"><a href="#convert_mesh_for_sfepy-1181"><span class="linenos">1181</span></a>                    <span class="k">if</span> <span class="n">ngroups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="convert_mesh_for_sfepy-1182"><a href="#convert_mesh_for_sfepy-1182"><span class="linenos">1182</span></a>                        <span class="n">ngroups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
</span><span id="convert_mesh_for_sfepy-1183"><a href="#convert_mesh_for_sfepy-1183"><span class="linenos">1183</span></a>    <span class="n">ngroups</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ngroups</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">400</span>  <span class="c1"># default marker for untagged</span>
</span><span id="convert_mesh_for_sfepy-1184"><a href="#convert_mesh_for_sfepy-1184"><span class="linenos">1184</span></a>    <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ngroups</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="convert_mesh_for_sfepy-1185"><a href="#convert_mesh_for_sfepy-1185"><span class="linenos">1185</span></a>
</span><span id="convert_mesh_for_sfepy-1186"><a href="#convert_mesh_for_sfepy-1186"><span class="linenos">1186</span></a>    <span class="c1"># Managing cell groups</span>
</span><span id="convert_mesh_for_sfepy-1187"><a href="#convert_mesh_for_sfepy-1187"><span class="linenos">1187</span></a>    <span class="n">conns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">cells_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># entities of highest dim</span>
</span><span id="convert_mesh_for_sfepy-1188"><a href="#convert_mesh_for_sfepy-1188"><span class="linenos">1188</span></a>    <span class="n">mat_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ngroups</span><span class="p">[</span><span class="n">conns</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="convert_mesh_for_sfepy-1189"><a href="#convert_mesh_for_sfepy-1189"><span class="linenos">1189</span></a>    <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat_ids</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)]</span>
</span><span id="convert_mesh_for_sfepy-1190"><a href="#convert_mesh_for_sfepy-1190"><span class="linenos">1190</span></a>
</span><span id="convert_mesh_for_sfepy-1191"><a href="#convert_mesh_for_sfepy-1191"><span class="linenos">1191</span></a>    <span class="c1"># Overwrite the former mesh</span>
</span><span id="convert_mesh_for_sfepy-1192"><a href="#convert_mesh_for_sfepy-1192"><span class="linenos">1192</span></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
</span><span id="convert_mesh_for_sfepy-1193"><a href="#convert_mesh_for_sfepy-1193"><span class="linenos">1193</span></a>    <span class="n">mesh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert a .vtk mesh file written by Gmsh into a new .vtk file which
facilitates topological entity selection with Sfepy. Vertices are given a
unique group id following the convention:
[0 - 99]    --> vertex tag (i.e. entity of dimension 0)
[100 - 199] --> edge tag (i.e. entity of dimension 1)
[200 - 299] --> facet tag (i.e. entity of dimension D-1)
[300 - xxx] --> cell tag (i.e. entity of dimension D)
If one node belongs to several topological entities, it will be tagged with
the lowest dimension group id. For instance, a vertex belonging to a facet
of tag 200 and a subvolume of tag 300 will be tagged 200. This is
problematic for subvolume selection. This difficulty is overcome by taking
advantage of the 'mat_ids' field that is readable by Sfepy.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mesh_name</strong> (str):
Name of the mesh file to be created. If not specified as an absolute
path name, will be stored in the <code>MESH_DIR</code> directory.</li>
<li><strong>ignored_tags</strong> (list, optional):
List of tags to be ignored in the new .vtk mesh. The default is None.</li>
<li><strong>verbose</strong> (bool, optional):
Toggle for Sfepy automatic console messages. The default is False.</li>
</ul>
</div>


                </section>
                <section id="adjust_boundary_nodes">
                            <input id="adjust_boundary_nodes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">adjust_boundary_nodes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">mesh_name_ref</span>,</span><span class="param">	<span class="n">mesh_name_mod</span>,</span><span class="param">	<span class="n">boundary_tag_ref</span>,</span><span class="param">	<span class="n">boundary_tag_mod</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="adjust_boundary_nodes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#adjust_boundary_nodes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="adjust_boundary_nodes-1196"><a href="#adjust_boundary_nodes-1196"><span class="linenos">1196</span></a><span class="k">def</span><span class="w"> </span><span class="nf">adjust_boundary_nodes</span><span class="p">(</span><span class="n">mesh_name_ref</span><span class="p">,</span> <span class="n">mesh_name_mod</span><span class="p">,</span>
</span><span id="adjust_boundary_nodes-1197"><a href="#adjust_boundary_nodes-1197"><span class="linenos">1197</span></a>                          <span class="n">boundary_tag_ref</span><span class="p">,</span> <span class="n">boundary_tag_mod</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="adjust_boundary_nodes-1198"><a href="#adjust_boundary_nodes-1198"><span class="linenos">1198</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="adjust_boundary_nodes-1199"><a href="#adjust_boundary_nodes-1199"><span class="linenos">1199</span></a><span class="sd">    Adjust the coordinates of the nodes belonging to the boundary tagged</span>
</span><span id="adjust_boundary_nodes-1200"><a href="#adjust_boundary_nodes-1200"><span class="linenos">1200</span></a><span class="sd">    `boundary_tag_mod` of mesh `mesh_name_mod` in order to match those of</span>
</span><span id="adjust_boundary_nodes-1201"><a href="#adjust_boundary_nodes-1201"><span class="linenos">1201</span></a><span class="sd">    `mesh_name_ref` with tag `boundary_tag_ref`.</span>
</span><span id="adjust_boundary_nodes-1202"><a href="#adjust_boundary_nodes-1202"><span class="linenos">1202</span></a>
</span><span id="adjust_boundary_nodes-1203"><a href="#adjust_boundary_nodes-1203"><span class="linenos">1203</span></a><span class="sd">    Parameters</span>
</span><span id="adjust_boundary_nodes-1204"><a href="#adjust_boundary_nodes-1204"><span class="linenos">1204</span></a><span class="sd">    ----------</span>
</span><span id="adjust_boundary_nodes-1205"><a href="#adjust_boundary_nodes-1205"><span class="linenos">1205</span></a><span class="sd">    mesh_name_ref : str</span>
</span><span id="adjust_boundary_nodes-1206"><a href="#adjust_boundary_nodes-1206"><span class="linenos">1206</span></a><span class="sd">        Name of the reference mesh file (read only). If not specified as an</span>
</span><span id="adjust_boundary_nodes-1207"><a href="#adjust_boundary_nodes-1207"><span class="linenos">1207</span></a><span class="sd">        absolute path name, will be searched for in the `MESH_DIR` directory.</span>
</span><span id="adjust_boundary_nodes-1208"><a href="#adjust_boundary_nodes-1208"><span class="linenos">1208</span></a><span class="sd">    mesh_name_mod : str</span>
</span><span id="adjust_boundary_nodes-1209"><a href="#adjust_boundary_nodes-1209"><span class="linenos">1209</span></a><span class="sd">        Name of the mesh file to be modified if its boundary nodes do not match</span>
</span><span id="adjust_boundary_nodes-1210"><a href="#adjust_boundary_nodes-1210"><span class="linenos">1210</span></a><span class="sd">        those of the reference mesh file. If not specified as an absolute path</span>
</span><span id="adjust_boundary_nodes-1211"><a href="#adjust_boundary_nodes-1211"><span class="linenos">1211</span></a><span class="sd">        name, will be searched for in the `MESH_DIR` directory.</span>
</span><span id="adjust_boundary_nodes-1212"><a href="#adjust_boundary_nodes-1212"><span class="linenos">1212</span></a><span class="sd">    boundary_tag_ref : int</span>
</span><span id="adjust_boundary_nodes-1213"><a href="#adjust_boundary_nodes-1213"><span class="linenos">1213</span></a><span class="sd">        Physical group of the reference boundary nodes.</span>
</span><span id="adjust_boundary_nodes-1214"><a href="#adjust_boundary_nodes-1214"><span class="linenos">1214</span></a><span class="sd">    boundary_tag_mod : int</span>
</span><span id="adjust_boundary_nodes-1215"><a href="#adjust_boundary_nodes-1215"><span class="linenos">1215</span></a><span class="sd">        Physical group of the boundary nodes to be adjusted.</span>
</span><span id="adjust_boundary_nodes-1216"><a href="#adjust_boundary_nodes-1216"><span class="linenos">1216</span></a>
</span><span id="adjust_boundary_nodes-1217"><a href="#adjust_boundary_nodes-1217"><span class="linenos">1217</span></a><span class="sd">    Other Parameters</span>
</span><span id="adjust_boundary_nodes-1218"><a href="#adjust_boundary_nodes-1218"><span class="linenos">1218</span></a><span class="sd">    ----------------</span>
</span><span id="adjust_boundary_nodes-1219"><a href="#adjust_boundary_nodes-1219"><span class="linenos">1219</span></a><span class="sd">    verbose : bool, optional</span>
</span><span id="adjust_boundary_nodes-1220"><a href="#adjust_boundary_nodes-1220"><span class="linenos">1220</span></a><span class="sd">        The default is False.</span>
</span><span id="adjust_boundary_nodes-1221"><a href="#adjust_boundary_nodes-1221"><span class="linenos">1221</span></a>
</span><span id="adjust_boundary_nodes-1222"><a href="#adjust_boundary_nodes-1222"><span class="linenos">1222</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="adjust_boundary_nodes-1223"><a href="#adjust_boundary_nodes-1223"><span class="linenos">1223</span></a>
</span><span id="adjust_boundary_nodes-1224"><a href="#adjust_boundary_nodes-1224"><span class="linenos">1224</span></a>    <span class="n">mesh_path_name_ref</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name_ref</span><span class="p">)</span>
</span><span id="adjust_boundary_nodes-1225"><a href="#adjust_boundary_nodes-1225"><span class="linenos">1225</span></a>    <span class="n">mesh_path_name_mod</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name_mod</span><span class="p">)</span>
</span><span id="adjust_boundary_nodes-1226"><a href="#adjust_boundary_nodes-1226"><span class="linenos">1226</span></a>
</span><span id="adjust_boundary_nodes-1227"><a href="#adjust_boundary_nodes-1227"><span class="linenos">1227</span></a>    <span class="c1"># Read the meshes, get boundary indices and associated coordinates</span>
</span><span id="adjust_boundary_nodes-1228"><a href="#adjust_boundary_nodes-1228"><span class="linenos">1228</span></a>    <span class="n">mesh_ref</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name_ref</span><span class="p">)</span>
</span><span id="adjust_boundary_nodes-1229"><a href="#adjust_boundary_nodes-1229"><span class="linenos">1229</span></a>    <span class="n">mesh_mod</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name_mod</span><span class="p">)</span>
</span><span id="adjust_boundary_nodes-1230"><a href="#adjust_boundary_nodes-1230"><span class="linenos">1230</span></a>
</span><span id="adjust_boundary_nodes-1231"><a href="#adjust_boundary_nodes-1231"><span class="linenos">1231</span></a>    <span class="n">ind_ref</span><span class="p">,</span> <span class="n">ind_mod</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="adjust_boundary_nodes-1232"><a href="#adjust_boundary_nodes-1232"><span class="linenos">1232</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mesh_ref</span><span class="o">.</span><span class="n">point_data</span><span class="p">[</span><span class="s1">&#39;node_groups&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">boundary_tag_ref</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="adjust_boundary_nodes-1233"><a href="#adjust_boundary_nodes-1233"><span class="linenos">1233</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mesh_mod</span><span class="o">.</span><span class="n">point_data</span><span class="p">[</span><span class="s1">&#39;node_groups&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">boundary_tag_mod</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="adjust_boundary_nodes-1234"><a href="#adjust_boundary_nodes-1234"><span class="linenos">1234</span></a>    <span class="p">)</span>
</span><span id="adjust_boundary_nodes-1235"><a href="#adjust_boundary_nodes-1235"><span class="linenos">1235</span></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_ref</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind_mod</span><span class="p">),</span> <span class="s2">&quot;Number of DOFs does not match!&quot;</span>
</span><span id="adjust_boundary_nodes-1236"><a href="#adjust_boundary_nodes-1236"><span class="linenos">1236</span></a>
</span><span id="adjust_boundary_nodes-1237"><a href="#adjust_boundary_nodes-1237"><span class="linenos">1237</span></a>    <span class="n">pts_ref</span> <span class="o">=</span> <span class="n">mesh_ref</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">ind_ref</span><span class="p">]</span>
</span><span id="adjust_boundary_nodes-1238"><a href="#adjust_boundary_nodes-1238"><span class="linenos">1238</span></a>    <span class="n">pts_mod</span> <span class="o">=</span> <span class="n">mesh_mod</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">ind_mod</span><span class="p">]</span>
</span><span id="adjust_boundary_nodes-1239"><a href="#adjust_boundary_nodes-1239"><span class="linenos">1239</span></a>
</span><span id="adjust_boundary_nodes-1240"><a href="#adjust_boundary_nodes-1240"><span class="linenos">1240</span></a>    <span class="c1"># Check for non-matching nodes between mesh_ref and mesh_mod</span>
</span><span id="adjust_boundary_nodes-1241"><a href="#adjust_boundary_nodes-1241"><span class="linenos">1241</span></a>    <span class="n">actually_modified</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="adjust_boundary_nodes-1242"><a href="#adjust_boundary_nodes-1242"><span class="linenos">1242</span></a>    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">ptmod</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pts_mod</span><span class="p">):</span>
</span><span id="adjust_boundary_nodes-1243"><a href="#adjust_boundary_nodes-1243"><span class="linenos">1243</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">pts_ref</span> <span class="o">-</span> <span class="n">ptmod</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="adjust_boundary_nodes-1244"><a href="#adjust_boundary_nodes-1244"><span class="linenos">1244</span></a>            <span class="n">ind</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pts_ref</span> <span class="o">-</span> <span class="n">ptmod</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
</span><span id="adjust_boundary_nodes-1245"><a href="#adjust_boundary_nodes-1245"><span class="linenos">1245</span></a>            <span class="n">actually_modified</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind_mod</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span>
</span><span id="adjust_boundary_nodes-1246"><a href="#adjust_boundary_nodes-1246"><span class="linenos">1246</span></a>            <span class="n">ptmod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pts_ref</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>  <span class="c1"># in place modification</span>
</span><span id="adjust_boundary_nodes-1247"><a href="#adjust_boundary_nodes-1247"><span class="linenos">1247</span></a>            <span class="n">mesh_mod</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">ind_mod</span><span class="p">[</span><span class="n">kk</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ptmod</span>
</span><span id="adjust_boundary_nodes-1248"><a href="#adjust_boundary_nodes-1248"><span class="linenos">1248</span></a>
</span><span id="adjust_boundary_nodes-1249"><a href="#adjust_boundary_nodes-1249"><span class="linenos">1249</span></a>    <span class="c1"># If applicable, overwrite mesh_mod with adjusted boundary nodes</span>
</span><span id="adjust_boundary_nodes-1250"><a href="#adjust_boundary_nodes-1250"><span class="linenos">1250</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">actually_modified</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="adjust_boundary_nodes-1251"><a href="#adjust_boundary_nodes-1251"><span class="linenos">1251</span></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="adjust_boundary_nodes-1252"><a href="#adjust_boundary_nodes-1252"><span class="linenos">1252</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adjusting the position of some boundary nodes...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="adjust_boundary_nodes-1253"><a href="#adjust_boundary_nodes-1253"><span class="linenos">1253</span></a>        <span class="n">mesh_overwrite</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">mesh_path_name_mod</span><span class="p">)</span>
</span><span id="adjust_boundary_nodes-1254"><a href="#adjust_boundary_nodes-1254"><span class="linenos">1254</span></a>        <span class="n">coors_mod</span> <span class="o">=</span> <span class="n">mesh_mod</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="p">:</span><span class="n">mesh_overwrite</span><span class="o">.</span><span class="n">dim</span><span class="p">]</span>
</span><span id="adjust_boundary_nodes-1255"><a href="#adjust_boundary_nodes-1255"><span class="linenos">1255</span></a>        <span class="n">mesh_overwrite</span><span class="o">.</span><span class="n">coors</span><span class="p">[</span><span class="n">actually_modified</span><span class="p">]</span> <span class="o">=</span> <span class="n">coors_mod</span><span class="p">[</span><span class="n">actually_modified</span><span class="p">]</span>
</span><span id="adjust_boundary_nodes-1256"><a href="#adjust_boundary_nodes-1256"><span class="linenos">1256</span></a>        <span class="n">mesh_overwrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mesh_path_name_mod</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Adjust the coordinates of the nodes belonging to the boundary tagged
<code>boundary_tag_mod</code> of mesh <code>mesh_name_mod</code> in order to match those of
<code>mesh_name_ref</code> with tag <code>boundary_tag_ref</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mesh_name_ref</strong> (str):
Name of the reference mesh file (read only). If not specified as an
absolute path name, will be searched for in the <code>MESH_DIR</code> directory.</li>
<li><strong>mesh_name_mod</strong> (str):
Name of the mesh file to be modified if its boundary nodes do not match
those of the reference mesh file. If not specified as an absolute path
name, will be searched for in the <code>MESH_DIR</code> directory.</li>
<li><strong>boundary_tag_ref</strong> (int):
Physical group of the reference boundary nodes.</li>
<li><strong>boundary_tag_mod</strong> (int):
Physical group of the boundary nodes to be adjusted.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>verbose</strong> (bool, optional):
The default is False.</li>
</ul>
</div>


                </section>
                <section id="split_spheres_from_mesh">
                            <input id="split_spheres_from_mesh-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">split_spheres_from_mesh</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mesh_name</span>, </span><span class="param"><span class="n">Rcut</span>, </span><span class="param"><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="split_spheres_from_mesh-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#split_spheres_from_mesh"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="split_spheres_from_mesh-1259"><a href="#split_spheres_from_mesh-1259"><span class="linenos">1259</span></a><span class="k">def</span><span class="w"> </span><span class="nf">split_spheres_from_mesh</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">Rcut</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="split_spheres_from_mesh-1260"><a href="#split_spheres_from_mesh-1260"><span class="linenos">1260</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="split_spheres_from_mesh-1261"><a href="#split_spheres_from_mesh-1261"><span class="linenos">1261</span></a><span class="sd">    Split two meshed spheres that are geometrically separable by a hyperplane</span>
</span><span id="split_spheres_from_mesh-1262"><a href="#split_spheres_from_mesh-1262"><span class="linenos">1262</span></a><span class="sd">    into two distinct mesh files. The original mesh is then deleted. The </span>
</span><span id="split_spheres_from_mesh-1263"><a href="#split_spheres_from_mesh-1263"><span class="linenos">1263</span></a><span class="sd">    original mesh must have gone through the `convert_mesh_for_sfepy` routine</span>
</span><span id="split_spheres_from_mesh-1264"><a href="#split_spheres_from_mesh-1264"><span class="linenos">1264</span></a><span class="sd">    before being processed by `split_spheres_from_mesh`!</span>
</span><span id="split_spheres_from_mesh-1265"><a href="#split_spheres_from_mesh-1265"><span class="linenos">1265</span></a>
</span><span id="split_spheres_from_mesh-1266"><a href="#split_spheres_from_mesh-1266"><span class="linenos">1266</span></a><span class="sd">    Parameters</span>
</span><span id="split_spheres_from_mesh-1267"><a href="#split_spheres_from_mesh-1267"><span class="linenos">1267</span></a><span class="sd">    ----------</span>
</span><span id="split_spheres_from_mesh-1268"><a href="#split_spheres_from_mesh-1268"><span class="linenos">1268</span></a><span class="sd">    mesh_name : str</span>
</span><span id="split_spheres_from_mesh-1269"><a href="#split_spheres_from_mesh-1269"><span class="linenos">1269</span></a><span class="sd">        Name of the mesh file to be read. If not specified as an absolute</span>
</span><span id="split_spheres_from_mesh-1270"><a href="#split_spheres_from_mesh-1270"><span class="linenos">1270</span></a><span class="sd">        path name, will be searched for in the `MESH_DIR` directory.</span>
</span><span id="split_spheres_from_mesh-1271"><a href="#split_spheres_from_mesh-1271"><span class="linenos">1271</span></a><span class="sd">    Rcut : float</span>
</span><span id="split_spheres_from_mesh-1272"><a href="#split_spheres_from_mesh-1272"><span class="linenos">1272</span></a><span class="sd">        Truncation radius.</span>
</span><span id="split_spheres_from_mesh-1273"><a href="#split_spheres_from_mesh-1273"><span class="linenos">1273</span></a>
</span><span id="split_spheres_from_mesh-1274"><a href="#split_spheres_from_mesh-1274"><span class="linenos">1274</span></a><span class="sd">    Other Parameters</span>
</span><span id="split_spheres_from_mesh-1275"><a href="#split_spheres_from_mesh-1275"><span class="linenos">1275</span></a><span class="sd">    ----------------</span>
</span><span id="split_spheres_from_mesh-1276"><a href="#split_spheres_from_mesh-1276"><span class="linenos">1276</span></a><span class="sd">    verbose : bool, optional</span>
</span><span id="split_spheres_from_mesh-1277"><a href="#split_spheres_from_mesh-1277"><span class="linenos">1277</span></a><span class="sd">        Toggle for Sfepy automatic console messages. The default is False.</span>
</span><span id="split_spheres_from_mesh-1278"><a href="#split_spheres_from_mesh-1278"><span class="linenos">1278</span></a>
</span><span id="split_spheres_from_mesh-1279"><a href="#split_spheres_from_mesh-1279"><span class="linenos">1279</span></a><span class="sd">    Returns</span>
</span><span id="split_spheres_from_mesh-1280"><a href="#split_spheres_from_mesh-1280"><span class="linenos">1280</span></a><span class="sd">    -------</span>
</span><span id="split_spheres_from_mesh-1281"><a href="#split_spheres_from_mesh-1281"><span class="linenos">1281</span></a><span class="sd">    out_files : list</span>
</span><span id="split_spheres_from_mesh-1282"><a href="#split_spheres_from_mesh-1282"><span class="linenos">1282</span></a><span class="sd">        List of absolute path of output mesh files.</span>
</span><span id="split_spheres_from_mesh-1283"><a href="#split_spheres_from_mesh-1283"><span class="linenos">1283</span></a>
</span><span id="split_spheres_from_mesh-1284"><a href="#split_spheres_from_mesh-1284"><span class="linenos">1284</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="split_spheres_from_mesh-1285"><a href="#split_spheres_from_mesh-1285"><span class="linenos">1285</span></a>
</span><span id="split_spheres_from_mesh-1286"><a href="#split_spheres_from_mesh-1286"><span class="linenos">1286</span></a>    <span class="n">output</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">quiet</span><span class="o">=</span><span class="ow">not</span> <span class="n">verbose</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1287"><a href="#split_spheres_from_mesh-1287"><span class="linenos">1287</span></a>
</span><span id="split_spheres_from_mesh-1288"><a href="#split_spheres_from_mesh-1288"><span class="linenos">1288</span></a>    <span class="c1"># Retrieve data</span>
</span><span id="split_spheres_from_mesh-1289"><a href="#split_spheres_from_mesh-1289"><span class="linenos">1289</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1290"><a href="#split_spheres_from_mesh-1290"><span class="linenos">1290</span></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1291"><a href="#split_spheres_from_mesh-1291"><span class="linenos">1291</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">_get_io_data</span><span class="p">(</span><span class="n">cell_dim_only</span><span class="o">=</span><span class="n">mesh</span><span class="o">.</span><span class="n">dim</span><span class="p">))</span>
</span><span id="split_spheres_from_mesh-1292"><a href="#split_spheres_from_mesh-1292"><span class="linenos">1292</span></a>    <span class="n">data_int</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1293"><a href="#split_spheres_from_mesh-1293"><span class="linenos">1293</span></a>    <span class="n">data_ext</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1294"><a href="#split_spheres_from_mesh-1294"><span class="linenos">1294</span></a>
</span><span id="split_spheres_from_mesh-1295"><a href="#split_spheres_from_mesh-1295"><span class="linenos">1295</span></a>    <span class="c1"># Classify nodes belonging to sphere_int and sphere_ext</span>
</span><span id="split_spheres_from_mesh-1296"><a href="#split_spheres_from_mesh-1296"><span class="linenos">1296</span></a>    <span class="n">norms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1297"><a href="#split_spheres_from_mesh-1297"><span class="linenos">1297</span></a>    <span class="n">idx_node_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">norms</span> <span class="o">&lt;</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="split_spheres_from_mesh-1298"><a href="#split_spheres_from_mesh-1298"><span class="linenos">1298</span></a>    <span class="n">idx_node_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">norms</span> <span class="o">&gt;</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="split_spheres_from_mesh-1299"><a href="#split_spheres_from_mesh-1299"><span class="linenos">1299</span></a>
</span><span id="split_spheres_from_mesh-1300"><a href="#split_spheres_from_mesh-1300"><span class="linenos">1300</span></a>    <span class="c1"># Sort out data structures according to node class</span>
</span><span id="split_spheres_from_mesh-1301"><a href="#split_spheres_from_mesh-1301"><span class="linenos">1301</span></a>    <span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Rcut</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1302"><a href="#split_spheres_from_mesh-1302"><span class="linenos">1302</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_int</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx_node_int</span><span class="p">]</span>
</span><span id="split_spheres_from_mesh-1303"><a href="#split_spheres_from_mesh-1303"><span class="linenos">1303</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_int</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx_node_int</span><span class="p">]</span>
</span><span id="split_spheres_from_mesh-1304"><a href="#split_spheres_from_mesh-1304"><span class="linenos">1304</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ext</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx_node_ext</span><span class="p">]</span> <span class="o">-</span> <span class="n">offset</span>
</span><span id="split_spheres_from_mesh-1305"><a href="#split_spheres_from_mesh-1305"><span class="linenos">1305</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_ext</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx_node_ext</span><span class="p">]</span>
</span><span id="split_spheres_from_mesh-1306"><a href="#split_spheres_from_mesh-1306"><span class="linenos">1306</span></a>    <span class="n">extTag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="split_spheres_from_mesh-1307"><a href="#split_spheres_from_mesh-1307"><span class="linenos">1307</span></a>    <span class="n">idx_cell_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">extTag</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="split_spheres_from_mesh-1308"><a href="#split_spheres_from_mesh-1308"><span class="linenos">1308</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx_cell_ext</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span>
</span><span id="split_spheres_from_mesh-1309"><a href="#split_spheres_from_mesh-1309"><span class="linenos">1309</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data_int</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx_cell_ext</span><span class="p">)]</span>
</span><span id="split_spheres_from_mesh-1310"><a href="#split_spheres_from_mesh-1310"><span class="linenos">1310</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">idx_cell_ext</span><span class="p">]]</span>
</span><span id="split_spheres_from_mesh-1311"><a href="#split_spheres_from_mesh-1311"><span class="linenos">1311</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_ext</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">idx_cell_ext</span><span class="p">]]</span>
</span><span id="split_spheres_from_mesh-1312"><a href="#split_spheres_from_mesh-1312"><span class="linenos">1312</span></a>
</span><span id="split_spheres_from_mesh-1313"><a href="#split_spheres_from_mesh-1313"><span class="linenos">1313</span></a>    <span class="c1"># Repair connectivity because it has been broken!</span>
</span><span id="split_spheres_from_mesh-1314"><a href="#split_spheres_from_mesh-1314"><span class="linenos">1314</span></a>    <span class="n">conn_int</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="split_spheres_from_mesh-1315"><a href="#split_spheres_from_mesh-1315"><span class="linenos">1315</span></a>    <span class="n">conn_ext</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="split_spheres_from_mesh-1316"><a href="#split_spheres_from_mesh-1316"><span class="linenos">1316</span></a>    <span class="n">min_int</span> <span class="o">=</span> <span class="n">conn_int</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="split_spheres_from_mesh-1317"><a href="#split_spheres_from_mesh-1317"><span class="linenos">1317</span></a>    <span class="n">conn_int</span> <span class="o">-=</span> <span class="n">min_int</span>
</span><span id="split_spheres_from_mesh-1318"><a href="#split_spheres_from_mesh-1318"><span class="linenos">1318</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">min_int</span>
</span><span id="split_spheres_from_mesh-1319"><a href="#split_spheres_from_mesh-1319"><span class="linenos">1319</span></a>    <span class="n">idx_node_int</span> <span class="o">-=</span> <span class="n">min_int</span>
</span><span id="split_spheres_from_mesh-1320"><a href="#split_spheres_from_mesh-1320"><span class="linenos">1320</span></a>    <span class="n">min_ext</span> <span class="o">=</span> <span class="n">conn_ext</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="split_spheres_from_mesh-1321"><a href="#split_spheres_from_mesh-1321"><span class="linenos">1321</span></a>    <span class="n">conn_ext</span> <span class="o">-=</span> <span class="n">min_ext</span>
</span><span id="split_spheres_from_mesh-1322"><a href="#split_spheres_from_mesh-1322"><span class="linenos">1322</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">min_ext</span>
</span><span id="split_spheres_from_mesh-1323"><a href="#split_spheres_from_mesh-1323"><span class="linenos">1323</span></a>    <span class="n">idx_node_ext</span> <span class="o">-=</span> <span class="n">min_ext</span>
</span><span id="split_spheres_from_mesh-1324"><a href="#split_spheres_from_mesh-1324"><span class="linenos">1324</span></a>    <span class="n">gaps_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">idx_node_int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="split_spheres_from_mesh-1325"><a href="#split_spheres_from_mesh-1325"><span class="linenos">1325</span></a>    <span class="n">gaps_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">idx_node_ext</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="split_spheres_from_mesh-1326"><a href="#split_spheres_from_mesh-1326"><span class="linenos">1326</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">gap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gaps_int</span><span class="p">):</span>
</span><span id="split_spheres_from_mesh-1327"><a href="#split_spheres_from_mesh-1327"><span class="linenos">1327</span></a>        <span class="k">if</span> <span class="n">gap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="split_spheres_from_mesh-1328"><a href="#split_spheres_from_mesh-1328"><span class="linenos">1328</span></a>            <span class="n">conn_int</span><span class="p">[</span><span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">idx_node_int</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">-=</span> <span class="n">gap</span>
</span><span id="split_spheres_from_mesh-1329"><a href="#split_spheres_from_mesh-1329"><span class="linenos">1329</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">gap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gaps_ext</span><span class="p">):</span>
</span><span id="split_spheres_from_mesh-1330"><a href="#split_spheres_from_mesh-1330"><span class="linenos">1330</span></a>        <span class="k">if</span> <span class="n">gap</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="split_spheres_from_mesh-1331"><a href="#split_spheres_from_mesh-1331"><span class="linenos">1331</span></a>            <span class="n">conn_ext</span><span class="p">[</span><span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">idx_node_ext</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">-=</span> <span class="n">gap</span>
</span><span id="split_spheres_from_mesh-1332"><a href="#split_spheres_from_mesh-1332"><span class="linenos">1332</span></a>    <span class="n">data_int</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">conn_int</span><span class="p">]</span>
</span><span id="split_spheres_from_mesh-1333"><a href="#split_spheres_from_mesh-1333"><span class="linenos">1333</span></a>    <span class="n">data_ext</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">conn_ext</span><span class="p">]</span>
</span><span id="split_spheres_from_mesh-1334"><a href="#split_spheres_from_mesh-1334"><span class="linenos">1334</span></a>
</span><span id="split_spheres_from_mesh-1335"><a href="#split_spheres_from_mesh-1335"><span class="linenos">1335</span></a>    <span class="c1"># I/O stuff</span>
</span><span id="split_spheres_from_mesh-1336"><a href="#split_spheres_from_mesh-1336"><span class="linenos">1336</span></a>    <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1337"><a href="#split_spheres_from_mesh-1337"><span class="linenos">1337</span></a>    <span class="n">name_int</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">with_name</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_int&#39;</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1338"><a href="#split_spheres_from_mesh-1338"><span class="linenos">1338</span></a>    <span class="n">name_ext</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">with_name</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_ext&#39;</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1339"><a href="#split_spheres_from_mesh-1339"><span class="linenos">1339</span></a>    <span class="n">mesh_int</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_int</span><span class="p">),</span> <span class="o">*</span><span class="n">data_int</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1340"><a href="#split_spheres_from_mesh-1340"><span class="linenos">1340</span></a>    <span class="n">mesh_int</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_int</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1341"><a href="#split_spheres_from_mesh-1341"><span class="linenos">1341</span></a>    <span class="n">mesh_ext</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_ext</span><span class="p">),</span> <span class="o">*</span><span class="n">data_ext</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1342"><a href="#split_spheres_from_mesh-1342"><span class="linenos">1342</span></a>    <span class="n">mesh_ext</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name_ext</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1343"><a href="#split_spheres_from_mesh-1343"><span class="linenos">1343</span></a>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.vtk&#39;</span><span class="p">)</span>
</span><span id="split_spheres_from_mesh-1344"><a href="#split_spheres_from_mesh-1344"><span class="linenos">1344</span></a>
</span><span id="split_spheres_from_mesh-1345"><a href="#split_spheres_from_mesh-1345"><span class="linenos">1345</span></a>    <span class="c1"># Return new file names</span>
</span><span id="split_spheres_from_mesh-1346"><a href="#split_spheres_from_mesh-1346"><span class="linenos">1346</span></a>    <span class="n">out_files</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">name_int</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)),</span>
</span><span id="split_spheres_from_mesh-1347"><a href="#split_spheres_from_mesh-1347"><span class="linenos">1347</span></a>                 <span class="nb">str</span><span class="p">(</span><span class="n">name_ext</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">))]</span>
</span><span id="split_spheres_from_mesh-1348"><a href="#split_spheres_from_mesh-1348"><span class="linenos">1348</span></a>
</span><span id="split_spheres_from_mesh-1349"><a href="#split_spheres_from_mesh-1349"><span class="linenos">1349</span></a>    <span class="k">return</span> <span class="n">out_files</span>
</span></pre></div>


            <div class="docstring"><p>Split two meshed spheres that are geometrically separable by a hyperplane
into two distinct mesh files. The original mesh is then deleted. The 
original mesh must have gone through the <code><a href="#convert_mesh_for_sfepy">convert_mesh_for_sfepy</a></code> routine
before being processed by <code><a href="#split_spheres_from_mesh">split_spheres_from_mesh</a></code>!</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mesh_name</strong> (str):
Name of the mesh file to be read. If not specified as an absolute
path name, will be searched for in the <code>MESH_DIR</code> directory.</li>
<li><strong>Rcut</strong> (float):
Truncation radius.</li>
</ul>

<h6 id="other-parameters">Other Parameters</h6>

<ul>
<li><strong>verbose</strong> (bool, optional):
Toggle for Sfepy automatic console messages. The default is False.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>out_files</strong> (list):
List of absolute path of output mesh files.</li>
</ul>
</div>


                </section>
                <section id="make_absolute_mesh_name">
                            <input id="make_absolute_mesh_name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">make_absolute_mesh_name</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="make_absolute_mesh_name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#make_absolute_mesh_name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="make_absolute_mesh_name-1352"><a href="#make_absolute_mesh_name-1352"><span class="linenos">1352</span></a><span class="k">def</span><span class="w"> </span><span class="nf">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="make_absolute_mesh_name-1353"><a href="#make_absolute_mesh_name-1353"><span class="linenos">1353</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an absolute path name from a mesh name, with .vtk extension.</span>
</span><span id="make_absolute_mesh_name-1354"><a href="#make_absolute_mesh_name-1354"><span class="linenos">1354</span></a><span class="sd">    The default path is `MESH_DIR`.&quot;&quot;&quot;</span>
</span><span id="make_absolute_mesh_name-1355"><a href="#make_absolute_mesh_name-1355"><span class="linenos">1355</span></a>
</span><span id="make_absolute_mesh_name-1356"><a href="#make_absolute_mesh_name-1356"><span class="linenos">1356</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="make_absolute_mesh_name-1357"><a href="#make_absolute_mesh_name-1357"><span class="linenos">1357</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="make_absolute_mesh_name-1358"><a href="#make_absolute_mesh_name-1358"><span class="linenos">1358</span></a>            <span class="s2">&quot;mesh_name is of type &#39;</span><span class="si">{}</span><span class="s2">&#39; but should be a string instead&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="make_absolute_mesh_name-1359"><a href="#make_absolute_mesh_name-1359"><span class="linenos">1359</span></a>                <span class="nb">type</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
</span><span id="make_absolute_mesh_name-1360"><a href="#make_absolute_mesh_name-1360"><span class="linenos">1360</span></a>
</span><span id="make_absolute_mesh_name-1361"><a href="#make_absolute_mesh_name-1361"><span class="linenos">1361</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)</span>
</span><span id="make_absolute_mesh_name-1362"><a href="#make_absolute_mesh_name-1362"><span class="linenos">1362</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">mesh_path_name</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">():</span>
</span><span id="make_absolute_mesh_name-1363"><a href="#make_absolute_mesh_name-1363"><span class="linenos">1363</span></a>        <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">MESH_DIR</span> <span class="o">/</span> <span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="make_absolute_mesh_name-1364"><a href="#make_absolute_mesh_name-1364"><span class="linenos">1364</span></a>
</span><span id="make_absolute_mesh_name-1365"><a href="#make_absolute_mesh_name-1365"><span class="linenos">1365</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return an absolute path name from a mesh name, with .vtk extension.
The default path is <code>MESH_DIR</code>.</p>
</div>


                </section>
                <section id="make_absolute_geo_name">
                            <input id="make_absolute_geo_name-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">make_absolute_geo_name</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">geo_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="make_absolute_geo_name-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#make_absolute_geo_name"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="make_absolute_geo_name-1368"><a href="#make_absolute_geo_name-1368"><span class="linenos">1368</span></a><span class="k">def</span><span class="w"> </span><span class="nf">make_absolute_geo_name</span><span class="p">(</span><span class="n">geo_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="make_absolute_geo_name-1369"><a href="#make_absolute_geo_name-1369"><span class="linenos">1369</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an absolute path name from a mesh name, with .geo extension.</span>
</span><span id="make_absolute_geo_name-1370"><a href="#make_absolute_geo_name-1370"><span class="linenos">1370</span></a><span class="sd">    The default path is `MESH_DIR`/geo.&quot;&quot;&quot;</span>
</span><span id="make_absolute_geo_name-1371"><a href="#make_absolute_geo_name-1371"><span class="linenos">1371</span></a>
</span><span id="make_absolute_geo_name-1372"><a href="#make_absolute_geo_name-1372"><span class="linenos">1372</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">geo_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="make_absolute_geo_name-1373"><a href="#make_absolute_geo_name-1373"><span class="linenos">1373</span></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="make_absolute_geo_name-1374"><a href="#make_absolute_geo_name-1374"><span class="linenos">1374</span></a>            <span class="s2">&quot;geo_name is of type &#39;</span><span class="si">{}</span><span class="s2">&#39; but should be a string instead&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="make_absolute_geo_name-1375"><a href="#make_absolute_geo_name-1375"><span class="linenos">1375</span></a>                <span class="nb">type</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
</span><span id="make_absolute_geo_name-1376"><a href="#make_absolute_geo_name-1376"><span class="linenos">1376</span></a>
</span><span id="make_absolute_geo_name-1377"><a href="#make_absolute_geo_name-1377"><span class="linenos">1377</span></a>    <span class="n">geo_name_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">geo_name</span><span class="p">)</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.geo&#39;</span><span class="p">)</span>
</span><span id="make_absolute_geo_name-1378"><a href="#make_absolute_geo_name-1378"><span class="linenos">1378</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">geo_name_path</span><span class="o">.</span><span class="n">is_absolute</span><span class="p">():</span>
</span><span id="make_absolute_geo_name-1379"><a href="#make_absolute_geo_name-1379"><span class="linenos">1379</span></a>        <span class="n">geo_name_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">MESH_DIR</span> <span class="o">/</span> <span class="s2">&quot;geo&quot;</span> <span class="o">/</span> <span class="n">geo_name_path</span><span class="p">)</span>
</span><span id="make_absolute_geo_name-1380"><a href="#make_absolute_geo_name-1380"><span class="linenos">1380</span></a>
</span><span id="make_absolute_geo_name-1381"><a href="#make_absolute_geo_name-1381"><span class="linenos">1381</span></a>    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">geo_name_path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return an absolute path name from a mesh name, with .geo extension.
The default path is <code>MESH_DIR</code>/geo.</p>
</div>


                </section>
                <section id="read_Rcut_from_mesh_file">
                            <input id="read_Rcut_from_mesh_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_Rcut_from_mesh_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mesh_name</span>, </span><span class="param"><span class="n">coorsys</span><span class="o">=</span><span class="s1">&#39;cartesian&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="read_Rcut_from_mesh_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_Rcut_from_mesh_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_Rcut_from_mesh_file-1384"><a href="#read_Rcut_from_mesh_file-1384"><span class="linenos">1384</span></a><span class="k">def</span><span class="w"> </span><span class="nf">read_Rcut_from_mesh_file</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">coorsys</span><span class="o">=</span><span class="s1">&#39;cartesian&#39;</span><span class="p">):</span>
</span><span id="read_Rcut_from_mesh_file-1385"><a href="#read_Rcut_from_mesh_file-1385"><span class="linenos">1385</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_Rcut_from_mesh_file-1386"><a href="#read_Rcut_from_mesh_file-1386"><span class="linenos">1386</span></a><span class="sd">    Read truncation radius Rc from existing .vtk mesh file.</span>
</span><span id="read_Rcut_from_mesh_file-1387"><a href="#read_Rcut_from_mesh_file-1387"><span class="linenos">1387</span></a>
</span><span id="read_Rcut_from_mesh_file-1388"><a href="#read_Rcut_from_mesh_file-1388"><span class="linenos">1388</span></a><span class="sd">    Parameters</span>
</span><span id="read_Rcut_from_mesh_file-1389"><a href="#read_Rcut_from_mesh_file-1389"><span class="linenos">1389</span></a><span class="sd">    ----------</span>
</span><span id="read_Rcut_from_mesh_file-1390"><a href="#read_Rcut_from_mesh_file-1390"><span class="linenos">1390</span></a><span class="sd">    mesh_name : str</span>
</span><span id="read_Rcut_from_mesh_file-1391"><a href="#read_Rcut_from_mesh_file-1391"><span class="linenos">1391</span></a><span class="sd">        Name of the mesh file to be read. If not specified as an absolute</span>
</span><span id="read_Rcut_from_mesh_file-1392"><a href="#read_Rcut_from_mesh_file-1392"><span class="linenos">1392</span></a><span class="sd">        path name, will be searched for in the `MESH_DIR` directory.</span>
</span><span id="read_Rcut_from_mesh_file-1393"><a href="#read_Rcut_from_mesh_file-1393"><span class="linenos">1393</span></a><span class="sd">    coorsys : str</span>
</span><span id="read_Rcut_from_mesh_file-1394"><a href="#read_Rcut_from_mesh_file-1394"><span class="linenos">1394</span></a><span class="sd">        Coordinate system to be used in accordance with the mesh.</span>
</span><span id="read_Rcut_from_mesh_file-1395"><a href="#read_Rcut_from_mesh_file-1395"><span class="linenos">1395</span></a>
</span><span id="read_Rcut_from_mesh_file-1396"><a href="#read_Rcut_from_mesh_file-1396"><span class="linenos">1396</span></a><span class="sd">    Returns</span>
</span><span id="read_Rcut_from_mesh_file-1397"><a href="#read_Rcut_from_mesh_file-1397"><span class="linenos">1397</span></a><span class="sd">    -------</span>
</span><span id="read_Rcut_from_mesh_file-1398"><a href="#read_Rcut_from_mesh_file-1398"><span class="linenos">1398</span></a><span class="sd">    Rc : float</span>
</span><span id="read_Rcut_from_mesh_file-1399"><a href="#read_Rcut_from_mesh_file-1399"><span class="linenos">1399</span></a><span class="sd">        Truncation radius.</span>
</span><span id="read_Rcut_from_mesh_file-1400"><a href="#read_Rcut_from_mesh_file-1400"><span class="linenos">1400</span></a>
</span><span id="read_Rcut_from_mesh_file-1401"><a href="#read_Rcut_from_mesh_file-1401"><span class="linenos">1401</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="read_Rcut_from_mesh_file-1402"><a href="#read_Rcut_from_mesh_file-1402"><span class="linenos">1402</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="read_Rcut_from_mesh_file-1403"><a href="#read_Rcut_from_mesh_file-1403"><span class="linenos">1403</span></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="read_Rcut_from_mesh_file-1404"><a href="#read_Rcut_from_mesh_file-1404"><span class="linenos">1404</span></a>    <span class="n">coors</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">points</span>
</span><span id="read_Rcut_from_mesh_file-1405"><a href="#read_Rcut_from_mesh_file-1405"><span class="linenos">1405</span></a>    <span class="k">if</span> <span class="n">coorsys</span> <span class="o">==</span> <span class="s1">&#39;cartesian&#39;</span><span class="p">:</span>
</span><span id="read_Rcut_from_mesh_file-1406"><a href="#read_Rcut_from_mesh_file-1406"><span class="linenos">1406</span></a>        <span class="n">Rcut</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">coors</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
</span><span id="read_Rcut_from_mesh_file-1407"><a href="#read_Rcut_from_mesh_file-1407"><span class="linenos">1407</span></a>    <span class="k">elif</span> <span class="n">coorsys</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;polar_mu&#39;</span><span class="p">]:</span>
</span><span id="read_Rcut_from_mesh_file-1408"><a href="#read_Rcut_from_mesh_file-1408"><span class="linenos">1408</span></a>        <span class="n">Rcut</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">coors</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="read_Rcut_from_mesh_file-1409"><a href="#read_Rcut_from_mesh_file-1409"><span class="linenos">1409</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="read_Rcut_from_mesh_file-1410"><a href="#read_Rcut_from_mesh_file-1410"><span class="linenos">1410</span></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not implemented coordinates system: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">coorsys</span><span class="p">)</span>
</span><span id="read_Rcut_from_mesh_file-1411"><a href="#read_Rcut_from_mesh_file-1411"><span class="linenos">1411</span></a>    <span class="k">return</span> <span class="n">Rcut</span>
</span></pre></div>


            <div class="docstring"><p>Read truncation radius Rc from existing .vtk mesh file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mesh_name</strong> (str):
Name of the mesh file to be read. If not specified as an absolute
path name, will be searched for in the <code>MESH_DIR</code> directory.</li>
<li><strong>coorsys</strong> (str):
Coordinate system to be used in accordance with the mesh.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Rc</strong> (float):
Truncation radius.</li>
</ul>
</div>


                </section>
                <section id="read_dimension_from_mesh_file">
                            <input id="read_dimension_from_mesh_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_dimension_from_mesh_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="read_dimension_from_mesh_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_dimension_from_mesh_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_dimension_from_mesh_file-1414"><a href="#read_dimension_from_mesh_file-1414"><span class="linenos">1414</span></a><span class="k">def</span><span class="w"> </span><span class="nf">read_dimension_from_mesh_file</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="read_dimension_from_mesh_file-1415"><a href="#read_dimension_from_mesh_file-1415"><span class="linenos">1415</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Read dimension from existing .vtk mesh file.&quot;&quot;&quot;</span>
</span><span id="read_dimension_from_mesh_file-1416"><a href="#read_dimension_from_mesh_file-1416"><span class="linenos">1416</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="read_dimension_from_mesh_file-1417"><a href="#read_dimension_from_mesh_file-1417"><span class="linenos">1417</span></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="read_dimension_from_mesh_file-1418"><a href="#read_dimension_from_mesh_file-1418"><span class="linenos">1418</span></a>    <span class="n">Z</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="read_dimension_from_mesh_file-1419"><a href="#read_dimension_from_mesh_file-1419"><span class="linenos">1419</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">Z</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="read_dimension_from_mesh_file-1420"><a href="#read_dimension_from_mesh_file-1420"><span class="linenos">1420</span></a>        <span class="k">return</span> <span class="mi">2</span>
</span><span id="read_dimension_from_mesh_file-1421"><a href="#read_dimension_from_mesh_file-1421"><span class="linenos">1421</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="read_dimension_from_mesh_file-1422"><a href="#read_dimension_from_mesh_file-1422"><span class="linenos">1422</span></a>        <span class="k">return</span> <span class="mi">3</span>
</span></pre></div>


            <div class="docstring"><p>Read dimension from existing .vtk mesh file.</p>
</div>


                </section>
                <section id="read_physical_groups_from_mesh_file">
                            <input id="read_physical_groups_from_mesh_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_physical_groups_from_mesh_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="read_physical_groups_from_mesh_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_physical_groups_from_mesh_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_physical_groups_from_mesh_file-1425"><a href="#read_physical_groups_from_mesh_file-1425"><span class="linenos">1425</span></a><span class="k">def</span><span class="w"> </span><span class="nf">read_physical_groups_from_mesh_file</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="read_physical_groups_from_mesh_file-1426"><a href="#read_physical_groups_from_mesh_file-1426"><span class="linenos">1426</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_physical_groups_from_mesh_file-1427"><a href="#read_physical_groups_from_mesh_file-1427"><span class="linenos">1427</span></a><span class="sd">    Read the physical groups present in the mesh and return them as a</span>
</span><span id="read_physical_groups_from_mesh_file-1428"><a href="#read_physical_groups_from_mesh_file-1428"><span class="linenos">1428</span></a><span class="sd">    list.</span>
</span><span id="read_physical_groups_from_mesh_file-1429"><a href="#read_physical_groups_from_mesh_file-1429"><span class="linenos">1429</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="read_physical_groups_from_mesh_file-1430"><a href="#read_physical_groups_from_mesh_file-1430"><span class="linenos">1430</span></a>    <span class="n">mesh_path_name</span> <span class="o">=</span> <span class="n">make_absolute_mesh_name</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">)</span>
</span><span id="read_physical_groups_from_mesh_file-1431"><a href="#read_physical_groups_from_mesh_file-1431"><span class="linenos">1431</span></a>    <span class="n">reader</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_path_name</span><span class="p">)</span>
</span><span id="read_physical_groups_from_mesh_file-1432"><a href="#read_physical_groups_from_mesh_file-1432"><span class="linenos">1432</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">point_data</span><span class="p">[</span><span class="s2">&quot;node_groups&quot;</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Read the physical groups present in the mesh and return them as a
list.</p>
</div>


                </section>
                <section id="generate_uniform_1d_mesh">
                            <input id="generate_uniform_1d_mesh-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_uniform_1d_mesh</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">start</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">stop</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">number_nodes</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">mesh_name</span><span class="o">=</span><span class="s1">&#39;mesh1d&#39;</span></span><span class="return-annotation">) -> <span class="n">sfepy</span><span class="o">.</span><span class="n">discrete</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Mesh</span>:</span></span>

                <label class="view-source-button" for="generate_uniform_1d_mesh-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_uniform_1d_mesh"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_uniform_1d_mesh-1435"><a href="#generate_uniform_1d_mesh-1435"><span class="linenos">1435</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_uniform_1d_mesh</span><span class="p">(</span><span class="n">start</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">number_nodes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="generate_uniform_1d_mesh-1436"><a href="#generate_uniform_1d_mesh-1436"><span class="linenos">1436</span></a>                             <span class="n">mesh_name</span><span class="o">=</span><span class="s1">&#39;mesh1d&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mesh</span><span class="p">:</span>
</span><span id="generate_uniform_1d_mesh-1437"><a href="#generate_uniform_1d_mesh-1437"><span class="linenos">1437</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="generate_uniform_1d_mesh-1438"><a href="#generate_uniform_1d_mesh-1438"><span class="linenos">1438</span></a><span class="sd">    Generate uniform one-dimensional mesh on the interval [`start`, `stop`]</span>
</span><span id="generate_uniform_1d_mesh-1439"><a href="#generate_uniform_1d_mesh-1439"><span class="linenos">1439</span></a><span class="sd">    using `number_nodes` nodes. Unlike higher dimensional meshes, the resulting</span>
</span><span id="generate_uniform_1d_mesh-1440"><a href="#generate_uniform_1d_mesh-1440"><span class="linenos">1440</span></a><span class="sd">    mesh is not saved as a .vtk file. Instead, it is directly returned as an</span>
</span><span id="generate_uniform_1d_mesh-1441"><a href="#generate_uniform_1d_mesh-1441"><span class="linenos">1441</span></a><span class="sd">    instance of the class `sfepy.discrete.fem.mesh.Mesh`.</span>
</span><span id="generate_uniform_1d_mesh-1442"><a href="#generate_uniform_1d_mesh-1442"><span class="linenos">1442</span></a>
</span><span id="generate_uniform_1d_mesh-1443"><a href="#generate_uniform_1d_mesh-1443"><span class="linenos">1443</span></a><span class="sd">    Parameters</span>
</span><span id="generate_uniform_1d_mesh-1444"><a href="#generate_uniform_1d_mesh-1444"><span class="linenos">1444</span></a><span class="sd">    ----------</span>
</span><span id="generate_uniform_1d_mesh-1445"><a href="#generate_uniform_1d_mesh-1445"><span class="linenos">1445</span></a><span class="sd">    start : float</span>
</span><span id="generate_uniform_1d_mesh-1446"><a href="#generate_uniform_1d_mesh-1446"><span class="linenos">1446</span></a><span class="sd">        Lower bound of the interval to be meshed.</span>
</span><span id="generate_uniform_1d_mesh-1447"><a href="#generate_uniform_1d_mesh-1447"><span class="linenos">1447</span></a><span class="sd">    stop : float</span>
</span><span id="generate_uniform_1d_mesh-1448"><a href="#generate_uniform_1d_mesh-1448"><span class="linenos">1448</span></a><span class="sd">        Upper bound of the interval to be meshed.</span>
</span><span id="generate_uniform_1d_mesh-1449"><a href="#generate_uniform_1d_mesh-1449"><span class="linenos">1449</span></a><span class="sd">    number_nodes : int</span>
</span><span id="generate_uniform_1d_mesh-1450"><a href="#generate_uniform_1d_mesh-1450"><span class="linenos">1450</span></a><span class="sd">        Number of nodes evenly  spaced across the interval (including</span>
</span><span id="generate_uniform_1d_mesh-1451"><a href="#generate_uniform_1d_mesh-1451"><span class="linenos">1451</span></a><span class="sd">        endpoints).</span>
</span><span id="generate_uniform_1d_mesh-1452"><a href="#generate_uniform_1d_mesh-1452"><span class="linenos">1452</span></a><span class="sd">    mesh_name : str, optional</span>
</span><span id="generate_uniform_1d_mesh-1453"><a href="#generate_uniform_1d_mesh-1453"><span class="linenos">1453</span></a><span class="sd">        Name of the mesh. The default is &#39;mesh1d&#39;.</span>
</span><span id="generate_uniform_1d_mesh-1454"><a href="#generate_uniform_1d_mesh-1454"><span class="linenos">1454</span></a>
</span><span id="generate_uniform_1d_mesh-1455"><a href="#generate_uniform_1d_mesh-1455"><span class="linenos">1455</span></a><span class="sd">    Returns</span>
</span><span id="generate_uniform_1d_mesh-1456"><a href="#generate_uniform_1d_mesh-1456"><span class="linenos">1456</span></a><span class="sd">    -------</span>
</span><span id="generate_uniform_1d_mesh-1457"><a href="#generate_uniform_1d_mesh-1457"><span class="linenos">1457</span></a><span class="sd">    mesh : `sfepy.discrete.fem.mesh.Mesh`</span>
</span><span id="generate_uniform_1d_mesh-1458"><a href="#generate_uniform_1d_mesh-1458"><span class="linenos">1458</span></a><span class="sd">        Uniform one-dimensional mesh (instance of Sfepy&#39;s class `Mesh`).</span>
</span><span id="generate_uniform_1d_mesh-1459"><a href="#generate_uniform_1d_mesh-1459"><span class="linenos">1459</span></a>
</span><span id="generate_uniform_1d_mesh-1460"><a href="#generate_uniform_1d_mesh-1460"><span class="linenos">1460</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_uniform_1d_mesh-1461"><a href="#generate_uniform_1d_mesh-1461"><span class="linenos">1461</span></a>    <span class="n">number_nodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">number_nodes</span><span class="p">)</span>
</span><span id="generate_uniform_1d_mesh-1462"><a href="#generate_uniform_1d_mesh-1462"><span class="linenos">1462</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">number_nodes</span><span class="p">)</span>
</span><span id="generate_uniform_1d_mesh-1463"><a href="#generate_uniform_1d_mesh-1463"><span class="linenos">1463</span></a>    <span class="k">return</span> <span class="n">generate_1d_mesh_from_array</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">mesh_name</span><span class="o">=</span><span class="n">mesh_name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate uniform one-dimensional mesh on the interval [<code>start</code>, <code>stop</code>]
using <code>number_nodes</code> nodes. Unlike higher dimensional meshes, the resulting
mesh is not saved as a .vtk file. Instead, it is directly returned as an
instance of the class <code>sfepy.discrete.fem.mesh.Mesh</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>start</strong> (float):
Lower bound of the interval to be meshed.</li>
<li><strong>stop</strong> (float):
Upper bound of the interval to be meshed.</li>
<li><strong>number_nodes</strong> (int):
Number of nodes evenly  spaced across the interval (including
endpoints).</li>
<li><strong>mesh_name</strong> (str, optional):
Name of the mesh. The default is 'mesh1d'.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>mesh</strong> (<code>sfepy.discrete.fem.mesh.Mesh</code>):
Uniform one-dimensional mesh (instance of Sfepy's class <code>Mesh</code>).</li>
</ul>
</div>


                </section>
                <section id="generate_1d_mesh_from_array">
                            <input id="generate_1d_mesh_from_array-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_1d_mesh_from_array</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">coors_array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">mesh_name</span><span class="o">=</span><span class="s1">&#39;mesh1d&#39;</span></span><span class="return-annotation">) -> <span class="n">sfepy</span><span class="o">.</span><span class="n">discrete</span><span class="o">.</span><span class="n">fem</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Mesh</span>:</span></span>

                <label class="view-source-button" for="generate_1d_mesh_from_array-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_1d_mesh_from_array"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_1d_mesh_from_array-1466"><a href="#generate_1d_mesh_from_array-1466"><span class="linenos">1466</span></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_1d_mesh_from_array</span><span class="p">(</span><span class="n">coors_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="generate_1d_mesh_from_array-1467"><a href="#generate_1d_mesh_from_array-1467"><span class="linenos">1467</span></a>                                <span class="n">mesh_name</span><span class="o">=</span><span class="s1">&#39;mesh1d&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mesh</span><span class="p">:</span>
</span><span id="generate_1d_mesh_from_array-1468"><a href="#generate_1d_mesh_from_array-1468"><span class="linenos">1468</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="generate_1d_mesh_from_array-1469"><a href="#generate_1d_mesh_from_array-1469"><span class="linenos">1469</span></a><span class="sd">    Generate a one-dimensional mesh from a 1d Numpy array. Unlike higher</span>
</span><span id="generate_1d_mesh_from_array-1470"><a href="#generate_1d_mesh_from_array-1470"><span class="linenos">1470</span></a><span class="sd">    dimensional meshes, the resulting mesh is not saved as a .vtk file.</span>
</span><span id="generate_1d_mesh_from_array-1471"><a href="#generate_1d_mesh_from_array-1471"><span class="linenos">1471</span></a><span class="sd">    Instead, it is directly returned as an instance of the class</span>
</span><span id="generate_1d_mesh_from_array-1472"><a href="#generate_1d_mesh_from_array-1472"><span class="linenos">1472</span></a><span class="sd">    `sfepy.discrete.fem.mesh.Mesh`.</span>
</span><span id="generate_1d_mesh_from_array-1473"><a href="#generate_1d_mesh_from_array-1473"><span class="linenos">1473</span></a>
</span><span id="generate_1d_mesh_from_array-1474"><a href="#generate_1d_mesh_from_array-1474"><span class="linenos">1474</span></a><span class="sd">    Parameters</span>
</span><span id="generate_1d_mesh_from_array-1475"><a href="#generate_1d_mesh_from_array-1475"><span class="linenos">1475</span></a><span class="sd">    ----------</span>
</span><span id="generate_1d_mesh_from_array-1476"><a href="#generate_1d_mesh_from_array-1476"><span class="linenos">1476</span></a><span class="sd">    coors_array : np.ndarray</span>
</span><span id="generate_1d_mesh_from_array-1477"><a href="#generate_1d_mesh_from_array-1477"><span class="linenos">1477</span></a><span class="sd">        Coordinates of the mesh vertices (1st-order nodes only).</span>
</span><span id="generate_1d_mesh_from_array-1478"><a href="#generate_1d_mesh_from_array-1478"><span class="linenos">1478</span></a><span class="sd">    mesh_name : str, optional</span>
</span><span id="generate_1d_mesh_from_array-1479"><a href="#generate_1d_mesh_from_array-1479"><span class="linenos">1479</span></a><span class="sd">        Name of the mesh. The default is &#39;mesh1d&#39;.</span>
</span><span id="generate_1d_mesh_from_array-1480"><a href="#generate_1d_mesh_from_array-1480"><span class="linenos">1480</span></a>
</span><span id="generate_1d_mesh_from_array-1481"><a href="#generate_1d_mesh_from_array-1481"><span class="linenos">1481</span></a><span class="sd">    Returns</span>
</span><span id="generate_1d_mesh_from_array-1482"><a href="#generate_1d_mesh_from_array-1482"><span class="linenos">1482</span></a><span class="sd">    -------</span>
</span><span id="generate_1d_mesh_from_array-1483"><a href="#generate_1d_mesh_from_array-1483"><span class="linenos">1483</span></a><span class="sd">    mesh : `sfepy.discrete.fem.mesh.Mesh`</span>
</span><span id="generate_1d_mesh_from_array-1484"><a href="#generate_1d_mesh_from_array-1484"><span class="linenos">1484</span></a><span class="sd">        Uniform one-dimensional mesh (instance of Sfepy&#39;s class `Mesh`).</span>
</span><span id="generate_1d_mesh_from_array-1485"><a href="#generate_1d_mesh_from_array-1485"><span class="linenos">1485</span></a>
</span><span id="generate_1d_mesh_from_array-1486"><a href="#generate_1d_mesh_from_array-1486"><span class="linenos">1486</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="generate_1d_mesh_from_array-1487"><a href="#generate_1d_mesh_from_array-1487"><span class="linenos">1487</span></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">coors_array</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="generate_1d_mesh_from_array-1488"><a href="#generate_1d_mesh_from_array-1488"><span class="linenos">1488</span></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="generate_1d_mesh_from_array-1489"><a href="#generate_1d_mesh_from_array-1489"><span class="linenos">1489</span></a>    <span class="n">mat_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</span><span id="generate_1d_mesh_from_array-1490"><a href="#generate_1d_mesh_from_array-1490"><span class="linenos">1490</span></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">mesh_name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">conn</span><span class="p">],</span> <span class="p">[</span><span class="n">mat_ids</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1_2&#39;</span><span class="p">])</span>
</span><span id="generate_1d_mesh_from_array-1491"><a href="#generate_1d_mesh_from_array-1491"><span class="linenos">1491</span></a>    <span class="k">return</span> <span class="n">mesh</span>
</span></pre></div>


            <div class="docstring"><p>Generate a one-dimensional mesh from a 1d Numpy array. Unlike higher
dimensional meshes, the resulting mesh is not saved as a .vtk file.
Instead, it is directly returned as an instance of the class
<code>sfepy.discrete.fem.mesh.Mesh</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>coors_array</strong> (np.ndarray):
Coordinates of the mesh vertices (1st-order nodes only).</li>
<li><strong>mesh_name</strong> (str, optional):
Name of the mesh. The default is 'mesh1d'.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>mesh</strong> (<code>sfepy.discrete.fem.mesh.Mesh</code>):
Uniform one-dimensional mesh (instance of Sfepy's class <code>Mesh</code>).</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>